var Dialogs=new Array();var nTopDialog=-1;var nTopBubbleDialog=0;var bIsIE=(document.all!=undefined);var bIsOpera=(navigator.userAgent.indexOf("Opera")>=0);var bDraggingAndDropping=false;var g_sToolTipDialog="";var g_MouseDownGesture;var g_bMultiTransferLoaded;var g_bWebClientProActive=false;var g_bMultiTransferHidden=false;var g_PageUnloading=false;var g_bContextKeepAppletHidden=false;function SUDialog(Dialog,sName,nWidth,nHeight,sOpaqueLayer,fnOnHide){this.m_Dialog=Dialog;this.m_sName=sName;this.m_nWidth=nWidth;this.m_nHeight=nHeight;this.m_sOpaqueLayer=sOpaqueLayer;this.m_fnOnHide=fnOnHide;}function OnDialogMouseMove(e){if(bDraggingAndDropping){var Event=((bIsIE)?event:e);var SUDialog=Dialogs[nTopDialog];var Dialog=SUDialog.m_Dialog;var nLeft=(parseInt(Event.clientX)+nOffSetX);var nTop=(parseInt(Event.clientY)+nOffSetY);var nClientRight=(document.documentElement.clientWidth-1);var nClientBottom=(document.documentElement.clientHeight-1);if((nLeft+SUDialog.m_nWidth)>=nClientRight)nLeft=(nClientRight-(SUDialog.m_nWidth+1));if((nTop+SUDialog.m_nHeight)>=nClientBottom)nTop=(nClientBottom-(SUDialog.m_nHeight+1));if(nLeft<0)nLeft=0;if(nTop<0)nTop=0;Dialog.style.left=parseInt(nLeft)+"px";Dialog.style.top=parseInt(nTop)+"px";}return(!bDraggingAndDropping);}function OnDialogMouseDown(e){if(nTopDialog>=0){var TopDialog=Dialogs[nTopDialog].m_Dialog;var TitleBar=document.getElementById(TopDialog.id+"TitleBar");if(TitleBar!=undefined){var Event=((bIsIE)?event:e);if(document.getElementById(TopDialog.id+"TitleBar")){var nDialogX1=parseInt(TopDialog.style.left);var nDialogY1=parseInt(TopDialog.style.top);nOffSetX=(nDialogX1-Event.clientX);nOffSetY=(nDialogY1-Event.clientY);nScrollOffsetY=(document.all)?document.body.scrollTop:window.pageYOffset;if((nOffSetX<=0)&&(Event.clientX<=(nDialogX1+Dialogs[nTopDialog].m_nWidth))&&((nOffSetY-nScrollOffsetY)<=0)&&((Event.clientY+nScrollOffsetY)<=(nDialogY1+TitleBar.offsetHeight))){bDraggingAndDropping=true;document.onmousemove=OnDialogMouseMove;}}}}document.onmousedown=function(){return(g_MouseDownGesture);};return(!bDraggingAndDropping);}function OnDialogMouseUp(e){var bAllow=true;if(bDraggingAndDropping){bDraggingAndDropping=false;bAllow=false;}if(nTopDialog>=0){var TopDialog=document.getElementById(Dialogs[nTopDialog].m_sName+"TitleBar");if(TopDialog){TopDialog.onmousemove=function(){document.onmousedown=OnDialogMouseDown;};}}return(!bDraggingAndDropping);}function DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide,objToolTip,bTopPointer,xOffset,yOffset,xPointOffSet,yPointOffSet){var nDialogTopPosition;var ToolTipPlaceHolder=document.getElementById(objToolTip);var nScrollTop=document.body.scrollTop;if(nScrollTop==0){if(window.pageYOffset)nScrollTop=window.pageYOffset;else nScrollTop=(document.body.parentElement)?document.body.parentElement.scrollTop:0;}if(ToolTipPlaceHolder!=undefined){aToolTipPos=findPos(ToolTipPlaceHolder);nToolTipLeft=aToolTipPos[0];nToolTipTop=aToolTipPos[1];if(xPointOffSet!=undefined){nToolTipLeft=(nToolTipLeft+xPointOffSet);}if(yPointOffSet!=undefined){nToolTipTop=(nToolTipTop+yPointOffSet);}if(bTopPointer){nDialogTopPosition=((nToolTipTop)+(yOffset));nToolTipLeft=((nToolTipLeft)+(xOffset));}else{nDialogTopPosition=((nToolTipTop)-(nHeight));if(bIsOpera)nDialogTopPosition=nDialogTopPosition-30;}if(nDialogTopPosition<0)nDialogTopPosition=0;Dialog.style.top=parseInt(nDialogTopPosition)+"px";Dialog.style.left=parseInt(nToolTipLeft)+"px";nTopDialogValue=--nTopBubbleDialog;}else{if(document.getElementById('container')){var nContainerHeight=parseInt(document.getElementById('container').offsetHeight);if(parseInt(document.documentElement.clientHeight)<nContainerHeight||(nContainerHeight<400))nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));else{nDialogTopPosition=((nContainerHeight/2)-(nHeight/2));if(nDialogTopPosition<0)nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));}}else nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));if(nDialogTopPosition<0)nDialogTopPosition=0;if(nScrollTop>0)nDialogTopPosition+=nScrollTop;Dialog.style.top=parseInt(nDialogTopPosition)+"px";Dialog.style.left=parseInt((document.documentElement.clientWidth/2)-(nWidth/2))+"px";nTopDialogValue=++nTopDialog;}Dialogs[nTopDialogValue]=new SUDialog(Dialog,Dialog.id,nWidth,nHeight,sOpaqueLayer,fnOnHide);}function HideDialog(sDialog,bBubbleTip,bFromApplet){var nSaveTopDialog=nTopDialog;if(bBubbleTip){nTopDialog=nTopBubbleDialog;nTopDialog=nTopBubbleDialog;}if((nTopDialog>=0)&&(Dialogs[nTopDialog]!=undefined)&&(Dialogs[nTopDialog].m_Dialog.id==sDialog)||(bBubbleTip&&nTopDialog<0)){if(Dialogs[nTopDialog].m_fnOnHide!=undefined)Dialogs[nTopDialog].m_fnOnHide(Dialogs[nTopDialog].m_sName);Dialogs[nTopDialog].m_Dialog.style.left="-5000px";Dialogs[nTopDialog].m_Dialog.style.top="-5000px";HideOpaqueLayer(Dialogs[nTopDialog].m_sOpaqueLayer,bFromApplet);if(bBubbleTip){Dialogs[nTopDialog]=undefined;nTopBubbleDialog++;nTopDialog=nSaveTopDialog;}else Dialogs[nTopDialog--]=undefined;setTimeout(function(){try{if(g_nShowList!=0&&g_nShowList!=undefined){FilesList.element().focus();}}catch(e){}},500);}}function HideOpaqueLayer(sOpaqueLayer,bFromApplet){if(sOpaqueLayer!=undefined){var OpaqueLayer=document.getElementById(sOpaqueLayer);if(OpaqueLayer!=undefined)OpaqueLayer.style.display="none";ShowApplet(bFromApplet);}}function FindUniqueOpaqueLayer(Dialog,sOpaqueLayer){var nDialog=nTopDialog;var OpaqueLayer=document.getElementById(sOpaqueLayer);while(nDialog>0){--nDialog;if(Dialogs[nDialog].m_sOpaqueLayer==sOpaqueLayer){sOpaqueLayer=(Dialogs[nDialog].m_Dialog.id+"OpaqueLayer");Dialog.m_sOpaqueLayer=sOpaqueLayer;break;}}return(sOpaqueLayer);}function ShowDialog(sDialog,bHideBackground,fnOnHide,bFromApplet){HideDialog(g_sToolTipDialog);var Dialog=document.getElementById(sDialog);var DialogBody=document.getElementById(sDialog+"Body");var nWidth=parseInt(Dialog.style.width);var nHeight=parseInt(Dialog.style.height);if(DialogBody!=undefined){DialogBody.style.width=parseInt(nWidth)+"px";}if(Dialog!=undefined){var nOpaqueZIndex=(8000+(nTopDialog*2));var sOpaqueLayer=(sDialog+"OpaqueLayer");nHeight=(Dialog.style.pixelHeight)?Dialog.style.pixelHeight:Dialog.offsetHeight;DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide);Dialog.style.zIndex=(nOpaqueZIndex+1);if((bHideBackground==undefined)||(bHideBackground)){sOpaqueLayer=FindUniqueOpaqueLayer(Dialogs[nTopDialog],sOpaqueLayer);ShowOpaqueLayer(sOpaqueLayer,nOpaqueZIndex,bFromApplet);}var TitleBar=document.getElementById(sDialog+"TitleBar");if(TitleBar!=undefined)TitleBar.style.cursor="move";g_MouseDownGesture=document.onmousedown;document.onmousedown=OnDialogMouseDown;if(document.addEventListener){document.addEventListener("mouseup",OnDialogMouseUp,true);}else if(document.attachEvent){document.attachEvent("onmouseup",OnDialogMouseUp);}if(TitleBar!=undefined){TitleBar.onmouseover=function(){document.onmousedown=OnDialogMouseDown;};}}}function ShowOpaqueLayer(sOpaqueLayerID,nOpaqueZIndex,bFromApplet,bBubbleTip){var OpaqueLayer;if(document.getElementById(sOpaqueLayerID)==undefined){CreateOpaqueLayerDiv(sOpaqueLayerID,bBubbleTip);}OpaqueLayer=document.getElementById(sOpaqueLayerID);if(OpaqueLayer!=undefined){OpaqueLayer.style.zIndex=nOpaqueZIndex;HideApplet(bFromApplet);OpaqueLayer.style.display="block";}}function ShowToolTipDialog(sDialog,bHideBackground,fnOnHide,objToolTip,nBubbleWidth,nBubbleHeight,bTopPointer,xOffset,yOffset,sAltDialog,xPointOffSet,yPointOffSet){var Dialog;if(sAltDialog!=undefined){g_sToolTipDialog=sAltDialog;Dialog=document.getElementById(sAltDialog);}else{g_sToolTipDialog=sDialog;Dialog=document.getElementById(sDialog);}var DialogBody=document.getElementById(sDialog+"Body");var nWidth,nHeight=0;if(Dialog!=undefined){if(nBubbleWidth==undefined)nWidth=parseInt(Dialog.style.width);else nWidth=parseInt(nBubbleWidth);if(nBubbleHeight==undefined)nHeight=parseInt(Dialog.style.height);else nHeight=parseInt(nBubbleHeight);if(DialogBody!=undefined){DialogBody.style.width=parseInt(nWidth-2)+"px";DialogBody.style.height=parseInt((nHeight-102)-2)+"px";}var nOpaqueZIndex=(7000+(nTopBubbleDialog*-2));var sOpaqueLayer=(sDialog+"OpaqueLayer");DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide,objToolTip,bTopPointer,xOffset,yOffset,xPointOffSet,yPointOffSet);ShowOpaqueLayer(sOpaqueLayer,nOpaqueZIndex,undefined,true);Dialog.style.zIndex=((7000+(nTopBubbleDialog*-2))-1);var objSaveMouseDown=document.onmousedown;Dialog.onmouseover=function(){document.onmousedown=function(){return(objSaveMouseDown);};};Dialog.onmouseout=function(){document.getElementById(sDialog+"OpaqueLayer").onmousedown=function(){HideDialog(sDialog,true);return(objSaveMouseDown);};};Dialog.onmousedown=function(){return(false);};document.getElementById(sDialog+"OpaqueLayer").onmousedown=function(){HideDialog(sDialog,true);return(objSaveMouseDown);};}}function ReplaceDialog(sOldDialog,sNewDialog,fnOnHide){var sOpaqueLayer="",sNewOpaqueLayer="";var OldOpaqueLayer,NewOpaqueLayer,bHideBackground;if((nTopDialog>=0)&&(Dialogs[nTopDialog].m_Dialog.id==sOldDialog)){if(Dialogs[nTopDialog].m_fnOnHide!=undefined)Dialogs[nTopDialog].m_fnOnHide(sOldDialog);Dialogs[nTopDialog].m_Dialog.style.left="-5000px";Dialogs[nTopDialog].m_Dialog.style.top="-5000px";sOpaqueLayer=Dialogs[nTopDialog].m_sOpaqueLayer;Dialogs[nTopDialog--]=undefined;}if(sOpaqueLayer!=""){bHideBackground=false;OldOpaqueLayer=document.getElementById(sOpaqueLayer);}ShowDialog(sNewDialog,bHideBackground,fnOnHide);NewOpaqueLayer=document.getElementById(sNewOpaqueLayer=FindUniqueOpaqueLayer(Dialogs[nTopDialog],sNewDialog+"OpaqueLayer"));if((OldOpaqueLayer!=undefined)&&(NewOpaqueLayer!=undefined)){OldOpaqueLayer.style.display="none";NewOpaqueLayer.style.zIndex=OldOpaqueLayer.style.zIndex;NewOpaqueLayer.style.display="block";Dialogs[nTopDialog].m_sOpaqueLayer=sNewOpaqueLayer;}}if(g_bIsDemo)AddOnloadEvent(SWIDemoFrame);