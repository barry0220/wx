var g_nSelectedTab;var OpenFVJV;var g_nGridWidth=0;var g_bWindowResizeSet=false;var g_NavTabChanging=false;var g_bFVJVLoggedInCheck=false;var g_nNOOPRetry=0;function createAWHttpRequest(sMethod,sURL,fnCallback){var objRequest=new AW.HTTP.Request;if(objRequest){objRequest.setRequestMethod(sMethod);objRequest.setURL(sURL+SyncRequestParameter());objRequest.setRequestHeader("User-Agent","Serv-U");if(typeof g_sEncXsrfToken!=='undefined')objRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);if(fnCallback)objRequest.response=fnCallback;}return(objRequest);}function SyncRequestParameter(){CurrentDate=new Date();return("&Sync="+CurrentDate.getTime());}function CreatePostRequest(sURL,fnCallback){return(createAWHttpRequest("POST",sURL,fnCallback));}function OnSaveComplete(obj,bLeaveSave){var XMLDoc;if(obj==undefined)obj=this;if(obj.getResponseText!=undefined)XMLDoc=CreateXMLDocument(obj.getResponseText());else XMLDoc=obj;var nResult=parseInt(XMLDoc.getElementsByTagName("result")[0].childNodes[0].nodeValue);var sResultText=XMLDoc.getElementsByTagName("ResultText")[0].childNodes[0].nodeValue;if(!bLeaveSave)SavingDialog(false);if((nResult!=g_nSessionOkay)&&(!bLeaveSave)){AlertDialog(GetResultText(0,"",sResultText));}return(nResult);}function OnGetResultText(obj){var XMLDoc;if(obj==undefined)obj=this;if(obj.getResponseText!=undefined)XMLDoc=CreateXMLDocument(obj.getResponseText());else XMLDoc=obj;var sResultText=XMLDoc.getElementsByTagName("ResultText")[0].childNodes[0].nodeValue;return(sResultText);}function FormatFileSize(nSize,bFormatEmpty){var sRet="";var nFileSize=0,nTemp=0;if(nSize){if(nSize>(nFileSize=1073741824))sRet=" "+g_sGB;else if(nSize>(nFileSize=1048576))sRet=" "+g_sMB;else if(nSize>(nFileSize=1024))sRet=" "+g_sKB;else{nFileSize=1;sRet=" "+g_sBytes;}nTemp=(nSize/nFileSize);if((nFileSize)&&(nSize % nFileSize))nTemp=Math.round((nSize/nFileSize)*100)/100;if(nTemp.toLocaleString().valueOf()=="[object Number]")sRet=nTemp+sRet;else sRet=nTemp.toLocaleString()+sRet;}else if(bFormatEmpty){if(nTemp.toLocaleString().valueOf()=="[object Number]")sRet=nTemp+" "+g_sKB;else sRet=nTemp.toLocaleString()+" "+g_sKB;}return(sRet);}function FormatDurationString(nElapsedMS,bDays,sDay,sDays){var sRet="";var nHours=0,nMinutes=0,nSeconds=0;nHours=parseInt(nElapsedMS/3600000);nMinutes=parseInt((nElapsedMS/60000)% 60);nSeconds=parseInt((nElapsedMS/1000)% 60);if(bDays){var nDays=parseInt(nElapsedMS/86400000);nHours %=24;sRet+=nDays+" "+((nDays!=1)?sDays:sDay)+", ";}if(nHours<10)sRet+="0";sRet+=nHours+":";if(nMinutes<10)sRet+="0";sRet+=nMinutes+":";if(nSeconds<10)sRet+="0";sRet+=nSeconds;return(sRet);}function DecodeString(sString){if((sString.charAt(0)=="%")&&(sString.charAt(sString.length-1)=="%"))return(unescape(sString));else return(decodeURIComponent(sString));}function FormatClientString(sString,bSkipDecode){var sRet="";if(!bSkipDecode)sRet=DecodeString(sString);else sRet=sString;sRet=sRet.replace(eval("/</g"),"&lt;");sRet=sRet.replace(eval("/>/g"),"&gt;");return(sRet);}function GetXMLValue(xmlDoc,sNode,bSkipDecode){var sRet=undefined;if(typeof(xmlDoc)=="object"){var Elements=(xmlDoc)?xmlDoc.getElementsByTagName(sNode):[];if(Elements.length){var Node=Elements[0].childNodes[0];if(Node!=undefined)sRet=FormatClientString(Node.nodeValue,bSkipDecode);}}return(sRet);}function GetXMLValueInt(xmlDoc,sNode,bSkipDecode){return(parseInt(GetXMLValue(xmlDoc,sNode,bSkipDecode)));}function CreateXMLDocument(sText){if(window.ActiveXObject){var XMLDoc=new ActiveXObject("Microsoft.XMLDOM");XMLDoc.async="false";XMLDoc.loadXML(sText);}else{var Parser=new DOMParser();var XMLDoc=Parser.parseFromString(sText,"text/xml");}return(XMLDoc);}function CreatePushButton(sText,sElementID,fnOnClick,nWidth,nHeight,objParam,sImg,sButtonColorClass){if($('#btn-'+sElementID).length){$('#btn-'+sElementID).remove();}if(sButtonColorClass==undefined||sButtonColorClass=="")sButtonColorClass="button_ltgray";var PushButton=$('<button id="btn-'+sElementID+'" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only '+sButtonColorClass+'" name="'+sElementID+'" type="button" role="button">'+'<span class="ui-button-text" style="display:inline-block">'+sText+'</span>'+'</button>');if((nWidth!=undefined)&&(nHeight!=undefined)){PushButton.css("width",parseInt(nWidth)+"px");PushButton.css("height",parseInt(nHeight)+"px");}PushButton.bind('click',(function(){if(!PushButton.m_bDisabled)fnOnClick(objParam);}));PushButton.setStyle=function(cssType,cssVal){this.css(cssType,cssVal);};PushButton.setControlImage=function(sImgVal){if(this.find("span.ui-button-text").html()){this.prepend("<span class='button_img aw-image-"+sImgVal+"'></span>");this.find("span.ui-button-text").addClass("ui-button-text-img");this.find("span.ui-button-text").css("display","inline-block");}else{this.prepend("<span class='button_imgonly aw-image-"+sImgVal+"' style='margin: -6px 1px -8px 4px !important;'></span>");this.find("span.ui-button-text").addClass("ui-button-notext-img");this.find("span.ui-button-text").css("display","none");}};PushButton.setControlText=function(sText){this.find("span.ui-button-text").html(sText);};PushButton.setControlDisabled=function(bDisabled){if(bDisabled){this.attr("disabled",true);this.addClass("button_disabled");}else{this.removeAttr("disabled");this.removeClass("button_disabled");}this.m_bDisabled=bDisabled;};PushButton.getControlText=function(){return(this.find("span.ui-button-text").text());};if((sImg!=undefined)&&(sImg!=""))PushButton.setControlImage(sImg);$("#"+sElementID).append(PushButton);return(PushButton);}function CreateDialogPushButton(sText,sElementID,fnOnClick,objParam){var PushButton=CreatePushButton(sText,sElementID,fnOnClick,85,25,objParam);PushButton.css("margin-bottom","4px");return(PushButton);}function CreateTabs(asTabNames,asDivIDs,sTabID,sParentDivID,nStartPage,fnOnChangeTab,bNoTabTrack){var Tabs=new AW.UI.Tabs;Tabs.setId(sTabID);Tabs.setItemText(asTabNames);Tabs.setItemValue(asDivIDs);Tabs.setItemCount(asTabNames.length);if(fnOnChangeTab!=undefined)Tabs.m_fnOnChangeTab=fnOnChangeTab;Tabs.refresh();Tabs.onSelectedItemsChanging=function(nCurrentTab){this.m_nLastTab=this.getSelectedItems()[0];if(!bNoTabTrack)g_nSelectedTab=(parseInt(nCurrentTab)+1);g_NavTabChanging=false;};Tabs.onSelectedItemsChanged=function(anSelected){var nIndex,aDivs=document.getElementById(sParentDivID).childNodes;if(this.m_fnOnChangeTab!=undefined)this.m_fnOnChangeTab(parseInt(this.m_nLastTab),parseInt(anSelected[0]));for(nIndex=0;(nIndex<aDivs.length);nIndex++){if(aDivs[nIndex].style)aDivs[nIndex].style.display="none";}document.getElementById(this.getItemValue(anSelected[0])).style.display="block";};Tabs.setSelectedItems([nStartPage-1]);if(!bNoTabTrack)g_nSelectedTab=(nStartPage);Tabs.setStyle("-moz-user-select","-moz-none");return(Tabs);}function CreateHiddenInput(sElementID,sInputName,sOnLoad,sInitValue,bAllowEdit){var HiddenInput=new AW.HTML.INPUT;HiddenInput.setAttribute("type","text");HiddenInput.setStyle("display","none");HiddenInput.setAttribute("name",sInputName);if(sOnLoad!=undefined)HiddenInput.setEvent("onchange",sOnLoad.replace("()","(this.value, this.defaultValue);"));HiddenInput.setAttribute("value",sInitValue);return(HiddenInput);}function CreateComboBox(sControlText,sControlValue,asComboBoxNames,asComboBoxValues,sElementID,sComboID,fnOnChange,sOnLoad,bTriState,nWidth,nHeight,fnOnSubmit,bAllowEdit,bUseTextValues,bUseControlVal){var ComboBox=new AW.UI.Combo;ComboBox.setContent("hidden",CreateHiddenInput(sElementID,sComboID,sOnLoad,sControlValue,bAllowEdit));ComboBox.setId(sComboID);ComboBox.setControlText(sControlText);ComboBox.setControlValue(sControlValue);ComboBox.setSelectedItems([0]);ComboBox.m_bOverrideManualEdit=false;if(bUseTextValues==undefined)bUseTextValues=false;ComboBox.m_bTriState=(bTriState!=undefined)?bTriState:false;if(ComboBox.m_bTriState){asComboBoxNames[asComboBoxNames.length]="<< "+g_sUseInherited+">>";asComboBoxValues[asComboBoxValues.length]="";}ComboBox.setItemText(asComboBoxNames);ComboBox.setItemValue(asComboBoxValues);ComboBox.setItemCount(asComboBoxNames.length);var PopUp=ComboBox.getPopupTemplate();if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nComboWidth=nWidth.toString()+"px";else nComboWidth=nWidth;PopUp.setStyle("width",nComboWidth);var nCnt=ComboBox.getItemCount();PopUp.setStyle("height",(nCnt<=10)?(((g_bFireFox4Browser)?22:20)*nCnt)+"px":"165px");PopUp.setStyle("font-size","11px");ComboBox.getContent("box/text").setAttribute("name","Combo"+sComboID);if(AW.chrome)ComboBox.getContent("box/text").setStyle("padding-right","1px");if(bAllowEdit==undefined||!bAllowEdit){ComboBox.getContent("box/text").setAttribute("readonly",true);ComboBox.getContent("box/text").setStyle("-moz-user-select","-moz-none");ComboBox.onControlEditStarted=function(){this.getContent("box/text").element().contentEditable=false;};}else if(bTriState||bUseTextValues){ComboBox.m_bManualEdit=false;ComboBox.m_bChanged=false;ComboBox.onControlEditStarted=function(sText){this.m_sOriginalText=sText;this.m_bManualEdit=true;this.m_bChanged=false;};ComboBox.onControlEditEnded=function(sText){this.UpdateHiddenValue(sText);this.m_bManualEdit=this.m_bChanged=false;};ComboBox.UpdateHiddenValue=function(sText){if(((this.m_sOriginalText!=sText)&&(sText!=asComboBoxNames[asComboBoxNames.length-1])&&(sText!=this.m_sInheritedVal))||bUseTextValues){if(bTriState)this.getContent("box/text").setStyle("font-weight","bold");document.getElementById(this.getContent("hidden").getId()).value=sText;}else if(sText==""){document.getElementById(this.getContent("hidden").getId()).value=sText;}else{if(this.m_bManualEdit||this.m_bOverrideManualEdit){if((sText==this.m_sInheritedVal)&&(this.m_bChanged||this.m_bOverrideManualEdit)){if(bTriState)this.getContent("box/text").setStyle("font-weight","bold");document.getElementById(this.getContent("hidden").getId()).value=sText;}}else this.getContent("box/text").setStyle("font-weight","");}this.m_bChanged=true;};}if((nWidth!=undefined)||(nHeight!=undefined))ComboBox.setSize(nWidth,nHeight);$("#"+sElementID).addClass('removeme');document.getElementById(sElementID).innerHTML=ComboBox;$(".removeme").removeAttr('id').removeClass('removeme');ComboBox.setControlTextDef=ComboBox.setControlText;ComboBox.setControlText=function(sText){this.setControlTextDef(sText);if((bAllowEdit)&&(bTriState||bUseTextValues))this.UpdateHiddenValue(sText);};ComboBox.SetDisabled=function(bDisable){if(bDisable){this.getContent("box/text").setAttribute("disabled",true);this.getPopupTemplate().setStyle("visibility","hidden");}else{this.getContent("box/text").setAttribute("disabled");this.getPopupTemplate().setStyle("visibility");}this.m_bDisabled=bDisable;};ComboBox.popupEvent=ComboBox.getContent("box/sign").getEvent("onclick");ComboBox.getContent("box/sign").setEvent("onclick",function(event){if(!ComboBox.m_bDisabled)ComboBox.popupEvent(event);});ComboBox.onCurrentItemChangedDef=ComboBox.onCurrentItemChanged;ComboBox.onCurrentItemChanged=function(nNewIndex){var nNewValue="";if((this.m_bTriState||bUseTextValues)&&(this.m_nInheritedVal!=undefined)){if((!isNaN(nNewIndex))&&(nNewIndex!=(asComboBoxNames.length-1||bUseTextValues))){if(this.m_bTriState)this.getContent("box/text").setStyle("font-weight","bold");if(bUseControlVal)nNewValue=this.getItemValue(nNewIndex);else nNewValue=nNewIndex;}else{this.getContent("box/text").setStyle("font-weight","");nNewIndex=this.m_nInheritedVal;nNewValue="";if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(parseInt(this.getItemValue(nIndex))==parseInt(nNewIndex)){nNewIndex=nIndex;break;}}}if((asComboBoxNames.length==1)&&(!this.m_bInitial)){this.setTimeout(function(){this.m_bManualEdit=false;this.setControlText(this.m_sInheritedVal);});}}}else{if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(this.getItemValue(nIndex)==nNewValue){nNewIndex=nIndex;break;}}nNewValue=this.getItemValue(nNewIndex);}else nNewValue=isNaN(nNewIndex)?0:nNewIndex;}document.getElementById(this.getContent("hidden").getId()).value=nNewValue;this.onCurrentItemChangedDef(nNewIndex);};ComboBox.onControlTextChanged=function(value){if((fnOnChange!=undefined)&&(!this.m_bInitial)){nSelectedValue=ComboBox.getItemValue(ComboBox.getSelectedItems());fnOnChange(nSelectedValue);}if(bAllowEdit==undefined||!bAllowEdit)document.getElementById(this.getContent("hidden").getId()).blur();};ComboBox.initValue=function(value,defaultvalue){this.m_sInheritedVal=defaultvalue;this.m_sOriginalText=undefined;value=parseInt(value);defaultvalue=parseInt(defaultvalue);var nControlIndex;if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(parseInt(this.getItemValue(nIndex))==value){nControlIndex=nIndex;break;}}}if(this.m_bTriState){if(isNaN(defaultvalue))this.m_nInheritedVal=0;else this.m_nInheritedVal=defaultvalue;}this.m_bInitial=true;if((isNaN(value))&&(this.m_bTriState)){if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(this.getItemValue(nIndex)==this.m_nInheritedVal){this.setSelectedItems([nIndex]);break;}}}else this.setSelectedItems(this.m_nInheritedVal);}else{if(bUseControlVal)this.setSelectedItems([nControlIndex]);else this.setSelectedItems(value);}if(bUseControlVal)this.onCurrentItemChanged(nControlIndex);else this.onCurrentItemChanged(value);this.m_bInitial=false;};ComboBox.EscHidePopup=function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;var sEventType=(window.event)?event:e;var sTarget=sEventType.target||sEventType.srcElement;var bSkipClose=(sTarget.id==(ComboBox.getId()+"-popup-box"));if((IEKeyCode==FFEsc)&&!bSkipClose){ComboBox.showPopup(true);}};ComboBox.showPopup1=ComboBox.showPopup;ComboBox.showPopup=function(bEsc){var el=document;if(this.$popup||bEsc){this.hidePopup();if(el.detachEvent){el.detachEvent("onkeydown",this.EscHidePopup);el.detachEvent("onmouseup",this.EscHidePopup);}else if(el.removeEventListener){el.removeEventListener("keydown",this.EscHidePopup,true);el.removeEventListener("mouseup",this.EscHidePopup,true);}else{el["onkeydown"]=null;el["onmouseup"]=null;}}else{this.showPopup1();if(el.attachEvent){el.attachEvent("onkeydown",this.EscHidePopup);el.attachEvent("onmouseup",this.EscHidePopup);}else if(el.addEventListener){el.addEventListener("keydown",this.EscHidePopup,true);el.addEventListener("mouseup",this.EscHidePopup,true);}else{el["onkeydown"]=this.EscHidePopup;el["onmouseup"]=this.EscHidePopup;}}};if(sControlText.length==0)ComboBox.initValue(sControlValue);if(fnOnSubmit!=undefined)ComboBox.onKeyEnter=fnOnSubmit;ComboBox.m_dateLastSearch=0;ComboBox.m_sSearchStr="";if(bAllowEdit==undefined||!bAllowEdit){ComboBox.onKeyPress=function(event){nEventKeyCode=(event.keyCode!=undefined&&event.keyCode>0)?event.keyCode:undefined;var sKey=String.fromCharCode(nEventKeyCode||event.charCode).toLocaleLowerCase();var dateNow=new Date().getTime();if((sKey!="")){var nStartSearch=0,nCurrentRow=this.getSelectedItems();var bFound=false;var sTemp="";if(nCurrentRow>=0){nStartSearch=parseInt(nCurrentRow);}if((dateNow-this.m_dateLastSearch)>750){this.m_sSearchStr=sKey;if(nStartSearch)nStartSearch++;}else this.m_sSearchStr+=sKey;this.m_dateLastSearch=dateNow;if((!this.ItemSearch(this.m_sSearchStr,nStartSearch,this.getItemCount()))&&(nStartSearch>0))this.ItemSearch(this.m_sSearchStr,0,nStartSearch);}else{this.m_sSearchStr="";this.m_dateLastSearch=0;}};}ComboBox.ItemSearch=function(sSearchStr,nStart,nStop){var bFound=false;for(var nIndex=nStart;nIndex<nStop;nIndex++){var sTemp=this.getItemText(nIndex).substring(0,sSearchStr.length).toLocaleLowerCase();if(sTemp==sSearchStr){this.setSelectedItems([nIndex]);this.setCurrentItem(nIndex);this.setControlText(this.getItemText(nIndex));bFound=true;break;}}return(bFound);};return(ComboBox);}function CreateRadioButtons(nInitValue,asButtonNames,sElementID,sInputName,nWidth,fnOnChange,anValues,anImages,bFlowHorizontal,nFlowItemWidth){var RadioButtons=new AW.UI.Radio;if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nWidth=nWidth.toString()+"px";if(bFlowHorizontal){if(nFlowItemWidth.toString().indexOf("px")==-1&&nFlowItemWidth.toString().indexOf("%")==-1)nFlowItemWidth=nFlowItemWidth.toString()+"px";RadioButtons.setClass("flow","horizontal");RadioButtons.getItemTemplate().setStyle("width",nFlowItemWidth);RadioButtons.setStyle("height","25px");}RadioButtons.setContent("hidden",CreateHiddenInput(sElementID,sInputName,"",nInitValue));RadioButtons.setId(sElementID);RadioButtons.setItemText(asButtonNames);RadioButtons.setItemCount(asButtonNames.length);if(anImages!=undefined)RadioButtons.setItemImage(anImages);if(nWidth!=undefined)RadioButtons.setStyle("width",nWidth);document.getElementById(sElementID).innerHTML=RadioButtons;RadioButtons.onSelectedItemsChanged=function(nNewIndex){document.getElementById(this.getContent("hidden").getId()).value=((anValues==undefined)?nNewIndex:anValues[nNewIndex]);if(fnOnChange!=undefined)fnOnChange(this.getSelectedItems(),this);};RadioButtons.initValue=function(value){if(!isNaN(value)){if(anValues==undefined)this.setSelectedItems([value]);else{for(var nIndex=0;nIndex<anValues.length;nIndex++){if(anValues[nIndex]==value){this.setSelectedItems([nIndex]);break;}}}}};RadioButtons.initValue(nInitValue);return(RadioButtons);}function CreateInputField(sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete){return(CreateAWInput(new AW.UI.Input,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete));}function CreatePasswordField(sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete){return(CreateAWInput(new AW.UI.Password,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete));}function CreateAWInput(InputField,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete){InputField.setId(sInputID);if((nWidth!=undefined)||(nHeight!=undefined))InputField.setControlSize(nWidth,20);InputField.getContent("box/text").setAttribute("name",sInputID);if(bTurnOnAutoComplete!=undefined){if(bTurnOnAutoComplete)InputField.getContent("box/text").setAttribute("autocomplete","on");else if(!bTurnOnAutoComplete)InputField.getContent("box/text").setAttribute("autocomplete","off");}if((bRightAlign!=undefined)&&(bRightAlign)){InputField.getContent('box/text').setStyle('text-align','right');InputField.getContent('box/text').setStyle('left','0px');if(AW.ie||AW.opera){if(nWidth!=undefined&&(sElementID==sInputID))InputField.getContent('box/text').setStyle('width',(nWidth-13)+'px');}}if(fnOnChange!=undefined)InputField.onControlEditEnded=fnOnChange;if(fnOnSubmit!=undefined)InputField.onKeyEnter=function(){if(document.selection)document.selection.empty();else if(window.getSelection)window.getSelection().removeAllRanges();fnOnSubmit();};InputField.SetDisabled=function(bDisable){if(bDisable){this.getContent("box/text").setAttribute("disabled",true);}else{this.getContent("box/text").setAttribute("disabled");}this.m_bDisabled=bDisable;};document.getElementById(sElementID).innerHTML=InputField;InputField.setControlText((bSkipDecode)?sDefaultText:DecodeString(sDefaultText));return(InputField);}function CreateGroupBox(sText,sElementID,nWidth,nHeight,bNoOffset){var sContent=document.getElementById(sElementID).innerHTML;var sFieldset=new String;if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1&&nWidth.toString().indexOf("auto")==-1)nWidth=nWidth.toString()+"px";if(nHeight.toString().indexOf("px")==-1&&nHeight.toString().indexOf("%")==-1&&nHeight.toString().indexOf("auto")==-1)nHeight=nHeight.toString()+"px";sFieldset="<fieldset id='"+sElementID+"FS' class='aw-system-control aw-ui-group' style='overflow:visible;position:static;width:"+nWidth+";height:"+nHeight+";'>";sFieldset+="<legend>"+sText+"</legend>";if((bNoOffset==undefined)||(!bNoOffset)){sFieldset+="<div style='display:block; padding:5px 0px 0px 5px;'>";sContent+="</div>";}document.getElementById(sElementID).innerHTML=sFieldset+sContent+"</fieldset>";}function CreateCheckBox(sText,sElementID,sAttrName,bEnabled,fnOnControlValueChanged,bCreateFormElement,sOnLoad,bInverseLogic){var CheckBox=new AW.UI.Checkbox;CheckBox.setControlText(sText);CheckBox.setAttribute("AttrName",sAttrName);if(bEnabled==1)bEnabled=true;else if(bEnabled==0)bEnabled=false;CheckBox.setControlValue(bEnabled);if(bCreateFormElement)CheckBox.setContent("hidden",CreateHiddenInput(sElementID,sAttrName,sOnLoad,(bEnabled)?"1":"0"));CheckBox.setChecked=function(bChecked,bIgonoreCB){this.m_bIgonoreCB=bIgonoreCB;this.setControlValue(bChecked);};CheckBox.onControlValueChanged=function(bValue){if(bInverseLogic)bValue=(!bValue);if(bCreateFormElement){document.getElementById(this.getContent("hidden").getId()).value=((bValue)?"1":"0");}if((fnOnControlValueChanged!=undefined)&&(!this.m_bIgonoreCB))fnOnControlValueChanged(this);this.m_bIgonoreCB=false;};document.getElementById(sElementID).innerHTML=CheckBox;return(CheckBox);}function CreateTriStateCheckBox(sText,sElementID,sAttrName,sVal,sDefaultVal,sUseDefault,fnOnControlValueChanged,sOnLoad){if(isNaN(parseInt(sVal))){sVal=sDefaultVal;sUseDefault="1";}var CheckBox=CreateCheckBox(sText,sElementID,sAttrName,(parseInt(sVal)?true:false),fnOnControlValueChanged,true,sOnLoad);CheckBox.setBoldText=function(bBold){this.getContent("box/text").setStyle("font-weight",(bBold)?"bold":"normal");};if(sUseDefault=="1"){document.getElementById(CheckBox.getContent("hidden").getId()).value="";}else CheckBox.setBoldText(true);CheckBox.onControlValueChanged=function(bValue){if(this.m_bIgonoreCB){this.m_bIgonoreCB=false;return;}else{var bBoldText=true;var sOldValue=document.getElementById(this.getContent("hidden").getId()).value;var sNewValue=(bValue?"1":"0");if(sOldValue=="")sNewValue=((sDefaultVal!="0")?"0":"1");else{if(sOldValue!=sDefaultVal)sNewValue=sDefaultVal;else{sNewValue="";bBoldText=false;}}document.getElementById(this.getContent("hidden").getId()).value=sNewValue;this.setChecked(((sNewValue=="")?(sDefaultVal!="0"):(sNewValue!="0")),true);this.setBoldText(bBoldText);if(fnOnControlValueChanged!=undefined)fnOnControlValueChanged(this);}};return(CheckBox);}function CheckBoxValueChanged(CheckBox,sURL){var sAttrName=CheckBox.getAttribute("AttrName");var BoolUpdate=CreatePostRequest(g_sAdminXMLPath+sURL);if(CheckBox.getContent("hidden"))BoolUpdate.setParameter(sAttrName,document.getElementById(CheckBox.getContent("hidden").getId()).value);else BoolUpdate.setParameter(sAttrName,((CheckBox.getControlValue()==false)?0:1));SavingDialog(true);BoolUpdate.request();BoolUpdate.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=g_nSessionOkay){if(CheckBox.getContent("hidden")!=undefined)CheckBox.setChecked((!CheckBox.getControlValue()),true);AlertDialog(GetResultText(0,"",sResultText));}};}function CreateRuleButton(nId,sRuleImage,fnCallback,objParam){var RuleButton=CreatePushButton("",nId,fnCallback,undefined,undefined,objParam);RuleButton.setControlImage(sRuleImage);return(RuleButton);}function CreateRuleButtons(anIds,afnCallbacks,objParam){CreateRuleButton(anIds[0],"toparrow",afnCallbacks[0],objParam);CreateRuleButton(anIds[1],"uparrow",afnCallbacks[1],objParam);CreateRuleButton(anIds[2],"downarrow",afnCallbacks[2],objParam);CreateRuleButton(anIds[3],"bottomarrow",afnCallbacks[3],objParam);}function GetURLParameter(sParameterName,bSkipSanitize){var sParameterValue="";var sCurrentURL=window.location.href;var nPos=sCurrentURL.indexOf("?");if(nPos<=-1)nPos=sCurrentURL.indexOf("&");if(nPos>-1){var sParemeterString=sCurrentURL.substr(nPos+1);var aParameterArray=sParemeterString.split("&");for(var iParam=0;iParam<aParameterArray.length;iParam++){nPos=aParameterArray[iParam].indexOf("=");if(aParameterArray[iParam].substring(0,(nPos+1)).toLowerCase()==(sParameterName.toLowerCase()+"=")){var aParamPosition=aParameterArray[iParam].split("=");if(bSkipSanitize)sParameterValue=aParamPosition[1];else sParameterValue=SanitizeString(aParamPosition[1]);break;}}}return(sParameterValue);}function SanitizeString(sStr){var sSanitizedStr;sSanitizedStr=sStr.replace(eval("/\\</g"),"&lt;");sSanitizedStr=sSanitizedStr.replace(eval("/\\>/g"),"&gt;");sSanitizedStr=sSanitizedStr.replace(eval("/\\'/g"),"&apos;");sSanitizedStr=sSanitizedStr.replace(eval("/\"/g"),"&#x22;");sSanitizedStr=sSanitizedStr.replace(eval("/\\)/g"),"&#x29;");sSanitizedStr=sSanitizedStr.replace(eval("/\\(/g"),"&#x28;");return(sSanitizedStr);}function OnSendNOOP(bWebClient){var sNOOPCmd="/?Command=NOOP";var NOOPRequest=CreatePostRequest(sNOOPCmd);var nNOOPDelay=55000;if(g_bFVJVLoggedInCheck)nNOOPDelay=10000;NOOPRequest.request();NOOPRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay&&g_nNOOPRetry>=5){if(g_bFVJVLoggedInCheck)GoToLogin();else{if(bWebClient){if(g_bMediaPreviewActive)OnKillMediaShow();setTimeout(function(){if(sResultText==undefined)AlertDialog(GetResultText(0,"",sResultText),true,OnWebClientLogout);else AlertDialog(GetResultText(0,"",sResultText));},1000);}else AlertDialog(GetResultText(0,"",sResultText));}}else{if(nResult!=g_nSessionOkay){g_nNOOPRetry++;nNOOPDelay=0;}else g_nNOOPRetry=0;setTimeout(function(){OnSendNOOP(bWebClient);},nNOOPDelay);}};}function DisableTab(sID,TabGrid,sBodyText,bInfo){if(sBodyText!=undefined)document.getElementById(sID+"Body").innerHTML=sBodyText;document.getElementById(sID).style.display="none";document.getElementById(sID+"None").style.display="block";if(TabGrid!=undefined){TabGrid.EnableUpdatesDef=TabGrid.EnableUpdates;TabGrid.EnableUpdates(false);TabGrid.EnableUpdates=function(){return;};}if(bInfo)document.getElementById(sID+"DisableImage").src=(g_sImagePath+"Information.png");}function EnableTab(sID,TabGrid){document.getElementById(sID+"None").style.display="none";document.getElementById(sID).style.display="block";if((TabGrid)&&(TabGrid.EnableUpdatesDef!=undefined))TabGrid.EnableUpdates=TabGrid.EnableUpdatesDef;}function LaunchFVJV(bBypassWCPCheck){if(g_bMultiTransferLoaded&&g_bWebClientProActive&&bBypassWCPCheck!=true){if(IsAppletWorking()==1)OnWCPQuitPrompt(function(){LaunchFVJV(true)});else LaunchFVJV(true);}else{if(g_bFVJVLicense){g_PageUnloading=true;g_bLinkRequested=true;location.href=g_sCommonPath+"FVJVLoggedIn.htm";}else{ConfirmDialog(g_sFVJVLicenseInfo,OnMoreFVJVInfo);}}}function OnViewFileShareConsole(){if(g_bAllowAdhocFileSharing){g_PageUnloading=true;location.href=g_sWebFilePath+"Share/Console.htm";}else{ConfirmDialog(g_sAdhocFileShareLicenseInfo,OnMoreAdhocInfo);}}function OnMoreAdhocInfo(){window.open("https://www.serv-u.com/customerservice/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank");}function Trim(sString){sString=sString.replace(eval("/^\\s*|\\s*$/g"),"");return sString;}function LaunchHelp(sHelpPage,sHelpNode){if(sHelpPage==""||sHelpPage==null||sHelpPage==undefined)sHelpPage=g_sHelpPage;sHelpPath="http://"+g_sHelpPath+"/documentation/serv-u/help.aspx?topic="+sHelpPage;window.open(sHelpPath,"_help");}function LaunchClientHelp(sHelpPage,sHelpNode){if(sHelpPage==""||sHelpPage==null||sHelpPage==undefined)sHelpPage=g_sHelpPage;sHelpPath="http://"+g_sHelpPath+"/documentation/serv-u-webclient/help.aspx?topic="+sHelpPage;window.open(sHelpPath,"_help");}function OnMoreFVJVInfo(){window.open("https://www.serv-u.com/customerservice/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank");}function IsIPAddressCheck(ipaddr){var parts=ipaddr.split(".");if(parseInt(parseFloat(parts[0]))==0||parseInt(parseFloat(parts[0]))=="NaN"){return false;}for(var i=0;i<parts.length;i++){if(parseInt(parseFloat(parts[i]))>255||parseInt(parseFloat(parts[i]))=="NaN"){return false;}}return true;}function createCookie(name,value,days,bNoPath){var expires,sDomainHost,sHost,nPortPos,bBypassDomainCookie=false;var bIsOperaCheck=(navigator.userAgent.indexOf("Opera")>=0);var bChrome=(navigator.userAgent.toLowerCase().indexOf('chrome')>-1);var ua=navigator.userAgent||"";var sSecure="";var sPath="; path=/;";sEncodedValue=encodeURIComponent(value);sHost=top.location.host.toLowerCase();nPortPos=sHost.indexOf(":");if(nPortPos!=-1){sHost=sHost.substr(0,nPortPos);}if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}else expires="; expires=Thu, 01-Jan-1970 00:00:01 GMT";if((bIsOperaCheck||bChrome)||(ua.match("Safari"))&&IsIPAddressCheck(sHost))bBypassDomainCookie=true;if(sHost!="localhost"&&!bBypassDomainCookie)sDomainHost="domain="+sHost;else sDomainHost="";nDotPos=sHost.indexOf(".");if(nDotPos==-1)sDomainHost="";if(location.protocol=='https:'){sSecure="; secure";}if(bNoPath)sPath="";document.cookie=name+"="+sEncodedValue+expires+sPath+sDomainHost+sSecure;}function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return decodeURIComponent(c.substring(nameEQ.length,c.length));}return"";}function clearSessionCookies(name){document.cookie=name+"=; expires=Thu, 01-Jan-70 00:00:01 GMT"+"; path=/";}function CookieCheck(){if(document.cookie==""){AlertDialog(g_sEnableCookies,true);document.getElementById("CookieCheck").cookieexists.value="false";}else{document.getElementById("CookieCheck").cookieexists.value="true";}}function EnableSelectionOnFormElements(){var bIsOperaCheck=(navigator.userAgent.indexOf("Opera")>=0);var tag_names=["input","textarea"];if(document.getElementsByTagName){for(var i=0;i<tag_names.length;i++){FormElements=document.getElementsByTagName(tag_names[i]);for(var intCounter=0;intCounter<FormElements.length;intCounter++){FormElements[intCounter].onfocus=function(){if(document.attachEvent){if(bIsOperaCheck){document.body.onmousedown=function(){return true;};this.focus();}else{this.detachEvent('onselectstart',StopSelections);this.attachEvent('onselectstart',BubbleCancel);}}else{this.removeEventListener('selectstart',StopSelections,false);this.addEventListener('selectstart',BubbleCancel,false);}};if(tag_names[i]=="textarea"&&bIsOperaCheck){FormElements[intCounter].onclick=function(){this.focus();};}FormElements[intCounter].onblur=function(){if(document.attachEvent){if(bIsOperaCheck){document.body.onmousedown=function(){return false;};}else{this.detachEvent('onselectstart',BubbleCancel);
this.attachEvent('onselectstart',StopSelections);}}else{this.removeEventListener('selectstart',BubbleCancel,false);this.addEventListener('selectstart',StopSelections,false);}};}}}}function BubbleCancel(event){if(AW.ie)event.cancelBubble=true;else event.stopPropagation();}function BuildDialog(sTitle,sDialog,sWidth,sHeight,sStyle,sCloseText,sImageFilePath,bOpaqueDialog,sCSSImgClass){var sDivInner=(sDialog+"inner"),sDialogContainer="",sBackgroundSet="",sTitleStyleSet="";var sDialogInner=document.getElementById(sDivInner).innerHTML;var sOnHideDialog=String("HideDialog(");var sBodyStyle="";if(sStyle!=undefined)sBodyStyle=sStyle;if(bOpaqueDialog){sBackgroundSet="background-color:transparent;color:#ffffff;";sTitleStyleSet="z-index: 8000;position:relative;";}document.getElementById(sDivInner).innerHTML="";sDialogContainer+='<table id="'+sDialog+'TitleBar" style="'+sTitleStyleSet+'"  class="DialogTitle" cellpadding="0" cellspacing="0">';sDialogContainer+=' <tr>';sDialogContainer+='  <td class="headcontainer">';sDialogContainer+='   <div id="'+sDialog+'TitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">';if(sImageFilePath!=undefined)sDialogContainer+='   <img id="'+sDialog+'TitleIcon" src="'+g_sCommonPath+'Images/'+sImageFilePath+'" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="16" height="16" border="0">';else if(sCSSImgClass!=undefined){sDialogContainer+='   <div  id="'+sDialog+'TitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 '+sCSSImgClass+'"></div>';}else sDialogContainer+='   <img id="'+sDialog+'TitleIcon" src="'+g_sCommonPath+'Images/SULogo-Dlg-Ico.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">';sDialogContainer+='   <span id="'+sDialog+'TitleText">'+sTitle+'</span>';sDialogContainer+='   </div>';sDialogContainer+='  </td>';sDialogContainer+='  <td class="closebox" id="'+sDialog+'closebox">';sDialogContainer+='   <span><img id="'+sDialog+'CloseIcon" src="'+g_sCommonPath+'Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="'+sCloseText+'"  border="0" onmousedown="javascript:'+sOnHideDialog+'\''+sDialog+'\');" onmouseover="javascript:document.getElementById(\''+sDialog+'closebox\').className =\'closebox-hover\'" onmouseout="javascript:document.getElementById(\''+sDialog+'closebox\').className =\'closebox\'" width="40" height="40"></span>';sDialogContainer+='  </td>';sDialogContainer+=' </tr>';sDialogContainer+='</table>';if(bOpaqueDialog)sDialogContainer+='<div id="'+sDialog+'opaqueinner" class="opaquedialoginner"></div>';sDialogContainer+='<div id="'+sDialog+'Body" style="'+sBackgroundSet+'z-index:8000;position:relative;width:2px;'+sBodyStyle+'" class="DialogBody">';sDialogContainer+=sDialogInner;sDialogContainer+="</div>";CreateOpaqueLayerDiv(sDialog+"OpaqueLayer");var DialogElement=document.createElement("div");DialogElement=document.createElement("div");DialogElement.id=sDialog;DialogElement.className="DialogLayer";DialogElement.style.width=parseInt(sWidth)+"px";DialogElement.style.left="-5000px";DialogElement.style.top="-5000px";if(sStyle=="text-align:center")DialogElement.style.textAlign="center";DialogElement.innerHTML=sDialogContainer;document.getElementsByTagName("body")[0].appendChild(DialogElement);}function CreateOpaqueLayerDiv(sLayerID,bBubbleTip){var DialogElement=document.createElement("div");DialogElement.id=(sLayerID);if(bBubbleTip)DialogElement.className="OpaqueLayerBubble";else DialogElement.className="OpaqueLayer";document.getElementsByTagName("body")[0].appendChild(DialogElement);}function AddOnloadEvent(fnc){if(typeof window.addEventListener!="undefined")window.addEventListener("load",fnc,false);else if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",fnc);}else{if(window.onload!=null){var oldOnload=window.onload;window.onload=function(e){oldOnload(e);window[fnc]();};}else window.onload=fnc;}}function eraseCookie(name){createCookie(name,"",false);}function SetActiveStyleSheet(sStyleTitle){var i,StyleTag;for(i=0;(StyleTag=document.getElementsByTagName("link")[i]);i++){if(StyleTag.getAttribute("rel").indexOf("style")!=-1&&StyleTag.getAttribute("title")){StyleTag.disabled=true;if(StyleTag.getAttribute("title")==sStyleTitle)StyleTag.disabled=false;}}}function LoadCustomImage(bDisableBranding,bHasCustomLogo){var CustomImg=new Image();var sCustomImgSrc="/%25LOGO_FILE%25"+g_sWebFilePath+"Images/SULogo500x88-2.png"+SyncRequestParameter();var nWidth="400";var nHeight="100";if(bDisableBranding&&!bHasCustomLogo){sCustomImgSrc=g_sCommonPath+"Images/blank.gif"+SyncRequestParameter();nWidth="1";nHeight="1";}if(bDisableBranding){if(document.getElementById("FooterLogos"))document.getElementById("FooterLogos").style.display="none";if(document.getElementById("FooterCopyright"))document.getElementById("FooterCopyright").style.display="none";}CustomImg.src=sCustomImgSrc;document.getElementById("SULoginLogo").src=CustomImg.src;document.getElementById("SULoginLogo").width=nWidth;document.getElementById("SULoginLogo").height=nHeight;}function CreateJSElement(sSource,bIsTextSource,bBody){var ScriptElement=document.createElement("script");ScriptElement.setAttribute("type","text/javascript");ScriptElement.setAttribute("language","JavaScript");if(bIsTextSource)ScriptElement.text=sSource;else ScriptElement.setAttribute("src",sSource);document.getElementsByTagName((bBody)?"body":"head")[0].appendChild(ScriptElement);}function DynamicContentRun(fnDone,oParams){if(typeof(fnDone)=="function")fnDone(oParams);else{window.g_SUDynamicParams=oParams;eval(fnDone+"window.g_SUDynamicParams);");window.g_SUDynamicParams=undefined;}}function LoadDynamicContentAndRun(aParams){LoadingDialog(true);if(!$("#"+aParams[1]).length)$("body").append("<div id='"+aParams[1]+"' style='display:none;'></div>");if(document.getElementById(aParams[1]).innerHTML!="")DynamicContentRun(aParams[2],aParams[3]);else{LoadDynamicContent(aParams[0],aParams[1],function(){DynamicContentRun(aParams[2],aParams[3]);});}}function LoadDynamicContent(sPage,sDivID,fnOnDone){var Request;if(Request=createAWHttpRequest("GET",sPage,OnLoadDynamicContent)){Request.m_sDivID=sDivID;Request.m_fnOnDone=fnOnDone;Request.request();}}function OnLoadDynamicContent(){var sContent=this.getResponseText(),sScript="";var nIndex=0,nEnd=0,nTemp=0;var aJSContent=new Array();while((nIndex=sContent.indexOf("<script"),nIndex)>=0){if((nEnd=sContent.indexOf("<\/script>",(nIndex+1)))){sScript=sContent.substring(nIndex,nEnd);sScript=sScript.substring(sScript.indexOf(">")+1);if(sScript!="")aJSContent.push(sScript);sContent=sContent.substring(0,nIndex)+sContent.substring(nEnd+9);}}document.getElementById(this.m_sDivID).innerHTML=sContent;for(var nIndex=0;nIndex<aJSContent.length;nIndex++)CreateJSElement(aJSContent[nIndex],true);if(typeof(this.m_fnOnDone)=="function")this.m_fnOnDone.call(this);EnableSelectionOnFormElements();}function DelayLoadExecute(afnParams,bSkipLoadingDlg,bDismissLoad){if(afnParams[0]()){if(bDismissLoad)LoadingDialog(false);if(typeof(afnParams[1])=="function")afnParams[1]();else eval(afnParams[1]);EnableSelectionOnFormElements();}else{if(!bSkipLoadingDlg)LoadingDialog(true);setTimeout(function(){DelayLoadExecute(afnParams,true,bDismissLoad);},250);}}function findPos(obj){var nCurleft=nCurtop=0;if(obj.offsetParent){nCurleft=obj.offsetLeft;nCurtop=obj.offsetTop;while(obj=obj.offsetParent){nCurleft+=obj.offsetLeft;nCurtop+=obj.offsetTop;}}return[nCurleft,nCurtop];}function ResizeGrids(bDoColChange){var w_MaxHeight=1600,w_MinHeight=700,nScrollAdjust=20;var anDim=GetScreenDim(30,20);var nIEOffset=0;var nIpadOffSet=0;if(g_bIsiPad)nIpadOffSet=50;if(navigator.appName.indexOf("Microsoft")!=-1)nIEOffset=5;w_NewHeight=anDim[1];if(w_NewHeight>w_MaxHeight)w_NewHeight=w_MaxHeight;else if(w_NewHeight<w_MinHeight)w_NewHeight=w_MinHeight;w_NewHeight=(w_NewHeight-5);if(g_ActiveRezizeGrid!=undefined){if(typeof(g_ActiveRezizeGrid)=="string"){document.getElementById(g_ActiveRezizeGrid).style.height=parseInt(w_NewHeight-(g_nGridOffSet+nIEOffset+nIpadOffSet))+"px";}else{var nTotalCols=(g_ActiveRezizeGrid.getColumnCount());if(g_ActiveRezizeGrid.element().offsetWidth>0){ResizeColumns(nTotalCols,g_ActiveRezizeGrid,nScrollAdjust,bDoColChange);}else{setTimeout(function(){ResizeColumns(nTotalCols,g_ActiveRezizeGrid,nScrollAdjust,bDoColChange);});}g_ActiveRezizeGrid.setStyle("height",parseInt(w_NewHeight-(g_nGridOffSet+nIEOffset+nIpadOffSet))+"px");g_ActiveRezizeGrid.setContentHeight(w_NewHeight-((g_nGridOffSet+nIEOffset+nIpadOffSet)+5),"total");}}if(!g_bWindowResizeSet){g_bWindowResizeSet=true;window.onresize=function(){ResizeGrids(false);};}}function GetScreenDim(nOffSetIE,nOffSetFF){var anScreenDims=[];if(navigator.appName.indexOf("Microsoft")!=-1){w_newWidth=document.documentElement.clientWidth;w_newHeight=document.documentElement.clientHeight-nOffSetIE;}else{var netscapeScrollWidth=nOffSetFF;w_newWidth=window.innerWidth-netscapeScrollWidth;w_newHeight=window.innerHeight-netscapeScrollWidth;}anScreenDims=[w_newWidth,w_newHeight];return(anScreenDims);}function HasMoreDialogs(){var bHasMoreDlgs=false;for(var i=0;i<Dialogs.length;i++){if(Dialogs[i]!=undefined){if(document.getElementById(Dialogs[i].m_sOpaqueLayer).style.display=="block"){bHasMoreDlgs=true;break;}}}return(bHasMoreDlgs);}function IsMacOS(){var bFound=false;var sFind="mac os";var sUserAgent=navigator.userAgent.toLowerCase();var nStartIdx=sUserAgent.indexOf(sFind);if(nStartIdx>=0)bFound=true;return(bFound);}function IsFirefox(){var bFound=false;var sFind="firefox";var sUserAgent=navigator.userAgent.toLowerCase();var nStartIdx=sUserAgent.indexOf(sFind);if(nStartIdx>=0)bFound=true;return(bFound);}function GetIEMajorVersionNumber(){var nMajorVersionNumber=-1;var sUserAgent=navigator.userAgent;if(sUserAgent!=null&&sUserAgent!=undefined){var sMSIE="MSIE";var nFoundMSIE=sUserAgent.indexOf(sMSIE);if(nFoundMSIE!=-1){var nMajorVersionIndex=(nFoundMSIE+(sMSIE.length+1));var nMajorVersionDotIndex=sUserAgent.indexOf('.',nMajorVersionIndex);if(nMajorVersionIndex<nMajorVersionDotIndex){var sMajorVersion=sUserAgent.substring(nMajorVersionIndex,nMajorVersionDotIndex);if(sMajorVersion!=null&&sMajorVersion!=undefined)nMajorVersionNumber=parseInt(sMajorVersion);}}}return(nMajorVersionNumber);}function IsIE7(){return(GetIEMajorVersionNumber()==7);}function IsIE8(){return(GetIEMajorVersionNumber()==8);}function IsIE9(){return(GetIEMajorVersionNumber()==9);}function IsIE10(){return(GetIEMajorVersionNumber()==10);}function ToggleApplet(bHideIt,bCheckForDlgs,bFromApplet,bForceIt){if((g_bMultiTransferLoaded)&&(g_bWebClientProActive)){if(g_bContextKeepAppletHidden)bHideIt=true;if((bCheckForDlgs)&&(HasMoreDialogs()))bHideIt=true;g_bMultiTransferHidden=bHideIt;if(!g_PageUnloading){if(bHideIt){var anDim=GetScreenDim(4,15);var nWidth=anDim[0];var nHeight=anDim[1];OnHideApplet(nWidth,nHeight);try{document.getElementById(g_sAppletFrameID).style.visibility="hidden";}catch(err){if(console.log)console.log("AppletIdContainer is NULL; which could happen due to killing it before it's loaded.");}}else{try{document.getElementById(g_sAppletFrameID).style.visibility="visible";}catch(err){if(console.log)console.log("AppletIdContainer is NULL; which could happen due to killing it before it's loaded.");}OnShowApplet();if(g_nShowList!=0)FilesList.element().focus();}}g_bContextKeepAppletHidden=false;}else if(bForceIt){if(bHideIt){if(document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).style.visibility="hidden";}else{if(document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).style.visibility="visible";}}}function ShowApplet(bFromApplet){ShowAppletEx(true,bFromApplet);}function ShowAppletEx(bCheckForDlgs,bFromApplet){ToggleApplet(false,bCheckForDlgs,bFromApplet);}function HideApplet(bFromApplet){HideAppletEx(true,bFromApplet);}function HideAppletEx(bCheckForDlgs,bFromApplet){ToggleApplet(true,bCheckForDlgs,bFromApplet);}function ResizeColumns(nCols,objGrid,nScrollWidth,bDoColChange){if(objGrid===undefined)return;var nGridWidth=((objGrid.element().offsetWidth)-nScrollWidth);var nGridColSize=0,bMinimize=false;if((objGrid.inMotion==undefined&&bDoColChange)||(!bDoColChange)){if(nGridWidth>0)g_nGridWidth=nGridWidth;if(objGrid.anColWidth==undefined){objGrid.anColWidth=[];objGrid.nTotalColWidth=0;objGrid.nDivisibleCols=nCols;for(var nIndex=0;nIndex<(nCols);nIndex++){objGrid.anColWidth[nIndex]=objGrid.getColumnWidth(nIndex);objGrid.nTotalColWidth=objGrid.nTotalColWidth+objGrid.anColWidth[nIndex];if(objGrid.m_ColumnNoResize[nIndex]==1)objGrid.nDivisibleCols=objGrid.nDivisibleCols-1;}}if((g_nGridWidth)<objGrid.nTotalColWidth){nGridColSize=parseInt((objGrid.nTotalColWidth-g_nGridWidth)/objGrid.nDivisibleCols);bMinimize=true;}else nGridColSize=parseInt((g_nGridWidth-objGrid.nTotalColWidth)/objGrid.nDivisibleCols);if(nGridColSize>0){for(var nIndex=0;nIndex<(nCols);nIndex++){if(objGrid.m_ColumnNoResize[nIndex]!=1){if(bMinimize)objGrid.setColumnWidth(parseInt(objGrid.anColWidth[nIndex]-nGridColSize),nIndex);else objGrid.setColumnWidth(parseInt(objGrid.anColWidth[nIndex]+nGridColSize),nIndex);}}}}objGrid.inMotion=true;objGrid.onColumnWidthChanged=function(width,index){if(this.anColWidth!=undefined&&index!=undefined){var nCurrentWidth=this.nTotalColWidth;if(parseInt(width)>this.anColWidth[index])this.nTotalColWidth=nCurrentWidth+(parseInt(width)-this.anColWidth[index]);else this.nTotalColWidth=nCurrentWidth-(this.anColWidth[index]-parseInt(width));this.anColWidth[index]=parseInt(width);}};}function GetStatsDateTimeFormat(data){var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();if((typeof(data)=="undefined")||(data=="")||(data.toString()=="0"))return("");else{if((AW.ie)&&(parseInt(navigator.appVersion)>=4))return(VBDateFormat(data,nTimeZoneOffset));else{return(FormatFileDate(data));}}}function PasswordGen(nLen){var sChars="bcdfghjklmnpqrstvwxyz";var sPassword="";var nPassLength=8;if((nLen!=undefined)&&(nLen!="")&&(nLen!="0"))nPassLength=parseInt(nLen);for(x=0;x<nPassLength;x++){i=Math.floor(Math.random()*sChars.length);var bCaps=Math.round(Math.random()*1);if(bCaps==0)sPassChar=sChars.charAt(i).toUpperCase();else sPassChar=sChars.charAt(i);sPassword+=sPassChar;}var nNumLen;nNumLen=Math.round(Math.random()*(nPassLength-1))+1;for(var n=0;n<nNumLen;n++){var nNumPos=Math.round(Math.random()*(nPassLength-1));var nNumber=Math.round(Math.random()*9);if(nNumPos==0)sPassword=nNumber+sPassword.substring(1);else if(nNumPos==nPassLength)sPassword=sPassword.substring(0,(nPassLength-1))+nNumber;else sPassword=sPassword.substring(0,(nNumPos-1))+nNumber+sPassword.substring(nNumPos);}return(sPassword);}function GetResultText(nResult,sFailError,sErrorText){var sText=sErrorText;switch(nResult){case 1:case 3:case 6:if(sFailError!=""&&sFailError!=undefined)sText=sFailError;break;}if(sText==""||sText==undefined)sText=g_sUnknownError;return(sText);}function CheckEmailValidation(sEmail){if(sEmail!=""){var nAtPos=sEmail.indexOf("@");var nDotPos=sEmail.lastIndexOf(".");if(nAtPos<=0||parseInt(sEmail.indexOf(".",nAtPos))==-1||nDotPos<(nAtPos+2)||(nDotPos+1)>=sEmail.length)return(false);else return(true);}else return(true);}function DomainSortAlpha(a,b){var bIsNum=false;var nCompareResult;var ta=a[0];var tb=b[0];if(isNaN(ta)&&isNaN(tb)){ta=ta.toLocaleLowerCase();tb=tb.toLocaleLowerCase();nCompareResult=ta.localeCompare(tb);}else bIsNum=true;if(!bIsNum){if(nCompareResult>0)return 1;if(nCompareResult<0)return-1;return 0;}else{if(ta>tb)return 1;if(ta<tb)return-1;return 0;}}function ArrayAlphaSort(asVar1,asVar2){return(asVar1[0].localeCompare(asVar2[0]));}function FormatNumberCommas(nNumber,bNoDecimal){var sNumberReturn="";if(nNumber.toLocaleString().valueOf()=="[object Number]")sNumberReturn=nNumber;else sNumberReturn=nNumber.toLocaleString();if(bNoDecimal){if(sNumberReturn.substr(sNumberReturn.length-3)==".00"||sNumberReturn.substr(sNumberReturn.length-3)==",00")sNumberReturn=sNumberReturn.substr(0,(sNumberReturn.length-3));}return(sNumberReturn);}function IsAppletWorking(){return(OnAppletIsWorking());}function OnEqualOneContextMenu(objGrid,sButtonText){if(objGrid.getSelectedRows().length==1){sMenuItemName=sButtonText;}else{sMenuItemName="";}return(sMenuItemName);}function OnGreaterZeroContextMenu(objGrid,sButtonText){if(objGrid.getSelectedRows().length>0){sMenuItemName=sButtonText;}else{sMenuItemName="";}return(sMenuItemName);}function GetFileName(sPath,bUrlDecodeIt){var sFileName=sPath;if(sPath!=null&&sPath!=undefined&&sPath!=""){if(bUrlDecodeIt)sPath=decodeURIComponent(sPath);var nLastIndex=-1;var nLastIndexForwardSlash=sPath.lastIndexOf('/');var nLastIndexBackSlash=sPath.lastIndexOf('\\');if(nLastIndexForwardSlash>-1&&nLastIndexBackSlash>-1)nLastIndex=Math.max(nLastIndexForwardSlash,nLastIndexBackSlash);else if(nLastIndexForwardSlash>-1)nLastIndex=nLastIndexForwardSlash;else nLastIndex=nLastIndexBackSlash;if(nLastIndex>-1)sFileName=sPath.substring(nLastIndex+1);}if(bUrlDecodeIt&&sFileName!=undefined&&sFileName!=null&&sFileName!="")sFileName=decodeURIComponent(sFileName);return(sFileName);}function GetFileIcon(sStr,bLowerCase){var asExtensions={"AVI":1,"BAT":1,"BMP":1,"C":1,"CAB":1,"CHM":1,"CNT":1,"CPP":1,"CRT":1,"CSV":1,"DEF":1,"DLL":1,"DOC":1,"DOT":1,"DSP":1,"DSW":1,"EXE":1,"GIF":1,"H":1,"ANI":1,"HTML":1,"HTM":1,"HXC":1,"HXI":1,"HXK":1,"HXS":1,"HXT":1,"INI":1,"ISO":1,"JPG":1,"JS":1,"MAK":1,"MDB":1,"MDE":1,"MDW":1,"MDZ":1,"MID":1,"MP3":1,"URL":1,"MOV":1,"MPG":1,"MSI":1,"PPT":1,"PDF":1,"POT":1,"PNG":1,"RC":1,"REG":1,"RTF":1,"SCT":1,"SLN":1,"HLP":1,"TTF":1,"TXT":1,"VBS":1,"SAFARI":1,"FIREFOX":1,"VCPROJ":1,"VCXPROJ":1,"VSSSCC":1,"XML":1,"WAV":1,"WMA":1,"WMV":1,"WMZ":1,"WRI":1,"XLS":1,"ZIP":1,"PSD":1,"AI":1,"INDD":1,"ACCDB":1,"DOCX":1,"DOTX":1,"POTX":1,"PPTX":1,"PUB":1,"XLSX":1,"XLTX":1,"RAR":1,"7Z":1,"M4A":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"HTM":case"HTML":case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;case"7ZFM":case"7ZG":sStr="7Z";break;}if(asExtensions[sStr]){if(bLowerCase)return(sStr.toLowerCase()+"Ext");else return(sStr+"Ext");}else{if(bLowerCase)return("defaultExt");else return("DefaultExt");}}function GetLargeFileIcon(sStr){var asExtensions={"DLL":1,"ISO":1,"MID":1,"WMV":1,"MPG":1,"SAFARI":1,"SAFURL":1,"FIREFOX":1,"FFURL":1,"MOV":1,"M4A":1,"MDB":1,"MP3":1,"PDF":1,"PPT":1,"PNG":1,"DOC":1,"URL":1,"XLS":1,"ZIP":1,"TXT":1,"HTM":1,"HTML":1,"EXE":1,"PSD":1,"AI":1,"INDD":1,"VCXPROJ":1,"ACCDB":1,"DOCX":1,"DOTX":1,"POTX":1,"PPTX":1,"PUB":1,"XLSX":1,"XLTX":1,"RAR":1,"7Z":1,"M4A2":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"RTF":case"RTX":sStr="DOC";break;case"LOG":sStr="TXT";break;break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"ARC":case"TAR":case"GZ":case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;case"7ZFM":case"7ZG":sStr="7Z";break;case"WMA":sStr="MP3";break;case"HTM":case"HTML":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFURL";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FFURL";break;case"M4A":sStr="M4A2";break;}if(asExtensions[sStr]){return(sStr+"Ext");}else return("DefaultExt");}function GetDriveIcon(nType){var asDriveImages=["DRIVE_UNKNOWN","DRIVE_NO_ROOT_DIR","DRIVE_REMOVABLE","DRIVE_FIXED","DRIVE_REMOTE","DRIVE_CDROM","DRIVE_RAMDISK","DRIVE_REMOVABLE_OTHER"];nType=parseInt(nType);if((!isNaN(nType))&&(nType<asDriveImages.length))return(asDriveImages[nType]);else return("DRIVE_UNKNOWN");}function SWIDemoFrame(){setTimeout(function(){var DemoJSFile=document.createElement('script');DemoJSFile.setAttribute("type","text/javascript");DemoJSFile.setAttribute("src",g_sCommonPath+"DemoContain.js");document.getElementsByTagName("body")[0].appendChild(DemoJSFile);ifrm=document.createElement("IFRAME");ifrm.setAttribute("src",g_sCommonPath+"SWIDemo.htm");ifrm.setAttribute("frameBorder","0");ifrm.style.width="100%";ifrm.style.height="57px";ifrm.style.overflow="hidden";ifrm.style.position="absolute";ifrm.style.top="0";ifrm.style.left="0";ifrm.style.zIndex="0";ifrm.setAttribute("scrolling","no");DivBar=document.createElement("div");DivBar.setAttribute("id","demodiv");DivBar.style.width="100%";DivBar.style.height="55px";DivBar.style.overflow="hidden";DivBar.setAttribute("class","sw-mainnav-branding");if(g_bIsWebClient){document.getElementById("container").insertBefore(DivBar,document.getElementById("container").firstChild);document.getElementById("container").insertBefore(ifrm,document.getElementById("container").firstChild);}else{document.body.insertBefore(DivBar,document.body.firstChild);document.body.insertBefore(ifrm,document.body.firstChild);}if((document.getElementById("TopPntToolTipDialog")!=undefined)&&(!isNaN(parseInt(document.getElementById("TopPntToolTipDialog").style.top))))document.getElementById("TopPntToolTipDialog").style.top=(parseInt(document.getElementById("TopPntToolTipDialog").style.top)+parseInt(DivBar.style.height))+"px";},0);}function CleanPathByEscape(sPath){sRawFilePath=encodeURIComponent(sPath);sRawFilePath=sRawFilePath.replace(new RegExp("[\(]","g"),"\\(");sRawFilePath=sRawFilePath.replace(new RegExp("[\)]","g"),"\\)");sRawFilePath=sRawFilePath.replace(new RegExp("'","g"),"\\'");return(sRawFilePath);}function ShowHideTrialNotification(bShow){var nDaysRemaining=g_nDaysRemaining;var bPassedTrial=(g_bLicenseIsTemp)?false:(g_bLicenseIsPastTrial);var sTrialColor="";var sExpireTxt=g_sTrialExpiresInTxt+" <span id='TrialExpireDays'></span> "+g_sTrialExpiresDaysTxt;if(bShow){if(g_bIsModEvalExp){$("#ActivateTrial").show();$("#ActivateTrialTxt").css("visibility","visible");}else{$("#ActivateTrial").hide();$("#ActivateTrialTxt").css("visibility","hidden");}$("#container").css("min-width","1250px");if(nDaysRemaining>15&&!bPassedTrial){sTrialColor="green";}else if((nDaysRemaining<=15&&nDaysRemaining>0)&&!bPassedTrial){sTrialColor="yellow";}else{sExpireTxt=g_sTrialExpiredTxt;sTrialColor="red";}$("#TrialExpireTxt").html(sExpireTxt);if(sTrialColor!="red")$("#TrialExpireDays").text(nDaysRemaining);$("#TrialExpire").addClass(sTrialColor);$("#TrialExpire").show();}else{$("#TrialExpire").hide();$("#container").css("min-width","650px");}}function ShowMaintenenceInfoBox(nDaysRemaining,nLicenseDays,ReggieDate){var sMaintExpireColor="";var UpgradeDate=new Date(ReggieDate.getTime()+(nLicenseDays*86400000));if(nDaysRemaining>7&&nDaysRemaining<=30){sMaintExpireColor="yellow";}else if(nDaysRemaining<=7){sMaintExpireColor="red";}else $("#MaintContain").removeClass("red").removeClass("yellow");$("#MaintDays").text(nDaysRemaining);$("#MaintDate").text($.datepicker.formatDate("MM d, yy",UpgradeDate));$("#MaintContain").addClass(sMaintExpireColor);$("#MaintContain").show();}function IsValidEmailAddressString(sEmailAddress){var bIsValid=true;var sEmailFilter=eval("/^([A-Za-z0-9_\\s\\-\\.])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/");if(!sEmailFilter.test(sEmailAddress))bIsValid=false;return(bIsValid);}function RecordException(exception,bShowAlert){var txt="An exception has occurred.\n\n";txt+="Error description: "+exception.description+"\n\n";if(console.log)console.log(txt);if(bShowAlert!=undefined&&bShowAlert){txt+="Click OK to ignore this exception and continue.\n\n";alert(txt);}}