<html class=" aw-all aw-strict aw-classic aw-classic-strict aw-png2 aw-all aw-strict aw-classic aw-classic-strict aw-png2"><head><title>vi.gymbaby.cn - /</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link type="text/css" href="/Common/Style/jquery/jquery-ui.css" rel="stylesheet"><link type="text/css" href="/Common/Style/jquery/jquery-contextMenu.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/Web Client/Include/ThumbScroll/jquery.jcarousel.css"><link rel="stylesheet" type="text/css" href="/Web Client/Include/ThumbScroll/skin.css"><link type="text/css" href="/Common/Style/Dialog.css" rel="stylesheet"><link type="text/css" href="/Common/Style/CommonHeader.css" rel="stylesheet"><link type="text/css" href="/Web Client/Style/List.css" rel="stylesheet"><link type="text/css" href="/Web Client/Style/WebClientIcons.css" rel="stylesheet"><link type="text/css" href="/Common/Style/CommonUI.css" rel="stylesheet"><script type="text/javascript" language="JavaScript" src="/Common/Scripts/aw-2-6-4.js"></script><script type="text/javascript" src="/Web Client/Include/WCJQueryContain.js"></script><style type="text/css">.aw-column-1 {text-align:right}.aw-vista .aw-highlightit-OFF{background: #fff url(/Common/Images/blank.gif);}.aw-vista .aw-highlightit-ON{background: #ebf3fd url(/Common/Images/FileList-Hover.png);}.thumb-selectable .thumbcell {border: 1px solid transparent;}.thumb-selectable .thumbcell.ui-selecting {background: none repeat scroll 0 0 #cfe5fe;border: 1px solid #84acdd;}.thumb-selectable .thumbcell.ui-selected {background: none repeat scroll 0 0 #cfe5fe;border: 1px solid #84acdd;}.thumb-selectable {list-style-type: none;margin: 0;padding: 0;}.ui-selectable-helper { position: absolute; z-index: 100; border:1px dotted black; }.footerDiv1 {margin-top: 12px;font-size: 8pt !important;color: #909095;font-family: arial !important;}/* 10/28/2013 - #dlb - Use this to display the stupid firefox confirmation dialog regarding the java plugin overtop our main body.NOTE: You must override these settings for the actual applet (i.e., Web Client Pro).*/embed, object {position: absolute;		/* default:		static	*/top: 1px;				/* default:		auto	*/left: 1px;				/* default:		auto	*/}.styledApplet {position: static;top: auto;left: auto;}</style><script type="text/javascript" language="JavaScript">if(isNaN(parseInt("4329620"))||parseInt("4329620")<1)location.href="/?Command=Login";else if((1!=1))location.href="/Web Client/DisabledInterface.htm";var CONTEXT_MENU_GRID_NOTHING_SELECTED=0;var CONTEXT_MENU_GRID_FILE_SELECTED=1;var CONTEXT_MENU_GRID_FOLDER_SELECTED=2;var CONTEXT_MENU_GRID_FOLDERS_SELECTED=3;var CONTEXT_MENU_GRID_FILES_SELECTED=4;var CONTEXT_MENU_GRID_MIXED_SELECTION=5;var g_sEncXsrfToken="937501ADAC24ADFED461BD81C5A9B39E";var g_bIsWebClient=true;var g_bIsDemo=(0==1);var g_bIsiPad=false;var agent=navigator.userAgent.toLowerCase();var TOOLTIP_SHOW_DELAY_IN_MILLIS=500;var TOOLTIP_SHOW_DURATION_IN_MILLIS=10;var TOOLTIP_HIDE_DELAY_IN_MILLIS=10;var TOOLTIP_HIDE_DURATION_IN_MILLIS=250;var bIs_iPhone=false,bIs_BlackBerry=false,bIs_IEMobile=false,bIs_AndroidMobile=false,bIs_KindleMobile=false;if((agent.indexOf('iphone')!=-1)||(agent.indexOf('ipod')!=-1)||(agent.indexOf('ipad')!=-1))bIs_iPhone=true;if((agent.indexOf('blackberry')!=-1))bIs_BlackBerry=true;if((agent.indexOf('iemobile')!=-1)||(agent.indexOf('windows phone')!=-1))bIs_IEMobile=true;if((agent.indexOf('android')!=-1))bIs_AndroidMobile=true;if((agent.indexOf('kindle')!=-1)||(agent.indexOf('silk')!=-1))bIs_KindleMobile=true;if(bIs_iPhone||bIs_BlackBerry||bIs_IEMobile||bIs_AndroidMobile||bIs_KindleMobile){var sURL=window.location.href;var sParameterString="";var nPos=sURL.indexOf("?");if(nPos<=-1)nPos=sURL.indexOf("&");if(nPos>-1)sParameterString=sURL.substr(nPos);sParameterString=sParameterString.replace("/?Command=Logout","");window.location='/Web Client/Mobile/MListDir.htm'+sParameterString;}var g_sFontOverride="font-family:sans-serif !important;font-size:9pt;";var g_bIslocalAdminBrowser=false;var g_bReloadImagePreview=false;var g_bReloadMediaPreview=false;var g_bUploadActive=false;var g_bButtonsLoaded=false;if(0){g_bIslocalAdminBrowser=true;}var asPreloadImgs=["/Common/Images/Busy.gif"];for(var nIndex=0;(nIndex<asPreloadImgs.length);nIndex++){LoadingImg=new Image();LoadingImg.src=asPreloadImgs[nIndex];}var g_bDisableBranding=false;var g_bHasCustomLogo=false;if(0){g_bDisableBranding=true;}if(1){g_bHasCustomLogo=true;}function OnHideMenu(aEventInfo){$("body").unbind("mouseup");HideOpaqueLayer("applet",false);CheckFileListFocus();}var g_bAllowWebClientPro=(1==1);var g_bCaseSensitiveOS=(0==1);var g_bUpLoadedImage=false;var Slider1;var g_nRowCount=0;g_bMultiTransferLoaded=false;g_bAppletIsLoading=false;var g_sBottomPaneDivID="BottomPaneDivID";var g_sAppletFrameID="AppletFrameID";var m_nInitialHeightOfTransferPane=0;function ShowBottomPane(){$("#ThumbListFiles").selectable().bind("selectablestop",OnStopSelectTask);FilesList.setSelectionMode("multi-row");ShowSplitterPanes();}function OnInit(sAppletID){if(g_bMultiTransferLoaded)document.getElementById(g_sAppletFrameID).style.visibility="visible";g_bWebClientProActive=true;g_bMultiTransferLoaded=true;g_bAppletIsLoading=false;OnEnableDisableTransModButton(true);AnimateMultiTranIcon(false);document.getElementById(g_sAppletFrameID).contentWindow.OnAppletSetWorkingDir(g_sCurrentDir);}function OnShowOpaqueLayer(){ShowOpaqueLayer("applet",999999,true);}function OnHideOpaqueLayer(){HideOpaqueLayer("applet",true);}function OnUpdateTransferBtns(sFlags){var asFlagParams=sFlags.split(",");var asButtonProperties=[["showinfolder",String("OnTransferShowInFolder()"),"TransferShowInFolder","在文件夹中显示"],["openfile",String("OnTransferOpenFile()"),"TransferOpenFile","打开文件"],["stop",String("OnTransferStopAfter()"),"TransferStopped","文件完成传输后停止"],["skip",String("OnTransferSkip()"),"TransferSkipped","跳过文件"],["pausetrans",String("OnTransferPause()"),"TransferPaused","暂停"],["resume",String("OnTransferResume()"),"TransferResume","续传"],["start",String("OnTransferStart()"),"TransferStart","开始"],["restart",String("OnTransferRestart()"),"TransferRestart","重启"],["cancel",String("OnTransferCancel()"),"TransferCancelled","取消"],["remove",String("OnTransferRemove();"),"TransferDelete","删除"],["removecompleted",String("OnTransferRemoveCompleted()"),"TransferDoneRemoveAll","删除已完成任务"],["removecancelled",String("OnTransferRemoveCancelled()"),"TransferRemoveAllCancelled","已取消删除"],["removeskipped",String("OnTransferRemoveSkipped()"),"TransferRemoveAllSkipped","删除已跳过的操作"],["removepaused",String("OnTransferRemovePaused()"),"TransferRemoveAllPaused","删除已暂停的操作"],["removewaiting",String("OnTransferRemoveWaiting()"),"TransferRemoveAllWaiting","删除正在等候的操作"],["removestopped",String("OnTransferRemoveStopped()"),"TransferRemoveAllStopped","删除已停止的操作"],["removeall",String("OnTransferRemoveAll()"),"TransferRemoveAll","全部删除"]];for(var nIndex=0;(nIndex<asButtonProperties.length);nIndex++){if(parseInt(asFlagParams[(nIndex*2)])==0){if(document.getElementById(asButtonProperties[nIndex][0]+"img")){if(!$("#"+asButtonProperties[nIndex][0]+"img div").hasClass("WCP-"+asButtonProperties[nIndex][2]+"_disabled")||document.getElementById(asButtonProperties[nIndex][0]+"img").innerHTML==""){$("#"+asButtonProperties[nIndex][0]+"img a").removeAttr("href");$("#"+asButtonProperties[nIndex][0]+"img div").attr("id",asButtonProperties[nIndex][0]+"imgico");$("#"+asButtonProperties[nIndex][0]+"img div").attr("title",asButtonProperties[nIndex][3]);$("#"+asButtonProperties[nIndex][0]+"img div").removeClass("WCP-"+asButtonProperties[nIndex][2]).addClass("WCP-"+asButtonProperties[nIndex][2]+"_disabled");}}if(document.getElementById(asButtonProperties[nIndex][0]+"btn"))document.getElementById(asButtonProperties[nIndex][0]+"btn").innerHTML='<a class="highlightbuttonbox" id="'+asButtonProperties[nIndex][0]+'btnhref">'+asButtonProperties[nIndex][3]+'</a>';}else{if(document.getElementById(asButtonProperties[nIndex][0]+"img")){if($("#"+asButtonProperties[nIndex][0]+"img div").hasClass("WCP-"+asButtonProperties[nIndex][2]+"_disabled")||document.getElementById(asButtonProperties[nIndex][0]+"img").innerHTML==""){$("#"+asButtonProperties[nIndex][0]+"img a").attr("href",'javascript:'+asButtonProperties[nIndex][1]+';');$("#"+asButtonProperties[nIndex][0]+"img div").attr("id",asButtonProperties[nIndex][0]+"imgico");$("#"+asButtonProperties[nIndex][0]+"img div").attr("title",asButtonProperties[nIndex][3]);$("#"+asButtonProperties[nIndex][0]+"img div").removeClass("WCP-"+asButtonProperties[nIndex][2]+"_disabled").addClass("WCP-"+asButtonProperties[nIndex][2]);}}if(document.getElementById(asButtonProperties[nIndex][0]+"btn"))document.getElementById(asButtonProperties[nIndex][0]+"btn").innerHTML='<a id="'+asButtonProperties[nIndex][0]+'btnhref" href="javascript:'+asButtonProperties[nIndex][1]+';" class="highlightbuttonbox">'+asButtonProperties[nIndex][3]+'</a>';}}}function OnUpdateStartBtnText(asLabels){var asBtnLabels=asLabels.toString().split(",");for(var nIdx=0;nIdx<asBtnLabels.length;nIdx++){var sLabel=asBtnLabels[nIdx];switch(nIdx){case 0:{document.getElementById("startimgico").title=sLabel;document.getElementById("startbtnhref").title=sLabel;document.getElementById("startbtnhref").innerHTML=sLabel;}break;case 1:{document.getElementById("restartimgico").title=sLabel;document.getElementById("restartbtnhref").title=sLabel;document.getElementById("restartbtnhref").innerHTML=sLabel;}break;default:break;}}}function OnProcessGridItems(asRawFileData){var asFileData=asRawFileData.toString().split(",");var nTotalFiles=(parseInt(asFileData.length)/16);var nIndexFile=1;var nIndexCount=0;var xmlDoc=FilesList.m_XMLTable.getXML();var bDoXML=false;for(var nIdx=0;nIdx<nTotalFiles;nIdx++){var bDeleteFile=false;var FileInfo=[];if(parseInt(asFileData[nIndexFile-1])==1)bDeleteFile=true;nIndexCount=nIndexFile+15;for(var nIdx2=nIndexFile;nIdx2<nIndexCount;nIdx2++){FileInfo.push(asFileData[nIdx2].toString());}nIndexFile=nIdx2+1;if(FileInfo[0].toString()==g_sCurrentDir){if(bDeleteFile){OnDeletedFile(FileInfo);}else{var bFileExists;if(typeof(document.createNSResolver)!='undefined'){var oNSResolver=xmlDoc.createNSResolver(xmlDoc.documentElement);var aItems=xmlDoc.evaluate("//file[FileName='"+FileInfo[1].toString()+"']",xmlDoc,oNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);bFileExists=(aItems.snapshotLength>0);}else{bFileExists=(xmlDoc.selectNodes("//file[FileName='"+FileInfo[1].toString()+"']").length>0);}if(bFileExists)OnUploadedFile(FileInfo);else{bDoXML=true;xmlDoc=AddXMLRow(FileInfo,xmlDoc);}}}}if(bDoXML)SetXMLToGrid(xmlDoc);}function OnShowWaitCursor(){BusyDialog(true,"繁忙",true,true);}function OnHideWaitCursor(){BusyDialog(false,undefined,true,true);}function AddXMLRow(asFileArray,xmlDoc){var NewElement=xmlDoc.createElement("file");FileName=xmlDoc.createElement("FileName");FileName.appendChild(xmlDoc.createTextNode(asFileArray[1]));FileSize=xmlDoc.createElement("FileSize");FileSize.appendChild(xmlDoc.createTextNode(asFileArray[2]));FileDate=xmlDoc.createElement("FileDate");FileDate.appendChild(xmlDoc.createTextNode(asFileArray[3]));FilePath=xmlDoc.createElement("FilePath");FilePath.appendChild(xmlDoc.createTextNode(asFileArray[4]));FileIsDir=xmlDoc.createElement("FileIsDir");FileIsDir.appendChild(xmlDoc.createTextNode(asFileArray[5]));FileIsImage=xmlDoc.createElement("FileIsImage");FileIsImage.appendChild(xmlDoc.createTextNode(asFileArray[6]));FileDriveLabel=xmlDoc.createElement("FileDriveLabel");FileDriveLabel.appendChild(xmlDoc.createTextNode(asFileArray[7]));FileIsDrive=xmlDoc.createElement("FileIsDrive");FileIsDrive.appendChild(xmlDoc.createTextNode(asFileArray[8]));FileDriveType=xmlDoc.createElement("FileDriveType");FileDriveType.appendChild(xmlDoc.createTextNode(asFileArray[9]));FileIsDeleted=xmlDoc.createElement("FileIsDeleted");FileIsDeleted.appendChild(xmlDoc.createTextNode(asFileArray[10]));FileIsAudio=xmlDoc.createElement("FileIsAudio");FileIsAudio.appendChild(xmlDoc.createTextNode(asFileArray[11]));FileIsVideo=xmlDoc.createElement("FileIsVideo");FileIsVideo.appendChild(xmlDoc.createTextNode(asFileArray[12]));FileIsCompressed=xmlDoc.createElement("FileIsCompressed");FileIsCompressed.appendChild(xmlDoc.createTextNode(asFileArray[13]));FileIsEncrypted=xmlDoc.createElement("FileIsEncrypted");FileIsEncrypted.appendChild(xmlDoc.createTextNode(asFileArray[14]));NewElement.appendChild(FileName);NewElement.appendChild(FileSize);NewElement.appendChild(FileDate);NewElement.appendChild(FilePath);NewElement.appendChild(FileIsDir);NewElement.appendChild(FileIsImage);NewElement.appendChild(FileDriveLabel);NewElement.appendChild(FileIsDrive);NewElement.appendChild(FileDriveType);NewElement.appendChild(FileIsDeleted);NewElement.appendChild(FileIsAudio);NewElement.appendChild(FileIsVideo);NewElement.appendChild(FileIsCompressed);NewElement.appendChild(FileIsEncrypted);if(parseInt(asFileArray[6])==1)g_nTotalImages++;if(parseInt(asFileArray[12])==1)g_nTotalMedia++;if(parseInt(asFileArray[11])==1){g_nTotalAudio++;g_nTotalMedia++;}if(parseInt(asFileArray[5])==1){g_nCopyTotalDirs++;document.getElementById("TotalDirs").innerHTML=FormatNumberCommas(g_nCopyTotalDirs);nFileSize=0;}else{g_nCopyTotalFiles++;nFileSize=parseInt(asFileArray[2]);document.getElementById("TotalFiles").innerHTML=g_nCopyTotalFiles;}g_nTotalSize=(g_nTotalSize+nFileSize);document.getElementById("TotalSize").innerHTML=FormatFileSize(g_nTotalSize,true);FileElement=xmlDoc.getElementsByTagName("files")[0];FileElement.appendChild(NewElement);return(xmlDoc);}function SetXMLToGrid(xmlDoc){FilesList.m_fnPostUpdate=function(){OnListDone.call(this,true);};FilesList.FilterGrid("[^1]",9,true,true);if(!g_bSearchView)FilesList.m_XMLTable.response(xmlDoc,true);}function OnUploadedFile(aFileInfo){g_bUploadActive=true;var data=aFileInfo;var bAlreadyPresent=false;var nNewRowIndex;var anRowsIndex;var sFileDirOrigin;var sCurrDirComp;nSize=FilesList.getRowCount();nNewRowIndex=nSize;if(g_bCaseSensitiveOS){sFileDirOrigin=data[0].toString();sCurrDirComp=g_sCurrentDir.toString();}else{sFileDirOrigin=data[0].toString().toLowerCase();sCurrDirComp=g_sCurrentDir.toString().toLowerCase();}var sAbsDir=sFileDirOrigin;var sCurDirEncoded=sCurrDirComp;var sCurDirDecoded=decodeURIComponent(sCurDirEncoded);if((sAbsDir==sCurDirEncoded)){anCurrentIndex=FilesList.getRowIndices();for(var i=0;i<nSize;i++){var sCellText=FilesList.getCellText(3,parseInt(anCurrentIndex[i]));var sCellData=FilesList.getCellData(3,parseInt(anCurrentIndex[i]));var nDeletedFlag=parseInt(FilesList.getCellData(9,parseInt(anCurrentIndex[i])));var sRawPath=data[4].toString();var sRawPathDecoded=decodeURIComponent(data[4].toString());if((sRawPath==sCellData||sRawPathDecoded==sCellText)&&nDeletedFlag!=1){bAlreadyPresent=true;nNewRowIndex=parseInt(anCurrentIndex[i]);break;}}}if(bAlreadyPresent){for(var nIndex=1;nIndex<data.length;nIndex++){nListingIndex=(nIndex-1);var fmtSortCol=FilesList.getCellFormat(nListingIndex);var sDataVal=data[nIndex].toString();var sDataTxt=decodeURIComponent(sDataVal);FilesList.UpdateText(sDataTxt,nListingIndex,parseInt(nNewRowIndex));g_bAddingRow=false;}}g_bAddingRow=false;if(bAlreadyPresent)g_bUploadActive=false;g_bBuildThumbnails=true;return(nNewRowIndex);}function OnDeletedFile(asFileData,bSkipThumbnails){var data=asFileData;var bAlreadyPresent=false;var nDeleteRowIndex;var anRowsIndex;var anFileIndices=FilesList.getRowIndices();nSize=FilesList.getRowCount();nNewRowIndex=nSize;var sCurDirEncoded=g_sCurrentDir.toString();var sCurDirDecoded=decodeURIComponent(sCurDirEncoded);if(data[0].toString()==sCurDirEncoded){for(var i=(nSize-1);i>=0;i--){var sCellText=FilesList.getCellText(3,parseInt(anFileIndices[i]));var sCellData=FilesList.getCellData(3,parseInt(anFileIndices[i]));var sRawPath=data[4].toString();var sRawPathDecoded=decodeURIComponent(data[4].toString());if(sRawPath==sCellData||sRawPathDecoded==sCellText){nDeleteRowIndex=parseInt(anFileIndices[i]);DeleteFileFromGrid(nDeleteRowIndex,bSkipThumbnails);break;}}}}function DeleteFileFromGrid(nIndex,bSkipThumbnails){g_bBuildThumbnails=true;var bSkipPreserve=false;if(FilesList.getCellValue(4,nIndex)==1){g_nCopyTotalDirs--;document.getElementById("TotalDirs").innerHTML=FormatNumberCommas(g_nCopyTotalDirs);nFileSize=0;}else{g_nCopyTotalFiles--;nFileSize=FilesList.getCellValue(1,nIndex);document.getElementById("TotalFiles").innerHTML=g_nCopyTotalFiles;}g_nTotalSize=(g_nTotalSize-nFileSize);document.getElementById("TotalSize").innerHTML=FormatFileSize(g_nTotalSize,true);if(g_nShowList==0){if(FilesList.m_XMLTable.getData(9,nIndex)==""){FilesList.setCellText("1",9,nIndex);FilesList.setCellText("",0,nIndex);}else{FilesList.UpdateText("1",9,nIndex);FilesList.UpdateText("",0,nIndex);}if(FilesList.getCellValue(5,nIndex)==1&&g_nTotalImages>=1){g_nTotalImages--;g_nCurrentPreviewImage--;}if((FilesList.getCellValue(10,nIndex)==1||FilesList.getCellValue(11,nIndex)==1)&&g_nTotalMedia>=1){g_nTotalMedia--;}FilesList.deleteRow(nIndex);}else{nSelectedDeleteIndex=nIndex;if(FilesList.m_XMLTable.getData(9,nSelectedDeleteIndex)==""){FilesList.setCellText("1",9,nSelectedDeleteIndex);FilesList.setCellText("",0,nSelectedDeleteIndex);}else{FilesList.UpdateText("1",9,nSelectedDeleteIndex);FilesList.UpdateText("",0,nSelectedDeleteIndex);}if(FilesList.getCellValue(5,nSelectedDeleteIndex)==1&&g_nTotalImages>=1){g_nTotalImages--;g_nCurrentPreviewImage--;}if((FilesList.getCellValue(10,nSelectedDeleteIndex)==1)&&g_nTotalMedia>=1){g_nTotalMedia--;g_nTotalAudio--;}if((FilesList.getCellValue(11,nSelectedDeleteIndex)==1)&&g_nTotalMedia>=1){g_nTotalMedia--;g_nTotalVideo--;}if(g_nRowCount>100)bSkipPreserve=true;if(!bSkipPreserve)FilesList.PreserveBasicRowState();FilesList.deleteRow(nIndex);if(!bSkipPreserve)FilesList.RestoreBasicRowState();else{FilesList.setSelectedRows([-1]);FilesList.raiseEvent("adjustScrollBars");FilesList.raiseEvent("adjustScrollHeight");FilesList.setScrollTop(-1);}if(g_bBuildThumbnails){g_bFileFromListRemoved=true;}}if(g_nShowList==0&&!bSkipThumbnails){}}function OnAllDoneInCurDir(){if(g_nShowList==0){if(!g_bUploadActive){setTimeout(function(){var nTotalRows=FilesList.getRowCount();g_nThumbnailIter=0;g_nRestartPosition=g_nThumbnailIter;g_nThumbnailIter=nTotalRows;g_nThumbRestart=false;BuildThumbnails(true);},400);}else{setTimeout(function(){OnAllDoneInCurDir();},500);}}if(g_bImagePreviewActive){setTimeout(function(){OnLoadImagePreview(true);if(g_nShowList==0){setTimeout(function(){OnImageNextClick();},500);}},500);}else if(g_bMediaPreviewActive){OnLoadMediaPreview();if(g_nShowList==0){setTimeout(function(){OnMediaNextClick();},500);}}OnResetSessionDir();}function OnCantAccessFileSys(){AlertDialog("Web Client Pro 无法访问您的本地文件系统。请尝试不同的浏览器。",true,undefined,true);}function OnActivateBrowser(){CheckFileListFocus();}function OnHideApplet(nWidth,nHeight){document.getElementById(g_sAppletFrameID).contentWindow.OnHideApplet(nWidth,nHeight);}function OnShowApplet(){document.getElementById(g_sAppletFrameID).contentWindow.OnShowApplet();}function OnAppletDownload(sThumbNailDLPath,bDirDL){var asTransferItems="";if(sThumbNailDLPath!=undefined&&sThumbNailDLPath!=""){asTransferItems+=sThumbNailDLPath;asTransferItems+=",";asTransferItems+=bDirDL;}else{if(g_nShowList==0){$("#ThumbListFiles").children("li.ui-selected").each(function(){var sAbsPath=$(this).attr("data-filepath").toString();var bIsDir="0";if(parseInt($(this).attr("data-fileisdir"))==1)bIsDir="1";var sEncodedPath=encodeURIComponent(sAbsPath);if(asTransferItems!="")asTransferItems+=",";asTransferItems+=sEncodedPath;asTransferItems+=",";asTransferItems+=bIsDir;});}else{var aSelectedRows=new Array();aSelectedRows=FilesList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<aSelectedRows.length);nIndex++){if(parseInt(FilesList.getCellText(9,aSelectedRows[nIndex]))!=1){var sAbsPath=FilesList.getCellText(3,aSelectedRows[nIndex]);var bIsDir="0";if(FilesList.getCellText(4,aSelectedRows[nIndex])==1)bIsDir="1";var sEncodedPath=encodeURIComponent(sAbsPath);if(asTransferItems!="")asTransferItems+=",";asTransferItems+=sEncodedPath;asTransferItems+=",";asTransferItems+=bIsDir;}}}}document.getElementById(g_sAppletFrameID).contentWindow.OnAppletDownload(asTransferItems);}function OnAppletDelete(sThumbNailDLPath,bDirDL){var asTransferItems="";if(sThumbNailDLPath!=undefined){asTransferItems+=encodeURIComponent(sThumbNailDLPath);asTransferItems+=",";asTransferItems+=bDirDL;}else{if(g_nShowList==0){$("#ThumbListFiles").children("li.ui-selected").each(function(){var sAbsPath=$(this).attr("data-filepath").toString();var bIsDir="0";if(parseInt($(this).attr("data-fileisdir"))==1)bIsDir="1";var sEncodedPath=encodeURIComponent(sAbsPath);if(asTransferItems!="")asTransferItems+=",";asTransferItems+=sEncodedPath;asTransferItems+=",";asTransferItems+=bIsDir;});}else{var aSelectedRows=new Array();aSelectedRows=FilesList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<aSelectedRows.length);nIndex++){if(parseInt(FilesList.getCellText(9,aSelectedRows[nIndex]))!=1){var sAbsPath=FilesList.getCellText(3,aSelectedRows[nIndex]);var bIsDir="0";if(FilesList.getCellText(4,aSelectedRows[nIndex])==1)bIsDir="1";var sEncodedPath=encodeURIComponent(sAbsPath);if(asTransferItems!="")asTransferItems+=",";asTransferItems+=sEncodedPath;asTransferItems+=",";asTransferItems+=bIsDir;}}}}document.getElementById(g_sAppletFrameID).contentWindow.OnAppletDelete(asTransferItems);}function OnAppletUpload(){if(g_bMultiTransferLoaded&&g_bWebClientProActive){document.getElementById(g_sAppletFrameID).contentWindow.OnAppletUpload(g_sCurrentDir);}else ShowDialog('UploadDialog');}function OnAppletIsWorking(){document.getElementById(g_sAppletFrameID).contentWindow.OnAppletIsWorking();}function OnTransferShowInFolder(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferShowInFolder();}function OnTransferOpenFile(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferOpenFile();}function OnTransferStopAfter(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferStopAfter();}function OnTransferSkip(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferSkip();}function OnTransferPause(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferPause();}function OnTransferResume(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferResume();}function OnTransferStart(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferStart();}function OnTransferRestart(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRestart();}function OnTransferCancel(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferCancel();}function OnTransferRemove(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemove();}function OnTransferRemoveCompleted(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveCompleted();}function OnTransferRemoveCancelled(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveCancelled();}function OnTransferRemoveStopped(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveStopped();}function OnTransferRemoveSkipped(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveSkipped();}function OnTransferRemovePaused(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemovePaused();}function OnTransferRemoveWaiting(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveWaiting();}function OnTransferRemoveAll(){document.getElementById(g_sAppletFrameID).contentWindow.OnTransferRemoveAll();}function OnShowOptionsDlg(){document.getElementById(g_sAppletFrameID).contentWindow.OnShowOptionsDlg();}function OnShowAboutDlg(){document.getElementById(g_sAppletFrameID).contentWindow.OnShowAboutDlg();}var sCustomBackground="";if(sCustomBackground!=""){var sBackground=sCustomBackground;document.write('<style type="text/css">');document.write(' #SUWCHeader{ ');document.write('  background:'+sBackground+';');document.write(' }');document.write('</style>');}</script><script type="text/javascript" language="JavaScript" src="/Web Client/Include/WCJSContain.js"></script><link type="text/css" href="/Common/Style/aw-2-6-3.css" rel="stylesheet" title="su-classic"><style type="text/css"> body,table{ font-family:sans-serif !important;font-size:9pt; } .aw-system-control { color:#000!important; }.aw-popup-window .aw-list-item{text-align:left!important;}.aw-popup-window .aw-list-item{color:#000;}.aw-popup-window .aw-mouseover-item{color:#fff;} FORM, INPUT, TEXTAREA, SELECT{ font-family:sans-serif !important;font-size:9pt; resize: none;}.aw-webkit .aw-system-control, .aw-unix .aw-system-control {font-family:Tahoma, Arial, Helvetica;font-size:11px}.aw-webkit .aw-popup-window.aw-system-control { margin-top:-5px;} .aw-ie .aw-input-box,.aw-ie .aw-combo-box {margin-bottom:2px}.aw-all .aw-combo-box input.aw-item-text{width: 94%;}.aw-all .aw-input-box .aw-item-text{width: 99%;} .jcarousel-skin-tango .jcarousel-container-horizontal{ width:538px;} .jcarousel-skin-tango .jcarousel-clip-horizontal{ width:533px;height: 85px;} .jcarousel-skin-tango .jcarousel-item-horizontal{  margin-right: 8px;} .jcarousel-skin-tango .jcarousel-item {   width: 82px; height: 90px;} .CustomLogoContainer{ float:left;width:160px;height:40px;border:1px solid black;} .aw-cells-selected,.aw-rows-selected .aw-grid-cell { color: white!important;}</style><script type="text/javascript" language="JavaScript" src="/Common/Scripts/aw-2-6-4.js"></script>
<script type="text/vbScript" language="vbscript">
<!--
Function VBDateFormat(sDateSeconds,nTimeZoneOffset)
sDate=DateAdd("s", sDateSeconds, "1/1/1970 00:00:00 AM")
sDate=DateAdd("n", -nTimeZoneOffset, sDate)
VBDateFormat = FormatDateTime(sDate,0)
End Function
-->
</script>
<style type="text/css">.spliter-slide {background: #dfdfdf url(/Common/Images/Vert-Splitter.png) no-repeat center top;height: 8px;overflow:hidden;cursor:n-resize;margin:0 60px;}.aw-grid-box {width:auto;}.aw-strict .aw-grid-box {padding:0px 0px 0px 0px;margin:0px 0px -2px 0px}.aw-ie .aw-grid-box {padding:0px 0px 0px 0px;margin:0px 1px -2px 0px}span#ThumbnailSize-view > span,.aw-ie span#ThumbnailSize-view > span,.aw-safari span#ThumbnailSize-view > span,.aw-chrome span#ThumbnailSize-view > span,.aw-opera span#ThumbnailSize-view > span {height:18px!important;}/*div.dividerline{background: url(/Common/Images/Taskbar-bg.png) -2px -34px no-repeat;height:21px;}*/.aw-ie .aw-combo-box .aw-item-text,.aw-ie .aw-input-box .aw-item-text {position:relative;}</style><script type="text/javascript" language="javascript">function GetButtonLabelOptions(sCookie){var nOption=1;if(parseInt(readCookie(sCookie))==0)nOption=0;else if(parseInt(readCookie(sCookie))==2)nOption=2;return(nOption);}if(AW.ie){document.write('<style type="text/css">');document.write('#'+g_sBottomPaneDivID+'{');document.write(' position:absolute;left:5000px;');document.write('}');document.write('</style>');}var g_sMenuDividers="$SU_CONTEXT_MENU_DIVIDER$";var g_sImagePath="/Common/Images/";var g_sAdminPath="/Admin/";var g_bDomainNav;var g_sUseInherited="继承默认值";var g_sDownload="下载";var g_sHomeStr="主页";var g_sOpen="打开";var g_sLoading="正在加载";var g_bLoginUser=false;var g_bAllowChangePassword=0;var g_bAllowChangeEmail=0;var g_sUserEmail="";var g_bAdmin=0;var g_nAdminType=(0);var g_bReadOnlyAccess=(0==3||0==4);var g_nSessionOkay=0;var g_nSessionPending=9;var g_nSessionNotFound=6;var g_sUnknownError="错误：操作失败，发生未知错误。会话已超时。请尝试重新登录。";var g_sCommonPath="/Common/";var g_sWebFilePath="/Web Client/";var g_bFVJVLaunchPage=false;var g_sNoSubDirs="无子目录";var g_sCurrentHostText="vi.gymbaby.cn";var g_bCurrentDirIsHome=false;var g_aHistory=new Array();var g_aHistoryNames=new Array();var g_aHistoryIcon=new Array();var g_aHistoryActive=new Array();var aCrumbHistory;var aFavoritesHistory;var g_HistoryPointer=0;var g_bHistoryButtonUsed=false;var g_sLastIcon="";var g_sHelpPath="www.solarwinds.com";var g_bFVJVLicense=(1==1);var g_bAllowAdhocFileSharing=(1==1);var g_JumpToPage=1;var g_sFVJVLicenseInfo="当前许可证不支持 FTP Voyager JV。若想使用　FTP Voyager JV，请购买支持该功能的许可证。<br /><br /> 您想了解关于购买 FTP Voyager JV　的更多信息吗？";var g_sLicenseEmail="louis%40gymbaby.cn";var g_bGetNewScrollImages=false;var g_bAllowHTTPMediaPlayback=parseInt("1");var g_sCannotMoveFile="目标目录与当前目录相同。请选择不同的目录以便移动文件。";var g_sConfirmMoveFileFrom="您确定要移动吗 ";var g_sTo=" 至 ";var g_nTransferPaneHeight=354;var g_sAdminXMLPath="";var g_sGB="GB";var g_sMB="MB";var g_sKB="KB";var g_sBytes="字节";var HistoryDelayId=0;var g_bDebugApplet=false;var g_bFFApplet=false;</script><script type="text/javascript" src="/Web Client/Include/WCCommonJSContain.js"></script><style type="text/css">BODY{margin: 25px}.dividerline{padding:5px 2px 5px 2px;}div.dividerline{padding:0px 0px 0px 0px;margin-left:4px;}</style><script type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="繁忙";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="/Common/Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="/Common/Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"正在保存",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"正在加载",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"正在删除",bWebClientIcon);}</script></head><body><div id="BusyDialoginner" style="display:none;text-align:center;"></div><script type="text/javascript" language="JavaScript">BuildDialog("繁忙","BusyDialog","200","50","text-align:center","关闭/取消");</script><div id="BusyDialogOpaqueLayer" class="OpaqueLayer"></div><div id="BusyDialog" class="DialogLayer" style="width: 200px; left: -5000px; top: -5000px; text-align: center;"><table id="BusyDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="BusyDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="BusyDialogTitleIcon" src="http://vi.gymbaby.cn/Common/Images/WebClient16.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">   <span id="BusyDialogTitleText"><strong>繁忙</strong></span>   </div>  </td>  <td class="closebox-none" id="BusyDialogclosebox">   <span><img id="BusyDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align: middle; cursor: pointer; display: none;" alt="关闭/取消" onmousedown="javascript:HideDialog('BusyDialog');" onmouseover="javascript:document.getElementById('BusyDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('BusyDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="BusyDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><img src="/Common/Images/Busy.gif" style="margin:0px auto 0px auto;" border="0"></div></div><div id="AlertDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="/Common/Images/Information.png";WarnImg=new Image();WarnImg.src="/Common/Images/Warn.png";BlankImg=new Image();BlankImg.src="/Common/Images/blank.gif";BuildDialog("Serv-U","AlertDialog","250","115","text-align:center","关闭/取消");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="/Common/Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";document.getElementById("AlertDialogText").style.width=(parseInt(nWidth)-50)+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("确定","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("不再显示该消息。","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><div id="AlertDialogOpaqueLayer" class="OpaqueLayer"></div><div id="AlertDialog" class="DialogLayer" style="width: 250px; left: -5000px; top: -5000px; text-align: center;"><table id="AlertDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="AlertDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="AlertDialogTitleIcon" src="/Common/Images/SULogo-Dlg-Ico.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">   <span id="AlertDialogTitleText">Serv-U</span>   </div>  </td>  <td class="closebox" id="AlertDialogclosebox">   <span><img id="AlertDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('AlertDialog');" onmouseover="javascript:document.getElementById('AlertDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('AlertDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="AlertDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table border="0"><tbody><tr><td style="vertical-align:top;"><img id="AlertImage" style="margin-right:8px" width="32" height="32" border="0"></td><td style="text-align:left;"><span id="AlertDialogText"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"><span id="aw5" class="aw-system-control aw-item-control aw-templates-checkbox aw-ui-checkbox aw-text-expand aw-value-false aw-toggle-checkbox " tabindex="-1" hidefocus="true" title="" attrname="AlertNoShowCheckBox" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)" onclick=""><span id="aw5-box" class="aw-item-box "><span id="aw5-box-marker" class="aw-item-marker "></span><span id="aw5-box-image" class="aw-item-image aw-image-none "></span><span id="aw5-box-ruler" class="aw-item-ruler "></span><span id="aw5-box-text" class="aw-item-text ">不再显示该消息。</span></span></span></span></div></td></tr></tbody></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"><button id="btn-AlertDialogOkButton" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="AlertDialogOkButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div></div><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"></div><script type="text/javascript" language="JavaScript">BuildDialog("Serv-U","ConfirmDialog","250","115","text-align:center","关闭/取消");var g_sDeletingDialogTitle="正在删除";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="/Common/Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){document.getElementById("ConfirmDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("ConfirmDialogTitleIcon").height="16";document.getElementById("ConfirmDialogTitleIcon").width="16";}if((document.getElementById("ConfirmDialogText")!=undefined)&&(sText!=undefined))document.getElementById("ConfirmDialogText").innerHTML=sText;g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;if(nWidth!=undefined){if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nWidth=nWidth.toString()+"px";else nWidth=nWidth;document.getElementById("ConfirmDialog").style.width=nWidth;document.getElementById("ConfirmDialogText").style.width=(parseInt(nWidth)-50)+"px";}else{document.getElementById("ConfirmDialog").style.width="250";document.getElementById("ConfirmDialogText").style.width="200";}document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("是","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("否","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><div id="ConfirmDialogOpaqueLayer" class="OpaqueLayer"></div><div id="ConfirmDialog" class="DialogLayer" style="width: 250px; left: -5000px; top: -5000px; text-align: center;"><table id="ConfirmDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="ConfirmDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="ConfirmDialogTitleIcon" src="/Common/Images/SULogo-Dlg-Ico.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">   <span id="ConfirmDialogTitleText">Serv-U</span>   </div>  </td>  <td class="closebox" id="ConfirmDialogclosebox">   <span><img id="ConfirmDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('ConfirmDialog');" onmouseover="javascript:document.getElementById('ConfirmDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('ConfirmDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="ConfirmDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table id="ConfirmDialogtable" border="0"><tbody><tr><td><img src="/Common/Images/QuestionMark.png" style="margin-right:8px" width="32" height="32" border="0"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"><button id="btn-ConfirmDialogYesButton" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="ConfirmDialogYesButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">是</span></button></span><span id="ConfirmDialogNoButton"><button id="btn-ConfirmDialogNoButton" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="ConfirmDialogNoButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">否</span></button></span></td></tr></tbody></table></div></div><script type="text/javascript" language="javascript">var bShowMultiTransferCookie=false;var g_PageActionLabelOption=GetButtonLabelOptions("clientlabels-pageaction");var g_FileActionLabelOption=GetButtonLabelOptions("clientlabels-fileaction");var g_WebClientProLabelOption=GetButtonLabelOptions("clientlabels-webclientpro");</script><div id="DirSizeDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_SpaceAvailableRequest,g_DirSizeRequest;var sWebClientDirProp=undefined;var sDirPropImg=undefined;try{if(g_bIsWebClient){sWebClientDirProp="WC-Icon-DirProp";}else{sDirPropImg="FolderSize.png";}}catch(e){sDirPropImg="FolderSize.png";}BuildDialog("","DirSizeDialog","450","170","text-align:center","关闭/取消",sDirPropImg,undefined,sWebClientDirProp);function DirSizeDialog(){OnShowDirSizeDialog(g_sCurrentDir,g_sCurrentDirDriveLabel,g_sCurrentDirDriveType,g_sCurrentDirMDate,g_sCurrentDirCDate,g_sCurrentDirADate);}function OnShowDirSizeDialog(sDir,sDriveLabel,sDirDriveType,sMDate,sCDate,sADate){if(sDriveLabel!=-1)sTitleText=GetDecodedDirPath(sDir)+" ("+sDriveLabel+")";else sTitleText=GetDecodedDirPath(sDir);document.getElementById("DirSizeDialogTitleText").innerHTML=sTitleText;if(sDirDriveType!=-1){document.getElementById("DirSizeDialogDateDiv").style.display="none";document.getElementById("DirSizeDialogSpaceDiv").style.display="none";}else{document.getElementById("DirSizeDialogDateDiv").style.display="block";document.getElementById("DirSizeDialogSpaceDiv").style.display="block";if(sMDate==undefined)GetDirInfo(sDir);else{document.getElementById("DirSizeDialogMDateTime").innerHTML="<strong>"+sMDate+"</strong>";document.getElementById("DirSizeDialogCDateTime").innerHTML="<strong>"+sCDate+"</strong>";document.getElementById("DirSizeDialogADateTime").innerHTML="<strong>"+sADate+"</strong>";}}ShowDialog("DirSizeDialog",undefined,OnDirSizeAbort);GetSpaceAvailable(sDir);GetDirSize(sDir);}function OnDirSizeCloseButton(){HideDialog("DirSizeDialog");}function OnDirSizeAbort(){if(g_DirSizeRequest!=null&&!g_DirSizeRequest.isReady())g_DirSizeRequest._http.abort();if(g_SpaceAvailableRequest!=null&&!g_SpaceAvailableRequest.isReady())g_SpaceAvailableRequest._http.abort();}function GetDirInfo(sDir){var sDirInfoCmd="/Web Client/ListError.xml?Dir="+sDir;var DirInfoCmdRequest=CreatePostRequest(sDirInfoCmd);DirInfoCmdRequest.setAsync(true);DirInfoCmdRequest.request();DirInfoCmdRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nMDate=GetXMLValueInt(XMLDoc,"CurrentDirMDate");var nCDate=GetXMLValueInt(XMLDoc,"CurrentDirCDate");var nADate=GetXMLValueInt(XMLDoc,"CurrentDirADate");var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();if((AW.ie)&&(parseInt(navigator.appVersion)>=4)){sMDate=VBDateFormat(nMDate,nTimeZoneOffset);sCDate=VBDateFormat(nCDate,nTimeZoneOffset);sADate=VBDateFormat(nADate,nTimeZoneOffset);}else{sMDate=FormatFileDate(nMDate);sCDate=FormatFileDate(nCDate);sADate=FormatFileDate(nADate);}document.getElementById("DirSizeDialogMDateTime").innerHTML="<strong>"+sMDate+"</strong>";document.getElementById("DirSizeDialogCDateTime").innerHTML="<strong>"+sCDate+"</strong>";document.getElementById("DirSizeDialogADateTime").innerHTML="<strong>"+sADate+"</strong>";};}function GetSpaceAvailable(sDir){var sSpaceAvailableCmd="/?Command=SpaceAvailable&Dir="+sDir;var SpaceAvailableRequest=CreatePostRequest(sSpaceAvailableCmd);document.getElementById("AvailableSize").innerHTML='<img src="/Common/Images/small-loading.gif" border="0" align="middle" style="margin:0;border:none;">';g_SpaceAvailableRequest=SpaceAvailableRequest;SpaceAvailableRequest.setAsync(true);SpaceAvailableRequest.m_dir=sDir;SpaceAvailableRequest.request();SpaceAvailableRequest.response=function(XMLDoc){if(this.m_dir==sDir){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nSpaceAvailable=GetXMLValueInt(XMLDoc,"SpaceAvailable");document.getElementById("AvailableSize").innerHTML="<strong>"+FormatFileSize(nSpaceAvailable,true)+"</strong>";}};}function GetDirSize(sDir){var sDirSizeCmd="/?Command=DirectorySize&Dir="+sDir;var DirSizeRequest=CreatePostRequest(sDirSizeCmd);document.getElementById("DirSize").innerHTML='<img src="/Common/Images/small-loading.gif" border="0" align="middle" style="margin:0;border:none;">';g_DirSizeRequest=DirSizeRequest;DirSizeRequest.setAsync(true);DirSizeRequest.m_dir=sDir;DirSizeRequest.request();DirSizeRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nDirSize=GetXMLValueInt(XMLDoc,"DirectorySize");document.getElementById("DirSize").innerHTML="<strong>"+FormatFileSize(nDirSize,true)+"</strong>";};}function GetDirProperties(){var sDir,bIsDrive;if(g_nShowList==1)sDir=encodeURIComponent(FilesList.getCellText(3,FilesList.getSelectedRows()));else if($("#ThumbListFiles li.ui-selected").length==1)sDir=encodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filepath").toString());var sDirDriveLabel=-1;var sDirDriveType=-1;if(g_nShowList==1)bIsDrive=FilesList.getCellText(7,FilesList.getSelectedRows());else if($("#ThumbListFiles li.ui-selected").length==1)bIsDrive=parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdrive"));if(bIsDrive!=0){if(g_nShowList==1){sDirDriveLabel=decodeURIComponent(FilesList.getCellText(6,FilesList.getSelectedRows()));sDirDriveType=FilesList.getCellText(8,FilesList.getSelectedRows());}else if($("#ThumbListFiles li.ui-selected").length==1){sDirDriveLabel=decodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filedrivelabel").toString());sDirDriveType=$("#ThumbListFiles li.ui-selected").attr("data-filedrivetype");}}OnShowDirSizeDialog(sDir,sDirDriveLabel,sDirDriveType);}CreateDialogPushButton("关闭","CloseDirSizeDialogButton",OnDirSizeCloseButton);</script><div id="DirSizeDialogOpaqueLayer" class="OpaqueLayer"></div><div id="DirSizeDialog" class="DialogLayer" style="width: 450px; left: -5000px; top: -5000px; text-align: center;"><table id="DirSizeDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="DirSizeDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="DirSizeDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-DirProp"></div>   <span id="DirSizeDialogTitleText"></span>   </div>  </td>  <td class="closebox" id="DirSizeDialogclosebox">   <span><img id="DirSizeDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('DirSizeDialog');" onmouseover="javascript:document.getElementById('DirSizeDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('DirSizeDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="DirSizeDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table style="width:100%" border="0"><tbody><tr><td style="width:50px;vertical-align:top;"><img id="DirSizeDialogFolderIcon" src="/Web Client/ThumbnailIcons/Folder32.png" style="margin:0 8px 0 0;border:none;" width="32" height="32" border="0" align="middle"></td><td style="text-align:left;vertical-align:middle;padding-right:10px;"><div id="DirSizeDialogDateDiv" style="display:none;margin-bottom:10px;"><div><div style="float:left;width:120px;">已修改:</div><div style="float:left;"><span id="DirSizeDialogMDateTime"></span></div></div><div style="clear:both;"><div style="float:left;width:120px;">已创建:</div><div style="float:left;"><span id="DirSizeDialogCDateTime"></span></div></div><div style="clear:both;"><div style="float:left;width:120px;">上次访问:</div><div style="float:left;"><span id="DirSizeDialogADateTime"></span></div></div></div><div id="DirSizeDialogSpaceDiv" style="display:none;height:10px;clear:both;">&nbsp;</div><div style="clear:both;"><div style="float:left;width:120px;">目录大小:</div><div style="float:left;"><span id="DirSize"><img src="/Common/Images/small-loading.gif" style="margin:0;border:none;" border="0" align="middle"></span></div></div><div style="clear:both;"><div style="float:left;width:120px;">可用空间:</div><div style="float:left;"><span id="AvailableSize"><img src="/Common/Images/small-loading.gif" style="margin:0;border:none;" border="0" align="middle"></span></div></div></td></tr><tr><td colspan="2" style="text-align:center"><span id="CloseDirSizeDialogButton"><button id="btn-CloseDirSizeDialogButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CloseDirSizeDialogButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">关闭</span></button></span></td></tr></tbody></table></div></div><div id="UploadDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_sBrowserLanguageCheck=readCookie("SULang").replace("-",",");var bIsBronze=(0==1);var bIsSilver=(0==1);var bIsGold=(0==1);var bIsPlatinum=(1==1);var bHasFVJV=(1==1);var sEnableWCP=String('OnULDialogEnableWCPFVJV(0);');var sLaunchFVJV=String("OnULDialogEnableWCPFVJV(1);");var sWebClientUpload=undefined;var sUploadImg=undefined;try{if(g_bIsWebClient){sWebClientUpload="WC-Icon-DirProp";}else{sUploadImg="upload.png";}}catch(e){sUploadImg="upload.png";}BuildDialog("上传","UploadDialog","500","150","","关闭/取消",sUploadImg,undefined,sWebClientUpload);$("#iframe").append("<iframe src='/Web Client/Include/Upload.htm' frameborder='0' scrolling='no' name='UploadFrame' id='UploadFrame'></iframe>");if(!g_bFVJVLicense&&g_bAllowWebClientPro)document.getElementById("LicenseMultiTransfer").innerHTML="要上传更大的文件或启动多个并发传输，启用 <a href='javascript:"+sEnableWCP+"'>Web Client Pro</a>";else if(g_bFVJVLicense&&!g_bAllowWebClientPro)document.getElementById("LicenseMultiTransfer").innerHTML="要上传更大的文件或启动多个并发传输，启动 <a href='javascript:"+sLaunchFVJV+"'>FTP Voyager JV</a>";else if(g_bFVJVLicense&&g_bAllowWebClientPro)document.getElementById("LicenseMultiTransfer").innerHTML="要上传更大的文件或启动多个并发传输，启用 <a href='javascript:"+sEnableWCP+"'>Web Client Pro</a> 或启动 <a href='javascript:"+sLaunchFVJV+"'>FTP Voyager JV</a>";function OnULDialogEnableWCPFVJV(nTransClient){OnCloseUploadDialog();if(nTransClient==0)OnEnableDisableTransMod();else LaunchFVJV();}function OnUploadSubmit(bBypassCheck){HideDialog("ConfirmDialog");var nFrameNum=(document.getElementsByTagName('iframe').length-1);if((g_bIsDemo)&&(top.frames[nFrameNum].frameElement.id==""))--nFrameNum;if(bBypassCheck==undefined)bBypassCheck=false;top.frames[nFrameNum].Upload(bBypassCheck);}this.GetThemeName=function(){return readCookie("themename");};this.OnNoFile=function(){AlertDialog("请使用浏览按钮选择要上传的文件。",true);};this.GetCurrentDir=function(){return(g_sCurrentDir);};this.VerifyUpload=function(sUploadingFile){var sFileUpload=sUploadingFile;var nPos=0;var bNoFileFound=true;var sGridFile;var sFileComp;nPos=sFileUpload.lastIndexOf("/");if(nPos<0)nPos=sFileUpload.lastIndexOf("\\");if(nPos<0)sFile=sFileUpload;else{sFile=sFileUpload.substring((nPos+1));}if(g_bCaseSensitiveOS)sFileComp=sFile.replace(new RegExp("&","g"),"&amp;");else sFileComp=sFile.replace(new RegExp("&","g"),"&amp;").toLowerCase();for(nIndex=0;(nIndex<FilesList.getRowCount());nIndex++){if(g_bCaseSensitiveOS)sGridFile=FilesList.getCellText(0,nIndex);else sGridFile=FilesList.getCellText(0,nIndex).toLowerCase();if((sGridFile==sFileComp)&&(parseInt(FilesList.getCellValue(9,nIndex))==0)){ConfirmDialog("您确定要覆盖此文件吗？",OnUploadSubmit,undefined,true,undefined,undefined,true);bNoFileFound=false;break;}}return bNoFileFound;};this.ShowUploadLoadingDialog=function(){LoadingDialog(true);};this.HideUploadBusyDialog=function(){var nFrameNum=(document.getElementsByTagName('iframe').length-1);if(nFrameNum>0){RefreshList(false);}};function OnCloseUploadDialog(){clearTimeout(UploadTimer);HideDialog('UploadDialog');var nFrameNum=(document.getElementsByTagName('iframe').length-1);top.frames[nFrameNum].ClearFilePath();}var nUploadbuttonWidth="75";if(g_sBrowserLanguageCheck.toLowerCase()=="fi,fi")nUploadbuttonWidth="105";CreatePushButton("上传","UploadButton",OnUploadSubmit,nUploadbuttonWidth,30);CreatePushButton("关闭","CloseUploadDialogButton",OnCloseUploadDialog,nUploadbuttonWidth,30);if(navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.toLowerCase().indexOf('trident')!=-1){$("#IEUploadWarn").show();}</script><div id="UploadDialogOpaqueLayer" class="OpaqueLayer"></div><div id="UploadDialog" class="DialogLayer" style="width: 500px; left: -5000px; top: -5000px;"><table id="UploadDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="UploadDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="UploadDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-DirProp"></div>   <span id="UploadDialogTitleText">上传</span>   </div>  </td>  <td class="closebox" id="UploadDialogclosebox">   <span><img id="UploadDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('UploadDialog');" onmouseover="javascript:document.getElementById('UploadDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('UploadDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="UploadDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form method="post" name="UploadFile" action="" enctype="multipart/form-data" onsubmit="javascript: VerifyUpload(this); return (false);"><table class="DialogTable"><tbody><tr><td><div id="iframe"><iframe src="/Web Client/Include/Upload.htm" scrolling="no" name="UploadFrame" id="UploadFrame" frameborder="0"></iframe></div><div id="UploadWarn" style="text-align:left;margin:10px 0 10px 5px;display:block;"><img src="/Common/Images/Warn.png" style="float:left;margin:0 8px 20px 0;" width="32" height="32" border="0"><span id="IEUploadWarn" style="display:none;">有些浏览器可能不允许上传大于 2GB 的文件。</span><div style="margin-top:10px;" id="LicenseMultiTransfer">要上传更大的文件或启动多个并发传输，启用 <a href="javascript:OnULDialogEnableWCPFVJV(0);">Web Client Pro</a> 或启动 <a href="javascript:OnULDialogEnableWCPFVJV(1);">FTP Voyager JV</a></div></div></td><td style="width:auto;text-align:right;vertical-align:top;padding-right:5px;"><span id="UploadButton"><button id="btn-UploadButton" style="white-space: nowrap; width: 75px; height: 30px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="UploadButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">上传</span></button></span><br><span id="CloseUploadDialogButton"><button id="btn-CloseUploadDialogButton" style="white-space: nowrap; width: 75px; height: 30px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CloseUploadDialogButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">关闭</span></button></span></td></tr></tbody></table></form></div></div><div id="ProgressDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var nUploadPercent=-1;var ProgressBar;var UploadTimer=null;var CloseTimer=null;var CancelUploadTimer=null;var g_nCurrentUploadId;var g_bCancelUpload=false;var nMaxUploadTimeout=10;var g_nUploadTimeout=0;var sWebClientUploadProg=undefined;var sUploadProgImg=undefined;try{if(g_bIsWebClient){sWebClientUploadProg="WC-Icon-DirProp";}else{sUploadProgImg="upload.png";}}catch(e){sUploadProgImg="upload.png";}BuildDialog("上传进度","ProgressDialog","400","200","","关闭/取消",sUploadProgImg,undefined,sWebClientUploadProg);function ProgressFill(nUploadPercent){var nPercent=(100-nUploadPercent);sFillPercentage=nPercent.toString();if(nUploadPercent>0){document.getElementById("progresswarn").style.display="none";document.getElementById("progressblock").style.visibility="visible";}else{document.getElementById("progresswarn").style.display="block";document.getElementById("progressblock").style.visibility="hidden";}if(nUploadPercent<=100){document.getElementById("ProgressDiv").style.backgroundPosition=sFillPercentage+"% 0px";document.getElementById("percentcomplete").innerHTML=nUploadPercent+"%";}}function OnUnableToUpload(){HideDialog("AlertDialog");OnCloseProgressDialog();}this.UploadProgress=function(nUploadId){if(!isNaN(nUploadId))g_nCurrentUploadId=nUploadId;var sCmd="/Web Client/FileUpload.xml?Command=TransferStats&TransferID="+g_nCurrentUploadId;var UploadRequest=CreatePostRequest(sCmd);UploadRequest.setRequestHeader("X-User-Agent",escape(navigator.userAgent));UploadRequest.setAsync(true);UploadRequest.request();UploadRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"Result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nPercentComplete=-1;if(nResult==g_nSessionPending){var sFileName=GetXMLValue(XMLDoc,"FileName");var sFilePath=GetXMLValue(XMLDoc,"FilePath");var nFileSize=GetXMLValue(XMLDoc,"FileSize");var nBytesWritten=GetXMLValue(XMLDoc,"BytesWritten");var sKBPerSecond=GetXMLValue(XMLDoc,"KBPerSecond");var nBytesRemaining=GetXMLValue(XMLDoc,"BytesRemaining");var sTimeRemaining=GetXMLValue(XMLDoc,"TimeRemaining");var nPercentComplete=GetXMLValue(XMLDoc,"PercentComplete");if(nPercentComplete==""||nPercentComplete==undefined)nPercentComplete=-1;var ProgressTitleText=document.getElementById("ProgressDialogTitleText");if((ProgressTitleText!=undefined)){if(nFileSize!=""&&nFileSize!=undefined){ProgressTitleText.innerHTML=nPercentComplete.toString()+"% 共 "+sFileName;ProgressTitleText.title=nPercentComplete.toString()+"% 共 "+sFileName;}else{ProgressTitleText.innerHTML="正在上传 "+sFileName;ProgressTitleText.title="正在上传 "+sFileName;}}if(sFileName!=undefined){document.getElementById("filename").innerHTML=sFileName;document.getElementById("filename").title=sFileName;}if(sFilePath!=undefined){document.getElementById("filepath").innerHTML=sFilePath;document.getElementById("filepath").title=sFilePath;}if(nFileSize!=""&&nFileSize!=undefined)document.getElementById("filesize").innerHTML=FormatFileSize(parseInt(nFileSize),true);if(sKBPerSecond!=""&&sKBPerSecond!=undefined){nKBPerSecond=parseInt(sKBPerSecond);document.getElementById("transferspeed").innerHTML=FormatNumberCommas(nKBPerSecond,true)+" 千字节/秒";}
if(nBytesWritten!=""&&nBytesWritten!=undefined)document.getElementById("byteswritten").innerHTML=FormatFileSize(parseInt(nBytesWritten),true);if(nBytesRemaining!=""&&nBytesRemaining!=undefined)document.getElementById("bytesremaining").innerHTML=FormatFileSize(parseInt(nBytesRemaining),true);if(sTimeRemaining!=""&&sTimeRemaining!=undefined)document.getElementById("timeremaining").innerHTML=sTimeRemaining;ProgressFill(nPercentComplete);}if(nResult==g_nSessionNotFound)g_nUploadTimeout++;if(nResult==g_nSessionOkay&&!g_bCancelUpload){document.getElementById("ProgressDiv").style.backgroundPosition="0% 0px";document.getElementById("percentcomplete").innerHTML="100%";CloseTimer=setTimeout("OnCloseProgressDialog()",1000);}else if(!g_bCancelUpload&&g_nUploadTimeout<=nMaxUploadTimeout&&(nResult==g_nSessionNotFound||nResult==g_nSessionPending)){UploadTimer=setTimeout("OnUploadProgressTimer()",1000);}else if(g_nUploadTimeout>nMaxUploadTimeout&&(nResult==g_nSessionNotFound))AlertDialog("Web 浏览器不能上传该文件。该文件对于您使用的 Web 浏览器来说可能太大。 有些浏览器可能不允许上传大于 2GB 的文件。",true,OnUnableToUpload);else if(nResult!=g_nSessionPending)AlertDialog(GetResultText(0,"",sResultText),true,OnUnableToUpload);};};function OnCancelUpload(){g_bCancelUpload=true;var sCmd="/Web Client/FileUpload.xml?Command=TransferStats&TransferID="+g_nCurrentUploadId+"&Cancel=1";var CancelUploadRequest=CreatePostRequest(sCmd);CancelUploadRequest.setRequestHeader("X-User-Agent",escape(navigator.userAgent));CancelUploadRequest.setAsync(true);CancelUploadRequest.request();CancelUploadRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"Result");if(nResult!=g_nSessionPending){clearTimeout(CancelUploadTimer);OnCloseProgressDialog();}else CancelUploadTimer=setTimeout("OnCancelUploadTimer()",1000);};};function OnCloseProgressDialog(){clearTimeout(UploadTimer);HideDialog("ProgressDialog");RefreshList(true);}function OnCancelUploadTimer(){OnCancelUpload();}function OnUploadProgressTimer(){window.UploadProgress();}this.ProgressDialog=function(){var DialogCloseButton=document.getElementById("ProgressDialogCloseIcon");var ProgressTitleText=document.getElementById("ProgressDialogTitleText");var ProgressTitleContainer=document.getElementById("ProgressDialogTitleContainer");g_bCancelUpload=false;g_nUploadTimeout=0;var DialogCloseContainer=document.getElementById("ProgressDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";if(ProgressTitleContainer!=undefined){TitleContainerWidth=(400-40);ProgressTitleContainer.style.width=TitleContainerWidth.toString();}document.getElementById("filename").innerHTML="";document.getElementById("filename").title="";document.getElementById("filepath").title="";document.getElementById("filepath").innerHTML="";document.getElementById("filesize").innerHTML="";document.getElementById("transferspeed").innerHTML="";document.getElementById("byteswritten").innerHTML="";document.getElementById("bytesremaining").innerHTML="";document.getElementById("ProgressDiv").style.backgroundPosition="100% 0px";document.getElementById("percentcomplete").innerHTML="";document.getElementById("timeremaining").innerHTML="";document.getElementById("progressblock").style.visibility="hidden";document.getElementById("progresswarn").style.display="block";if((ProgressTitleText!=undefined)){ProgressTitleText.innerHTML="上传进度";ProgressTitleText.title="上传进度";}ShowDialog("ProgressDialog");};CreateDialogPushButton("取消","CloseProgressDialogButton",OnCancelUpload);</script><div id="ProgressDialogOpaqueLayer" class="OpaqueLayer"></div><div id="ProgressDialog" class="DialogLayer" style="width: 400px; left: -5000px; top: -5000px;"><table id="ProgressDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="ProgressDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="ProgressDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-DirProp"></div>   <span id="ProgressDialogTitleText">上传进度</span>   </div>  </td>  <td class="closebox" id="ProgressDialogclosebox">   <span><img id="ProgressDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('ProgressDialog');" onmouseover="javascript:document.getElementById('ProgressDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('ProgressDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="ProgressDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><table style="overflow:hidden;width:395px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">名称:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="filename"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">目标:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="filepath"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">大小:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="filesize"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">传输率:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="transferspeed"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">已上传:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="byteswritten"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">剩余:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="bytesremaining"></span></strong></div></td></tr><tr><td style="width:105px; padding:0 5px 5px 5px;vertical-align:top;">剩余时间:</td><td style="vertical-align:top;padding:0 0 5px 0;"><div style="overflow:hidden;text-overflow: ellipsis;width:290px;"><strong><span id="timeremaining"></span></strong></div></td></tr></tbody></table><div id="progresswarn" style="text-align:left;margin:10px 0 10px 5px;display:block;"><img src="/Common/Images/Warn.png" style="float:left;margin:0 8px 20px 0;" width="32" height="32" border="0">有些浏览器可能不允许上传大于 2GB 的文件。</div><div id="progressblock" style="text-align:center;margin:10px 0 10px 0;visibility:hidden;"><table style="vertical-align:top;margin:0 auto 0 auto;" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="progresscontainer"><div id="ProgressDiv" class="progressbar"></div></div></td><td style="width:55px;text-align:right;"><span id="percentcomplete">&nbsp;</span></td></tr></tbody></table></div><div style="text-align:center;"><span id="CloseProgressDialogButton"><button id="btn-CloseProgressDialogButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CloseProgressDialogButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></div></div></div><div id="CreateDirDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var sWebClientNewDir=undefined;var sNewDirImg=undefined;try{if(g_bIsWebClient){sWebClientNewDir="WC-Icon-NewDir";}else{sNewDirImg="NewDir.png";}}catch(e){sNewDirImg="NewDir.png";}BuildDialog("创建目录","CreateDirDialog","300","220","","关闭/取消",sNewDirImg,undefined,sWebClientNewDir);function CreateDirDialog(){g_bContextKeepAppletHidden=true;DirInput.setControlText("");ShowDialog("CreateDirDialog");DirInput.getContent("box/text").element().focus();}function OnCreateDirSubmit(){var sNewDirPath=DirInput.getControlText();if(sNewDirPath!=""){var sNewDirCmd="/?Command=CreateDir&Dir="+g_sCurrentDir;var NewDirRequest=CreatePostRequest(sNewDirCmd);NewDirRequest.setParameter("new_dir",sNewDirPath);NewDirRequest.request();NewDirRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==3){if(decodeURIComponent(g_sCurrentDir)=="/")sCurrentCreateDirPath="";else sCurrentCreateDirPath=decodeURIComponent(g_sCurrentDir);AlertDialog(GetResultText(nResult,"创建目录失败，无法创建目录： /"+decodeURIComponent(sNewDirPath)+"<br/><br/>您没有权限在此创建目录。",sResultText));}else AlertDialog(GetResultText(0,"",sResultText));}else{ReplaceDialog("CreateDirDialog",g_sBusyDialog);RefreshList(false);if(g_nShowList!=0)FilesList.element().focus();}};}}function OnCancelCreateDir(){HideDialog("CreateDirDialog");}CreateDialogPushButton("确定","CreateDirButton",OnCreateDirSubmit);CreateDialogPushButton("取消","CancelCreateDirButton",OnCancelCreateDir);var DirInput=CreateInputField("","NewDirInput","new_dir",undefined,200,undefined,undefined,OnCreateDirSubmit);</script><div id="CreateDirDialogOpaqueLayer" class="OpaqueLayer"></div><div id="CreateDirDialog" class="DialogLayer" style="width: 300px; left: -5000px; top: -5000px;"><table id="CreateDirDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="CreateDirDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="CreateDirDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-NewDir"></div>   <span id="CreateDirDialogTitleText">创建目录</span>   </div>  </td>  <td class="closebox" id="CreateDirDialogclosebox">   <span><img id="CreateDirDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('CreateDirDialog');" onmouseover="javascript:document.getElementById('CreateDirDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('CreateDirDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="CreateDirDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="CreateDir" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td>新建目录<br><div style="overflow:auto"><span id="NewDirInput"><span id="new_dir" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="new_dir-box" class="aw-item-box "><span id="new_dir-box-image" class="aw-item-image aw-image-none "></span><span id="new_dir-box-ruler" class="aw-item-ruler "></span><input id="new_dir-box-text" class="aw-item-text " value="" tabindex="0" name="new_dir" type="text"></span></span></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="CreateDirButton"><button id="btn-CreateDirButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CreateDirButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="CancelCreateDirButton"><button id="btn-CancelCreateDirButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelCreateDirButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="RenameDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_bPreviewDialog=false;var g_sOriginalFilename="";var sWebClientRename=undefined;var sRenameImg=undefined;try{if(g_bIsWebClient){sWebClientRename="WC-Icon-Rename";}else{sRenameImg="rename.png";}}catch(e){sRenameImg="rename.png";}BuildDialog("重命名","RenameDialog","300","220","","关闭/取消",sRenameImg,undefined,sWebClientRename);function OnShowRenameDialog(bPreviewDlg,sRenameFileName){if(bPreviewDlg!=undefined)g_bPreviewDialog=bPreviewDlg;else g_bPreviewDialog=false;g_sOriginalFilename=sRenameFileName;ShowDialog('RenameDialog',undefined,OnRenameHide);if(g_bPreviewDialog)RemoveEventHandlers();PathInput.getContent("box/text").element().focus();}function OnRenameHide(){if(g_bMediaPreviewActive)OnShowMediaShow();}function OnConfirmRenameOverWrite(){OnRenameSubmit(true);}function OnConfirmRename(){var xmlDoc=FilesList.m_XMLTable.getXML();var bFileExists;var sNewFilePath=document.getElementById(PathInput.getContent("box/text").getId()).value;if(g_sOriginalFilename==sNewFilePath)OnCancelRename();else{if(typeof(document.createNSResolver)!='undefined'){var oNSResolver=xmlDoc.createNSResolver(xmlDoc.documentElement);try{var aItems=xmlDoc.evaluate("//file[FileName='"+EncodeCharForXML(encodeURIComponent(sNewFilePath))+"']",xmlDoc,oNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);bFileExists=(aItems.snapshotLength>0);}catch(e){bFileExists=false;}}else{bFileExists=(xmlDoc.selectNodes("//file[FileName='"+EncodeCharForXML(encodeURIComponent(sNewFilePath))+"']").length>0);}if(bFileExists)ConfirmDialog("您确定要覆盖此文件吗？",OnConfirmRenameOverWrite,undefined,undefined,310,undefined,false,true);else OnRenameSubmit(false);}}function OnRenameSubmit(bFileExists){var sOriginalPath=decodeURIComponent(document.rename.original_path.value);var sNewFilePath=document.getElementById(PathInput.getContent("box/text").getId()).value;var sRenameCmd="/?Command=Rename&Dir="+g_sCurrentDir;var RenameRequest=CreatePostRequest(sRenameCmd);RenameRequest.setParameter("new_path",sNewFilePath);RenameRequest.setParameter("original_path",sOriginalPath);RenameRequest.setAsync(true);RenameRequest.request();RenameRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nFilePathLength;var nLastSlash;var bIsDir=(document.rename.isdir.value=="false")?false:true;var anFileIndices=FilesList.getRowIndices();if(nResult!=g_nSessionOkay){if(nResult==3){if(bIsDir){sErrorMessage1="重命名目录失败，无法重命名目录： ";sErrorMessage2="<br/><br/>您没有权限重命名该目录。 ";}else{sErrorMessage1="重命名文件失败，无法重命名文件：";sErrorMessage2="<br/><br/>您没有权限重命名该文件。";}AlertDialog(GetResultText(nResult,sErrorMessage1+g_sOriginalFilename+sErrorMessage2,sResultText));}else AlertDialog(GetResultText(0,"",sResultText));}else{sCurrPathCheck=decodeURIComponent(g_sCurrentDir);nFilePathLength=sCurrPathCheck.length;nLastSlash=sCurrPathCheck.lastIndexOf("/");if((nFilePathLength==nLastSlash)||sCurrPathCheck=="/")sNewFilePathChange=decodeURIComponent(g_sCurrentDir)+sNewFilePath;else sNewFilePathChange=decodeURIComponent(g_sCurrentDir)+"/"+sNewFilePath;if(g_nShowList==1){nSelectedRows=FilesList.getSelectedRows();g_bBuildThumbnails=true;}else{sNewEndcodedFilePath=sNewFilePathChange;nThumbIndex=document.rename.thumb_index.value;nSelectedRows=anFileIndices[document.rename.thumb_index.value];document.getElementById("thumbfilename"+nThumbIndex.toString()).innerHTML=sNewFilePath;sNewCleanFilePath=sNewFilePath;$("#thumbactions"+nThumbIndex.toString()).attr("title",sNewFilePath);$("#thumbactions"+nThumbIndex.toString()).attr("alt",sNewFilePath);$("#thumbfilename"+nThumbIndex.toString()).attr("title",sNewFilePath);$("#thumbfilename"+nThumbIndex.toString()).attr("alt",sNewFilePath);$("#thumbimg"+nThumbIndex.toString()).attr("title",sNewFilePath);$("#thumbimg"+nThumbIndex.toString()).attr("alt",sNewFilePath);$("#thumb"+nThumbIndex.toString()).attr("data-filepath",sNewFilePathChange);$("#thumb"+nThumbIndex.toString()).attr("data-filename",sNewFilePath);if(g_bPreviewDialog){g_bBuildThumbnails=true;}}if(g_bPreviewDialog&&!bFileExists){var PreviewDialogTitleText=document.getElementById("ImageDialogTitleText");if((PreviewDialogTitleText!=undefined)&&(sNewFilePath!=undefined))PreviewDialogTitleText.innerHTML=sNewFilePath;if(($("#taskbar-filename")!=undefined)&&(sNewFilePath!=undefined))$("#taskbar-filename").html(sNewFilePath);SetImageFileActions(sNewFilePath,sNewFilePathChange);}GetSpaceAvailable();GetDirSize();if(g_bSearchView){FilesList.setCellText(sNewFilePathChange,3,nSelectedRows);FilesList.setCellText(sNewFilePathChange,0,nSelectedRows);FilesList.setCellText(sNewFilePath,12,nSelectedRows);}else{if(!bFileExists){if(FilesList.m_XMLTable.getData(3,nSelectedRows)==""){FilesList.setCellText(sNewFilePathChange,3,nSelectedRows);FilesList.setCellText(sNewFilePath,0,nSelectedRows);}else{FilesList.UpdateText(sNewFilePathChange,3,nSelectedRows);FilesList.UpdateText(sNewFilePath,0,nSelectedRows);}}else var asFileRenameData=[g_sCurrentDir,encodeURIComponent(sNewFilePath),FilesList.getCellValue(1,nSelectedRows),FilesList.getCellValue(2,nSelectedRows),encodeURIComponent(sNewFilePathChange),FilesList.getCellValue(4,nSelectedRows),FilesList.getCellValue(5,nSelectedRows),FilesList.getCellValue(6,nSelectedRows),FilesList.getCellValue(7,nSelectedRows),FilesList.getCellValue(8,nSelectedRows),FilesList.getCellValue(9,nSelectedRows),FilesList.getCellValue(10,nSelectedRows),FilesList.getCellValue(11,nSelectedRows),FilesList.getCellValue(12,nSelectedRows),FilesList.getCellValue(13,nSelectedRows)];}if(bFileExists&&!g_bSearchView){var asFileDeleteData=[g_sCurrentDir,encodeURIComponent(g_sOriginalFilename),"0","0",encodeURIComponent(sOriginalPath),"0","0","0","0","0","0","0","0","0","0"];OnDeletedFile(asFileDeleteData,true);g_nCurrentPreviewImage=OnUploadedFile(asFileRenameData);}HideDialog('RenameDialog');if(g_bPreviewDialog)SetupEventHandlers();if(g_nShowList!=0)FilesList.element().focus();if(bFileExists&&g_bImagePreviewActive){setTimeout(function(){FilesList.setSelectedRows([g_nCurrentPreviewImage]);OnLoadImagePreview(true);},500);}}};}function OnCancelRename(){HideDialog('RenameDialog');if(g_bPreviewDialog)SetupEventHandlers();if(g_nShowList!=0)FilesList.element().focus();}CreateDialogPushButton("确定","RenameButton",OnConfirmRename);CreateDialogPushButton("取消","CancelRenameButton",OnCancelRename);var PathInput=CreateInputField("","NewPathInput","NewPathInput",undefined,200,undefined,undefined,OnConfirmRename);PathInput.onControlEditStarted=function(){PathInput.setTimeout(function(){var e=PathInput.element().getElementsByTagName("INPUT")[0];var nStart=0;var nEnd=e.value.indexOf('.');var bIsDir=(document.rename.isdir.value=="false")?false:true;if(!bIsDir){if(AW.ie){var r=e.createTextRange();r.collapse(true);r.moveStart('character',nStart);r.moveEnd('character',nEnd-nStart);r.select();}else{e.selectionStart=nStart;e.selectionEnd=nEnd;}}e.focus();});}</script><div id="RenameDialogOpaqueLayer" class="OpaqueLayer"></div><div id="RenameDialog" class="DialogLayer" style="width: 300px; left: -5000px; top: -5000px;"><table id="RenameDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="RenameDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="RenameDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-Rename"></div>   <span id="RenameDialogTitleText">重命名</span>   </div>  </td>  <td class="closebox" id="RenameDialogclosebox">   <span><img id="RenameDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('RenameDialog');" onmouseover="javascript:document.getElementById('RenameDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('RenameDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="RenameDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="rename" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td>输入新名称：<br><div style="overflow:auto"><span id="NewPathInput" style="width: 192px; height: 16px;"><span id="NewPathInput" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="NewPathInput-box" class="aw-item-box "><span id="NewPathInput-box-image" class="aw-item-image aw-image-none "></span><span id="NewPathInput-box-ruler" class="aw-item-ruler "></span><input id="NewPathInput-box-text" class="aw-item-text " value="" tabindex="0" name="NewPathInput" type="text"></span></span></span></div><input name="original_path" type="hidden"><input name="thumb_index" type="hidden"><input name="isdir" type="hidden"></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="RenameButton"><button id="btn-RenameButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="RenameButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="CancelRenameButton"><button id="btn-CancelRenameButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelRenameButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="FileSearchDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_bPreviewDialog=false;var g_sOriginalFilename="";var g_bCancelSearch=false;var g_aDirSearch=[];var gNtestFiles=0;var g_bSearchView=false;var g_nTotalVideo=0;var g_bNoFilesCancel=false;var sWebClientMagGlass=undefined;var sMagGlassImg=undefined;try{if(g_bIsWebClient){sWebClientMagGlass="WC-Icon-MagGlass";}else{sMagGlassImg="magnify_glass_search_16.png";}}catch(e){sMagGlassImg="magnify_glass_search_16.png";}BuildDialog("Searching","FileSearchDialog","450","125","","关闭/取消",sMagGlassImg,undefined,sWebClientMagGlass);function OnShowSearchDialog(sStartPath){g_bCancelSearch=false;g_bSearchView=false;g_bNoFilesCancel=false;document.getElementById("DirSearchResults").innerHTML="";document.getElementById("FileSearchingIcon").style.visibility="hidden";ShowDialog('FileSearchDialog',true,function(){OnCancelFileSearch(false,false)});$("#searchinputtxt").text($("#searchinput").val());$("#WC-Search-Info").html("");OnSearchFiles();}function ResetSearchGrid(){var SelectionMode=FilesList.getSelectionMode();document.getElementById("FileSearchingIcon").style.visibility="hidden";OnResetTotals();FilesList.clearCurrentModel();FilesList.clearRowModel();FilesList.clearCellModel();FilesList.clearScrollModel();FilesList.clearSelectionModel();FilesList.setSelectionMode(SelectionMode);FilesList.setCellFormat(SearchCellFormat);FilesList.refresh();SearchData=[[]];FilesList.setCellData(SearchData);FilesList.setRowCount(0);$("#Upload-Action").unbind('click');$("#Upload-Action-Ico").addClass('WC-Icon-Disabled');$("#Upload-Action").css("color","#909090");$("#NewDir-Action").unbind('click');$("#NewDir-Action-Ico").addClass('WC-Icon-Disabled');$("#NewDir-Action").css("color","#909090");}function OnSearchFiles(){ResetSearchGrid();g_aDirSearch=[];$("#SUWCCurrDir").html("Search results in "+g_sCurrentDirRelative);document.getElementById("DirSearchResults").innerHTML="";document.getElementById("FileSearchingIcon").style.visibility="visible";BuildSearchListing(-1);}function BuildSearchListing(nSearchPos){var sPath;if(g_bCancelSearch){bSearchInProgress=false;return;}else{bSearchInProgress=true;}if(g_aDirSearch.length)sPath=g_aDirSearch[nSearchPos];else sPath=g_sCurrentDir;if(sPath==undefined){bSearchInProgress=false;return;}var sBuildSearchListCmd="/?Command=List&DirsOnly=0&FilesOnly=0&RestoreCurrentDirectory=1&Dir="+sPath+SyncRequestParameter();var BuildSearchListTable=new AW.XML.Table;var asDirPath=[];var nContainerSize=0;var sSearchWord="";var bWildCard=false;var nFileNameLength;var nSearchWordLength;var nWildCardPos;var bDualWildCard=false;var nSearchDirsFilesType=parseInt($('input[name=searchoptionradio]:checked').val());g_bSearchView=true;sSearchWord=$("#searchinput").val().toLowerCase();nSearchWordLength=sSearchWord.length;nWildCardPos=sSearchWord.indexOf("*");if(nWildCardPos!=-1){bWildCard=true;}var nBracketedWord=sSearchWord.match(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"));var nBracketedLength=-1;if(nBracketedWord){nBracketedLength=sSearchWord.replace(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"),"1").length;}if(nBracketedLength>-1){nSearchWordLength=nBracketedLength;}sSearchWord=sSearchWord.replace(eval("/\\./g"),"\\.");sSearchWord=sSearchWord.replace(eval("/\\*/g"),"(.*)");sSearchWord=sSearchWord.replace(eval("/\\_/g"),"\\_");sSearchWord=sSearchWord.replace(eval("/\\?/g"),".");nSearchSortCol=FilesList.getSortColumn();sSearchSortDir=FilesList.getSortDirection(nSearchSortCol);$("#searchOptionButton").unbind('click');$("#Search-Action-Ico").removeClass('WC-Icon-MagGlass').addClass('WC-Icon-MagGlassCancel');$("#Search-Action-Ico").attr("title","Clear Search");$("#SearchResult-txt").show();$("#searchOptionButton").click(function(){RefreshList(false);});if(nSearchSortCol>=0)FilesList.sort(nSearchSortCol,sSearchSortDir);BuildSearchListTable.setURL(sBuildSearchListCmd);BuildSearchListTable.setRows("//file");BuildSearchListTable.setColumns(["FileName","FilePath","FileIsDir","FileIsDrive","FileDriveType","FileDate","FileSize","FileIsImage","FileIsDeleted","FileIsAudio","FileIsVideo","FileIsCompressed","FileIsEncrypted"]);BuildSearchListTable.response1=BuildSearchListTable.response;BuildSearchListTable.response=function(data){this.response1(data);for(var nIndex=0;nIndex<this.getCount();nIndex++){if(g_bCancelSearch){bSearchInProgress=false;return;}var sFileName="";var sFilePath="";var sFileDate="";var sFileSize="";var bFileIsImage="";var bFileIsAudio="";var bFileIsVideo="";var bFileIsCompressed="";var bFileIsEncrypted="";var bFileIsDir="";var bSearchMatch=false;sFileName=decodeURIComponent(this.getData(0,nIndex));sFilePath=this.getData(1,nIndex);bFileIsDir=this.getData(2,nIndex);sFileDate=this.getData(5,nIndex);sFileSize=this.getData(6,nIndex);bFileIsImage=this.getData(7,nIndex);bFileIsAudio=this.getData(9,nIndex);bFileIsVideo=this.getData(10,nIndex);bFileIsCompressed=this.getData(11,nIndex);bFileIsEncrypted=this.getData(12,nIndex);if(parseInt(bFileIsDir)==1){document.getElementById("DirSearchResults").innerHTML=decodeURIComponent(sFilePath);if(sFilePath)asDirPath.push(sFilePath);}if(nSearchDirsFilesType==0||(nSearchDirsFilesType==1&&parseInt(bFileIsDir)!=1)||(nSearchDirsFilesType==2&&parseInt(bFileIsDir)==1)){b_WildCard=false;if(b_WildCard){if(bDualWildCard&&(sFileName.toLowerCase().match(eval("/"+sSearchWord+"/")))){bSearchMatch=true;}else{nFileNameLength=sFileName.length;if(nWildCardPos==0){if(sFileName.toLowerCase().match(eval("/"+sSearchWord+"$/")))bSearchMatch=true;}else{if(sFileName.toLowerCase().match(eval("/^"+sSearchWord+"/")))bSearchMatch=true;}}}else if(sFileName.toLowerCase().search(eval("/"+sSearchWord+"/"))==0){if(bWildCard)bSearchMatch=true;else if(sFileName.length==nSearchWordLength)bSearchMatch=true;}if(bSearchMatch){var i=SearchData.length;SearchData[i]=[sFilePath,sFileSize,sFileDate,sFilePath,bFileIsDir,bFileIsImage,"","0","0","0",bFileIsAudio,bFileIsVideo,sFileName,bFileIsCompressed,bFileIsEncrypted];if(parseInt(bFileIsImage)==1)g_nTotalImages++;if(parseInt(bFileIsVideo)==1)g_nTotalVideo++;if(parseInt(bFileIsAudio)==1)g_nTotalAudio++;if(parseInt(bFileIsDir)==1)g_nTotalDirs++;g_nTotalMedia=(parseInt(g_nTotalVideo)+parseInt(g_nTotalAudio));g_nTotalSize+=parseInt(sFileSize);FilesList.addRow(i);FilesList.refresh();FilesList.setRowCount(i);FilesList.raiseEvent("adjustScrollHeight");g_nTotalFiles=parseInt(FilesList.getRowCount());document.getElementById("TotalFiles").innerHTML=g_nTotalFiles;document.getElementById("TotalDirs").innerHTML=g_nTotalDirs;document.getElementById("TotalSize").innerHTML=FormatFileSize(g_nTotalSize,true);}}nContainerSize++}if(asDirPath.length>0)g_aDirSearch=g_aDirSearch.concat(asDirPath);if(g_aDirSearch.length&&(g_aDirSearch.length!=(nSearchPos+1)))BuildSearchListing(nSearchPos+1);else{g_aDirSearch=[];document.getElementById("DirSearchResults").innerHTML="";document.getElementById("FileSearchingIcon").style.visibility="hidden";if(parseInt(FilesList.getRowCount())==0){$("#DirSearchResults").html("<span class='nofiles'>未找到文件。</span>");g_bNoFilesCancel=true;RefreshList(false);}else{g_bSearchView=true;OnCancelFileSearch(true,true);}}};BuildSearchListTable.request();}function OnCancelFileSearch(bNoSearchInfo,bHideDialog){if(!g_bCancelSearch){g_bCancelSearch=true;if(parseInt(FilesList.getRowCount())>0){if(g_nShowList==0)BuildThumbnails();if(g_bSearchView)OnAddHistory("搜索结果",false);}if(!bNoSearchInfo&&!g_bNoFilesCancel)$("#WC-Search-Info").html("Search canceled");if(bHideDialog)HideDialog('FileSearchDialog');}}function OnFileSearchOpen(){var bDoDir=false;var sDownloadFilePath="";sDownloadFilePath=SearchFilesList.getCellText(3,SearchFilesList.getSelectedRows());location.href="/?Command=Download&File="+sDownloadFilePath;}function ResetSearchOptions(bRefresh){$("#searchOptionButton").unbind('click');if($("#Search-Action-Ico").attr("title")==""&&bRefresh){$(document).tooltip("disable");$(document).tooltip("close");}$("#Search-Action-Ico").removeClass('WC-Icon-MagGlassCancel').addClass('WC-Icon-MagGlass');$("#Search-Action-Ico").attr("title","搜索");if(bRefresh){$("#searchinput").val("搜索");$("#searchinput").css("color","#959595");$(document).tooltip("enable");}$("#SearchResult-txt").hide();$("#WC-Search-Info").html("");$("#searchinput").focus(function(){if($("#searchinput").val()=="搜索")$("#searchinput").val("");$("#searchinput").css("color","#000000");});$("#searchinput").blur(function(){if($("#searchinput").val()==""){$("#searchinput").val("搜索");$("#searchinput").css("color","#959595");}});$("#searchOptionButton").click(function(){if($("#searchinput").val()!="搜索"&&$("#searchinput").val()!="")OnShowSearchDialog();else $("#searchinput").focus();});}CreateDialogPushButton("取消","CancelFileSearchButton",function(){OnCancelFileSearch(false,true)});var fmtSearchBWCFileString=new AW.Formats.BWCSearchFileString;var fmtSearchFilesize=new AW.Formats.Filesize;var fmtSearchDate=new AW.Formats.LocaleDate;var fmtSearchXMLString=new AW.Formats.XMLString;var SearchCellFormat=[fmtSearchBWCFileString,fmtSearchFilesize,fmtSearchDate,fmtSearchXMLString];var SearchData=[[]];</script><div id="FileSearchDialogOpaqueLayer" class="OpaqueLayer"></div><div id="FileSearchDialog" class="DialogLayer" style="width: 450px; left: -5000px; top: -5000px;"><table id="FileSearchDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="FileSearchDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="FileSearchDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-MagGlass"></div>   <span id="FileSearchDialogTitleText">Searching</span>   </div>  </td>  <td class="closebox" id="FileSearchDialogclosebox">   <span><img id="FileSearchDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('FileSearchDialog');" onmouseover="javascript:document.getElementById('FileSearchDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('FileSearchDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="FileSearchDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="search" onsubmit="return (false);"><table style="width:100%;"><tbody><tr><td style="width:50px;"><div id="FileSearchingIcon" style="visibility:hidden;text-align:center"><img src="/Web Client/Images/SUWCSearching.gif" style="margin:0 auto 0 auto;"></div></td><td style="padding: 20px 10px;"><div id="DirSearchtext" style="width:343px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">Searching for <span id="searchinputtxt"></span></div><div id="DirSearchResults" style="width:343px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div></td></tr></tbody></table><div style="height:35px;"><div style="width:auto;float:right;margin:10px;"><span id="CancelFileSearchButton"><button id="btn-CancelFileSearchButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelFileSearchButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></div></div></form></div></div><div id="ImageDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_nPlayThumbnailPreview=false;var g_sFilePath="";var nCurrentSlidePosition=0;var g_nSlideShowSpeed=5000;var SlideshowTimeoutId;var g_nImageDialogHeight="702";var g_nImageDialogDivHeight="455";var g_bImagePreviewActive=false;var ThumbSlider=new Slider(document.getElementById("slider-1"),document.getElementById("slider-input-1"));$(document).ready(function(){$("#SUWCSliderDrop-Contain").contextMenu({"menu":"SUWC-Slider","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#SUWCSliderDrop-Contain").css("background-color","#c4c4c4");$("#SUWC-Slider").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWC-Slider").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});setTimeout(function(){ThumbSlider.recalculate();},0);},"beforehide":function(){OnHideMenu({"sourceID":"SUWCSliderDrop-Contain"})},"afterhide":function(){$("#SUWCSliderDrop-Contain").css("background-color","transparent");}});});if(g_nScreenHeight<=768){g_nImageDialogHeight="550";g_nImageDialogDivHeight="315";}var sWebClientImgPrev=undefined;var sImgPrevImg=undefined;try{if(g_bIsWebClient){sWebClientImgPrev="WC-Icon-SlideShow";}else{sImgPrevImg="show_1_icon_16x16.png";}}catch(e){sImgPrevImg="show_1_icon_16x16.png";}BuildDialog("预览图像","ImageDialog","800",g_nImageDialogHeight,"text-align:center","关闭/取消",sImgPrevImg,true,sWebClientImgPrev);document.getElementById("imgdiv").style.height=g_nImageDialogDivHeight+"px";if(readCookie("sliderspeed")!=""&&readCookie("sliderspeed")!=null){nSliderValue=parseInt(readCookie("sliderspeed"));ThumbSlider.setValue(nSliderValue);g_nSlideShowSpeed=((9-nSliderValue)*700);}else ThumbSlider.setValue(4);ThumbSlider.onchange=function(){g_nPlayThumbnailPreview=false;clearTimeout(SlideshowTimeoutId);createCookie("sliderspeed",ThumbSlider.getValue(),60);g_nSlideShowSpeed=((9-ThumbSlider.getValue())*700);SlideshowTimeoutId=setTimeout(function(){g_nPlayThumbnailPreview=true;OnImageNext();},g_nSlideShowSpeed);};function ResetThumbScroll(bGetNew,bShow){var nScrollAdjust=0;if(bShow){document.getElementById("ImageScroller").innerHTML="";}if(bGetNew){jQuery.BuildThumbScroll(FilesList,String('ImagePreviewDialog('),true,g_nCurrentPreviewImage);}else jQuery.ResetThumbScroll(true,FilesList.getRowIndices()[g_nCurrentPreviewImage+nScrollAdjust]);jQuery.ScrollTrack(FilesList.getRowIndices()[g_nCurrentPreviewImage+nScrollAdjust]);}function ThumbScrollSetup(){ResetThumbScroll(true,true);}function OnImagePreview(bSlideShow,bNoScroll,bDeletedImage){if(parseInt(g_nTotalImages)<1)OnClosePreview();else{if(g_nShowList==0&&!bDeletedImage&&$("#ThumbListFiles li.ui-selected").length){ImagePreviewDialog(true,$("#ThumbListFiles li.ui-selected").attr("data-filename").toString(),$("#ThumbListFiles li.ui-selected").attr("data-filepath").toString(),$("#ThumbListFiles li.ui-selected").attr("data-indicesIndex").toString(),bSlideShow,$("#ThumbListFiles li.ui-selected").attr("data-filesize").toString());}else{var nSelectedRow=FilesList.getSelectedRows();var nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedRow));var anFileIndices=FilesList.getRowIndices();if((bSlideShow||bDeletedImage)&&((nSelectedRow==-1)||(FilesList.getCellValue(5,[parseInt(anFileIndices[nSelectedCurrentIndex])])==0))){nSelectedRow=FindFirstImageRow(nSelectedRow);nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedRow));}g_nCurrentPreviewImage=nSelectedCurrentIndex;if(FilesList.getCellValue(5,[parseInt(anFileIndices[g_nCurrentPreviewImage])])==1||bSlideShow){sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);nFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);FilesList.setSelectedRows([anFileIndices[parseInt(g_nCurrentPreviewImage)]]);FilesList.setCurrentRow([anFileIndices[parseInt(g_nCurrentPreviewImage)]]);if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewImage).addClass("ui-selected").siblings().removeClass("ui-selected");
ImagePreviewDialog(true,sFileName,sFilePath,undefined,bSlideShow,nFileSize);}}if(!bNoScroll||bNoScroll==undefined)ThumbScrollSetup();}}function FindFirstImageRow(nStartRow){var anRows=FilesList.getRowIndices();var nRet=-1;if(nStartRow<0)nStartRow=0;else{var nIndex=0;while((anRows[nIndex]!=nStartRow)&&(nIndex<anRows.length))nIndex++;nStartRow=nIndex;}for(var nIndex=nStartRow;nIndex<anRows.length;nIndex++){if(FilesList.getCellValue(5,parseInt(anRows[nIndex]))!=0&&FilesList.getCellValue(9,parseInt(anRows[nIndex]))!=1){nRet=anRows[nIndex];break;}}if((nRet==-1)&&(nStartRow!=0))nRet=FindFirstImageRow(0);return(nRet);}function OnClosePreview(){OnCancelPreview();HideDialog("ImageDialog");}function OnCancelPreview(){OnKillSlideShow();OnloadingImage();if(g_nShowList==0&&g_bPauseThumbnails){g_bPauseThumbnails=false;g_nThumbnailIter=g_nRestartPosition;setTimeout(function(){BuildThumbnailImages(true);},0);}RemoveEventHandlers();g_bImagePreviewActive=false;}function SetupImagePreviewDialog(sTitle,pImageURL,bShowLoading,nFileSize){var TitleText=document.getElementById("ImageDialogTitleText");if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML=sTitle;if(($("#taskbar-filename")!=undefined)&&(sTitle!=undefined))$("#taskbar-filename").html(sTitle);SetImageFileActions(sTitle,pImageURL,nFileSize);GetPreviewImage(pImageURL,bShowLoading);}function SetImageFileActions(sRawFileName,sRawFilePath,nFileSize){$("#taskbar-Download-Action").unbind("click");$("#taskbar-Rename-Action").unbind("click");$("#taskbar-Delete-Action").unbind("click");if(g_nShowList==0){g_sFilePath=sRawFilePath;var sFilePath=sRawFilePath;var sFileName=sRawFileName;$("#taskbar-Rename-Action").click(function(){OnFileRenamePrevDlg(sFilePath,sFileName,g_nCurrentPreviewImage,false);});$("#taskbar-Download-Action").click(function(){OnFileOpenPrevDlg(false,sFilePath);});$("#taskbar-Delete-Action").click(function(){OnFileDeletePrevDlg(false,sFilePath,'thumb'+g_nCurrentPreviewImage,g_nCurrentPreviewImage,true);});}else{$("#taskbar-Rename-Action").click(function(){OnFileRenamePrevDlg(undefined,undefined,undefined,undefined,true);});$("#taskbar-Download-Action").click(function(){OnFileOpenPrevDlg();});$("#taskbar-Delete-Action").click(function(){OnFileDeletePrevDlg(undefined,undefined,undefined,undefined,true);});}if(nFileSize!=undefined){$("#taskbar-size").html(nFileSize);}}function OnSetUpFileOpen(){OnKillSlideShow();if(g_nShowList==0)OnFileOpen(false,g_sFilePath);else OnFileOpen();}function OnloadingImage(){document.getElementById("PrevImg").style.border="none";document.getElementById("PrevImg").src="/Common/Images/blank.gif";document.getElementById("imgdiv").style.backgroundPosition="50%";document.getElementById("imgdiv").style.backgroundRepeat="no-repeat";document.getElementById("imgdiv").style.backgroundImage="url(/Common/Images/Busy.gif)";}function GetPreviewImage(pImageURL,bShowLoading){var PreviewImgLoad=new Image();if(bShowLoading)OnloadingImage();sEncodedFilePath=encodeURIComponent(pImageURL);if(g_nScreenHeight<=768){g_nPreviewThumbSizeWidth="400";g_nPreviewThumbSizeHeight="300";}sImagePath='/?Command=Download&File='+sEncodedFilePath+'&Width='+g_nPreviewThumbSizeWidth+'&Height='+g_nPreviewThumbSizeHeight+'&Thumbnail=1'+SyncRequestParameter();PreviewImgLoad.src=sImagePath;PreviewImgLoad.onload=function(evt){if(document.getElementById("PrevImg")){document.getElementById("imgdiv").style.background="none";document.getElementById("PrevImg").width=PreviewImgLoad.width;if(PreviewImgLoad.height!=document.getElementById("PrevImg").height){document.getElementById("PrevImg").height=PreviewImgLoad.height;}document.getElementById("PrevImg").style.border="1px solid black";document.getElementById("PrevImg").src=PreviewImgLoad.src;if(g_nPlayThumbnailPreview&&document.getElementById("ImageDialog").style.top!="-5000px"){SlideshowTimeoutId=setTimeout("OnImageNext()",g_nSlideShowSpeed);PreLoadViewerImage();}else clearTimeout(SlideshowTimeoutId);}};PreviewImgLoad.onerror=function(evt){document.getElementById("imgdiv").style.background="none";document.getElementById("PrevImg").src="/Web Client/ThumbnailIcons/ThumbnailQued48.png";document.getElementById("PrevImg").width="48";document.getElementById("PrevImg").height="48";document.getElementById("PrevImg").style.border="none";if(g_nPlayThumbnailPreview&&document.getElementById("ImageDialog").style.top!="-5000px"){SlideshowTimeoutId=setTimeout("OnImageNext()",1000);PreLoadViewerImage(1);}else clearTimeout(SlideshowTimeoutId);};}function PreLoadViewerImage(nDirection,nByPassPreviewImage){var PreLoadImg=document.createElement('img');var nNextPreviewImage;if(nDirection==0){if(nByPassPreviewImage!=undefined)nNextPreviewImage=(nByPassPreviewImage-1);else nNextPreviewImage=(g_nCurrentPreviewImage-1);}else{if(nByPassPreviewImage!=undefined)nNextPreviewImage=(nByPassPreviewImage+1);else nNextPreviewImage=(g_nCurrentPreviewImage+1);}if(nNextPreviewImage<(g_nOriginalListSize-1)){if(parseInt(FilesList.getCellText(5,nNextPreviewImage))!=1||parseInt(FilesList.getCellText(9,nNextPreviewImage))!=0){if(g_nPlayThumbnailPreview&&document.getElementById("ImageDialog").style.top!="-5000px"){setTimeout(function(){PreLoadViewerImage(nDirection,nNextPreviewImage);},0);}}else{sFileName=FilesList.getCellText(0,nNextPreviewImage);sFilePath=FilesList.getCellText(3,nNextPreviewImage);sEncodedFilePath=encodeURIComponent(sFilePath);if(g_nScreenHeight<=768){g_nPreviewThumbSizeWidth="400";g_nPreviewThumbSizeHeight="300";}sPreloadImageURL='/?Command=Download&File='+sEncodedFilePath+'&Width='+g_nPreviewThumbSizeWidth+'&Height='+g_nPreviewThumbSizeHeight+'&Thumbnail=1'+SyncRequestParameter();PreLoadImg.src=sPreloadImageURL;}}}function OnImageSlideshowPlay(bPlay){if(bPlay){if(!g_nPlayThumbnailPreview){$("#slideshow-play").unbind('click');$("#slideshow-play-txt").html('暂停幻灯片');$("#slideshow-play-ico").removeClass('WC-Icon-Play').addClass('WC-Icon-Pause');$("#slideshow-play").click(function(){OnImageSlideshowPlay(false);});$("#slideshow-play-bttm").unbind('click');$("#slideshow-play-ico-bttm").attr('title','暂停幻灯片');$("#slideshow-play-ico-bttm").removeClass('WC-Icon-PlayLrg').addClass('WC-Icon-PauseLrg');$("#slideshow-play-bttm").click(function(){OnImageSlideshowPlay(false);});g_nPlayThumbnailPreview=true;OnImageNext();}}else{OnKillSlideShow();}}function OnImageBack(){var anFileIndices=FilesList.getRowIndices();OnKillSlideShow();if(g_nCurrentPreviewImage==0){g_nCurrentPreviewImage=g_nOriginalListSize;OnImageBack();}else if(g_nCurrentPreviewImage>0){g_nCurrentPreviewImage--;if(FilesList.getCellValue(5,[parseInt(anFileIndices[g_nCurrentPreviewImage])])==1&&FilesList.getCellValue(9,[parseInt(anFileIndices[g_nCurrentPreviewImage])])==0){nCurrentSlidePosition--;if(nCurrentSlidePosition<=0)nCurrentSlidePosition=g_nTotalImages;document.getElementById("currentslide").innerHTML=nCurrentSlidePosition;sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);sFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);FilesList.setSelectedRows([parseInt(anFileIndices[g_nCurrentPreviewImage])]);FilesList.setCurrentRow(parseInt(anFileIndices[g_nCurrentPreviewImage]));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewImage).addClass("ui-selected").siblings().removeClass("ui-selected");SetupImagePreviewDialog(sFileName,sFilePath,true,sFileSize);if(jQuery.IsThumbScrollLoaded()){jQuery.ScrollTrack(anFileIndices[g_nCurrentPreviewImage]);}}else if(g_nCurrentPreviewImage>=0){if(g_nCurrentPreviewImage==0)g_nCurrentPreviewImage=g_nOriginalListSize;OnImageBack();}}}function OnImageNextClick(){OnKillSlideShow();OnImageNext();}function OnImageNext(){var nRowHeightScroll=19;var anFileIndices=FilesList.getRowIndices();if(g_nCurrentPreviewImage>=(g_nOriginalListSize-1)){g_nCurrentPreviewImage=-1;OnImageNext();}else if(g_nCurrentPreviewImage<=(g_nOriginalListSize-1)){g_nCurrentPreviewImage++;if(FilesList.getCellValue(5,[parseInt(anFileIndices[g_nCurrentPreviewImage])])==1&&FilesList.getCellValue(9,[parseInt(anFileIndices[g_nCurrentPreviewImage])])==0){nCurrentSlidePosition++;if(nCurrentSlidePosition>g_nTotalImages){nRowHeightScroll=0;nCurrentSlidePosition=1;}document.getElementById("currentslide").innerHTML=nCurrentSlidePosition;sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);sFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewImage])]);FilesList.setSelectedRows([parseInt(anFileIndices[g_nCurrentPreviewImage])]);FilesList.setCurrentRow(parseInt(anFileIndices[g_nCurrentPreviewImage]));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewImage).addClass("ui-selected").siblings().removeClass("ui-selected");SetupImagePreviewDialog(sFileName,sFilePath,true,sFileSize);if(jQuery.IsThumbScrollLoaded()){jQuery.ScrollTrack(anFileIndices[g_nCurrentPreviewImage]);}}else if(g_nCurrentPreviewImage<=(g_nOriginalListSize-1)){if(g_nCurrentPreviewImage==(g_nOriginalListSize-1))g_nCurrentPreviewImage=-1;OnImageNext();}}}function OnKillSlideShow(){$("#slideshow-play").unbind('click');$("#slideshow-play-txt").html('播放幻灯片');$("#slideshow-play-ico").removeClass('WC-Icon-Pause').addClass('WC-Icon-Play');$("#slideshow-play").click(function(){OnImageSlideshowPlay(true);});$("#slideshow-play-bttm").unbind('click');$("#slideshow-play-ico-bttm").attr('title','播放幻灯片');$("#slideshow-play-ico-bttm").removeClass('WC-Icon-PauseLrg').addClass('WC-Icon-PlayLrg');$("#slideshow-play-bttm").click(function(){OnImageSlideshowPlay(true);});clearTimeout(SlideshowTimeoutId);g_nPlayThumbnailPreview=false;}function OnLoadImagePreview(bDeleted){g_bContextKeepAppletHidden=true;OnImagePreview(false,false,bDeleted);}function OnFileRenamePrevDlg(sFilePath,sFileName,nIndex,bDir){OnKillSlideShow();if(g_nShowList==0)OnFileRename(sFilePath,sFileName,nIndex,bDir,true);else OnFileRename(undefined,undefined,undefined,undefined,true);}function OnFileOpenPrevDlg(bDir,sFilePath){OnKillSlideShow();if(g_nShowList==0)OnFileOpen(bDir,sFilePath);else OnFileOpen();}function OnFileDeletePrevDlg(bDir,sPath,sThumbId,nIndex,bPreviewDlg){OnKillSlideShow();if(g_nShowList==0)OnFileDelete(bDir,sPath,sThumbId,nIndex,bPreviewDlg);else{if(bPreviewDlg)OnFileDelete(undefined,undefined,undefined,undefined,bPreviewDlg);else OnFileDelete();}}function ImagePreviewDialog(bShow,sTitle,pImageURL,nCurrentIndex,bSlideShow,nFileSize,nImageIndex){var bScrollAction=false;var anFileIndices=FilesList.getRowIndices();g_bImagePreviewActive=true;SliderHoverImg=new Image();SliderHoverImg.src="/Common/Images/handle.horizontal.hover.png";OnloadingImage();if(nImageIndex!=undefined){bScrollAction=true;if(jQuery.IsThumbScrollLoaded()){jQuery.ScrollImages(nImageIndex);$("li[jcarouselindex!=\'"+nImageIndex+"']").children("div").children("img").css("border","1px solid #A9A9A9");$("li[jcarouselindex='"+nImageIndex+"']").children("div").children("img").css("border","2px solid #5e9eff");}nCurrentSlidePosition=nImageIndex;FilesList.setSelectedRows([parseInt(nCurrentIndex)]);FilesList.setCurrentRow(parseInt(nCurrentIndex));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewImage).addClass("ui-selected").siblings().removeClass("ui-selected");}else{if(nCurrentSlidePosition!=-1)nCurrentSlidePosition=1;else nCurrentSlidePosition=0;}document.getElementById("currentslide").innerHTML=nCurrentSlidePosition;document.getElementById("totalslides").innerHTML=g_nTotalImages;if(bSlideShow){$("#slideshow-play").unbind('click');$("#slideshow-play-txt").html('暂停幻灯片');$("#slideshow-play-ico").removeClass('WC-Icon-Play').addClass('WC-Icon-Pause');$("#slideshow-play").click(function(){OnImageSlideshowPlay(false);});$("#slideshow-play-bttm").unbind('click');$("#slideshow-play-ico-bttm").attr('title','暂停幻灯片');$("#slideshow-play-ico-bttm").removeClass('WC-Icon-PlayLrg').addClass('WC-Icon-PauseLrg');$("#slideshow-play-bttm").click(function(){OnImageSlideshowPlay(false);});g_nPlayThumbnailPreview=true;}else{$("#slideshow-play").unbind('click');$("#slideshow-play-txt").html('播放幻灯片');$("#slideshow-play-ico").removeClass('WC-Icon-Pause').addClass('WC-Icon-Play');$("#slideshow-play").click(function(){OnImageSlideshowPlay(true);});$("#slideshow-play-bttm").unbind('click');$("#slideshow-play-ico-bttm").attr('title','播放幻灯片');$("#slideshow-play-ico-bttm").removeClass('WC-Icon-PauseLrg').addClass('WC-Icon-PlayLrg');$("#slideshow-play-bttm").click(function(){OnImageSlideshowPlay(true);});clearTimeout(SlideshowTimeoutId);g_nPlayThumbnailPreview=false;}if(nCurrentIndex!=undefined){var nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nCurrentIndex));g_nCurrentPreviewImage=nSelectedCurrentIndex;FilesList.setSelectedRows([parseInt(nCurrentIndex)]);FilesList.setCurrentRow(parseInt(nCurrentIndex));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewImage).addClass("ui-selected").siblings().removeClass("ui-selected");}if(!bScrollAction){if(bShow){if(g_nShowList==0){if(g_nThumbnailIter>0&&g_nThumbnailIter!=FilesList.getRowCount())g_bPauseThumbnails=true;}if(document.getElementById("ImageDialog").style.top=="-5000px")ShowDialog("ImageDialog",true,OnCancelPreview);if(g_nShowList==0)ThumbScrollSetup();if(typeof(ThumbSlider.recalculate)!="undefined")ThumbSlider.recalculate();}else{HideDialog("ImageDialog");sTitle="预览图像";}}SetupEventHandlers();SetupImagePreviewDialog(sTitle,pImageURL,false,nFileSize);}function SetupEventHandlers(){var el=document;if(el.attachEvent){el.attachEvent("onkeydown",ImagePreviewKeyPress);}else if(el.addEventListener){el.addEventListener("keydown",ImagePreviewKeyPress,true);}else{el["onkeydown"]=ImagePreviewKeyPress;}}function RemoveEventHandlers(){var el=document;if(el.detachEvent){el.detachEvent("onkeydown",ImagePreviewKeyPress);}else if(el.removeEventListener){el.removeEventListener("keydown",ImagePreviewKeyPress,true);}else{el["onkeydown"]=null;}}function ImagePreviewKeyPress(e){var EventKeyCode=(window.event)?event.keyCode:e.keyCode;var LeftKey=(window.event)?37:e.DOM_VK_LEFT;var RightKey=(window.event)?39:e.DOM_VK_RIGHT;var HomeKey=(window.event)?36:e.DOM_VK_HOME;var EndKey=(window.event)?35:e.DOM_VK_END;if((EventKeyCode==LeftKey)){OnImageBack();}else if(EventKeyCode==RightKey){OnImageNextClick();}else if(EventKeyCode==HomeKey&&g_nCurrentPreviewImage!=0){g_nCurrentPreviewImage=-1;OnImageNext();}else if(EventKeyCode==EndKey&&(g_nCurrentPreviewImage<g_nOriginalListSize)){g_nCurrentPreviewImage=0;OnImageBack();}}</script><div id="ImageDialogOpaqueLayer" class="OpaqueLayer"></div><div id="ImageDialog" class="DialogLayer" style="width: 800px; left: -5000px; top: -5000px; text-align: center;"><table id="ImageDialogTitleBar" style="z-index: 8000;position:relative;" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="ImageDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="ImageDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-SlideShow"></div>   <span id="ImageDialogTitleText">预览图像</span>   </div>  </td>  <td class="closebox" id="ImageDialogclosebox">   <span><img id="ImageDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('ImageDialog');" onmouseover="javascript:document.getElementById('ImageDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('ImageDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="ImageDialogopaqueinner" class="opaquedialoginner"></div><div id="ImageDialogBody" style="background-color:transparent;color:#ffffff;z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><div style="width:100%;text-align:center;"><div id="SUWCRightOptions-Contain" style="float:right;margin-right: 15px;"><a href="#" id="slideshow-play"><div id="slideshow-play-ico" class="WC-Icon-18 WC-Icon-Play" title="播放幻灯片"></div><span id="slideshow-play-txt">播放幻灯片</span></a><div id="SUWCSliderDrop-Contain" style="display:inline-block;padding: 0 3px;"><span style="color:#C4C4C4;position: relative;top: -4px;">|</span><a href="#" id="SUWCSliderDrop"><div class="WC-Icon-18 WC-Icon-Settings" title="幻灯片播放速度"></div><div class="SUWCActionArrico  WC-Icon-10 WC-Icon-DownArrowGrey" style="position: relative;top: -1px;" title="幻灯片播放速度"></div></a></div></div><div style="margin-bottom:10px"><div style="padding-left:180px;"><div style="text-align:center;">Image <span id="currentslide"></span>&nbsp; 共 &nbsp;<span id="totalslides"></span></div></div></div><table style="width:100%"><tbody><tr><td style="width:50px;"><a href="javascript:OnImageBack();"><div class="WC-Icon-25 WC-Icon-Control WC-Icon-ArrowL" title="上一图像"></div></a></td><td><div id="imgdiv" style="height: 315px;" onclick="javascript:OnImageNextClick();"><img id="PrevImg" src="/Common/Images/blank.gif" style="margin:0 auto 0 auto;" width="0" height="0" border="0"></div></td><td style="width:50px;"><a href="javascript:OnImageNextClick();"><div class="WC-Icon-25 WC-Icon-Control WC-Icon-ArrowR" title="下一图像"></div></a></td></tr></tbody></table></div><div class="imgdlgTaskbar"><div style="margin-bottom:10px;margin: 0 auto 25px;width: 600px;text-align:left;"><div style="float:left; width:auto;"><span id="taskbar-filename"></span>&nbsp;&nbsp;&nbsp;&nbsp;大小: <span id="taskbar-size">0</span></div><div style="float:right;width:auto;position: relative;top: -3px;"><a href="#" id="taskbar-Download-Action"><div id="taskbar-Download-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Download" title="下载"></div>下载 <span class="pipedivide">|</span></a><a href="#" id="taskbar-Rename-Action"><div id="taskbar-Rename-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Rename" title="重命名"></div>重命名 <span class="pipedivide">|</span></a><a href="#" id="taskbar-Delete-Action"><div id="taskbar-Delete-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Delete" title="删除"></div>删除</a></div></div></div><div id="ThumbNailScrollCont"><div id="slideshow-play-bttm" style="display:inline-block;width:50px;height:50px;border:2px solid #ffffff;"><div id="slideshow-play-ico-bttm" class="WC-Icon-25 WC-Icon-Control WC-Icon-PlayLrg" title="播放幻灯片"></div></div><ul id="ImageScroller" class="jcarousel-skin-tango"></ul></div><table style="width:100%;color:#ffffff;"><tbody><tr><td></td><td align="right"></td></tr></tbody></table></div></div><div id="MediaDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_nPlayMediaPreview=false;var g_sMediaFilePath="";var nCurrentMediaPosition=0;var g_nCurrentPreviewMedia=-1;var MediashowTimeoutId;var g_bMediaPreviewActive=false;function OnMediaPreview(bPlaylist,bAutoPlay,bDeletedMedia){if(parseInt(g_nTotalMedia)<1)OnCloseMediaPreview();else{if(g_bAllowHTTPMediaPlayback==1){if(g_nShowList==0&&!bDeletedMedia&&$("#ThumbListFiles li.ui-selected").length)MediaPreviewDialog(true,$("#ThumbListFiles li.ui-selected").attr("data-filename").toString(),$("#ThumbListFiles li.ui-selected").attr("data-filepath").toString(),undefined,bPlaylist,$("#ThumbListFiles li.ui-selected").attr("data-filesize").toString(),(parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisaudio"))==1));else{var nSelectedRow=FilesList.getSelectedRows();var nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedRow));var anFileIndices=FilesList.getRowIndices();var bAudio=false;if(bPlaylist==undefined)bPlaylist=false;if(bPlaylist&&nSelectedRow==-1)nSelectedRow=0;if(bAutoPlay==undefined)bAutoPlay=false;if(bDeletedMedia==undefined)bDeletedMedia=false;if((bAutoPlay||bDeletedMedia)&&((nSelectedRow==-1)||(FilesList.getCellValue(10,[parseInt(anFileIndices[nSelectedCurrentIndex])])==0&&FilesList.getCellValue(11,[parseInt(anFileIndices[nSelectedCurrentIndex])])==0))){nSelectedRow=FindFirstMediaRow(nSelectedRow);nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedRow));}if(!bPlaylist&&nSelectedRow==-1){nSelectedRow=FindFirstMediaRow(nSelectedRow);nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedRow));}if(bPlaylist){$("#MediaDialogTitleIcon").removeClass("WC-Icon-PrevMedia").addClass("WC-Icon-PlayList");}else{$("#MediaDialogTitleIcon").removeClass("WC-Icon-PlayList").addClass("WC-Icon-PrevMedia");}g_nCurrentPreviewMedia=nSelectedCurrentIndex;if((FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1||FilesList.getCellValue(11,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1)&&!bPlaylist){sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);nFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);if(FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])!=1&&FilesList.getCellValue(11,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])!=1)nCurrentMediaPosition=-1;FilesList.setSelectedRows([anFileIndices[parseInt(g_nCurrentPreviewMedia)]]);FilesList.setCurrentRow([anFileIndices[parseInt(g_nCurrentPreviewMedia)]]);if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewMedia).addClass("ui-selected").siblings().removeClass("ui-selected");if(FilesList.getCellValue(10,[anFileIndices[parseInt(g_nCurrentPreviewMedia)]])==1)bAudio=true;MediaPreviewDialog(true,sFileName,sFilePath,undefined,bPlaylist,nFileSize,bAudio);}else if(bPlaylist)MediaPreviewDialog(true,"","",undefined,true,0,true);}}else AlertDialog("管理员已禁用 HTTP 媒体回放。");}}function OnCloseMediaPreview(){OnCancelMediaPreview();HideDialog("MediaDialog");g_bMediaPreviewActive=false;}function OnCancelMediaPreview(){OnKillMediaShow();if(g_nShowList==0&&g_bPauseThumbnails){g_bPauseThumbnails=false;g_nThumbnailIter=g_nRestartPosition;setTimeout("BuildThumbnailImages(true)");}}function SetupMediaPreviewDialog(sTitle,pMediaURL,bShowLoading,nFileSize,bAudio){var TitleText=document.getElementById("MediaDialogTitleText"),sMediaTitle;if(g_nPlayMediaPreview)TitleText.innerHTML=sMediaTitle="音频播放列表";else if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML=sMediaTitle=sTitle;SetMediaFileActions(sTitle,pMediaURL,nFileSize);if(g_bSearchView&&g_nPlayMediaPreview)GetMediaSearchFiles();else GetPreviewMedia(pMediaURL,bShowLoading,bAudio);if(($("#mediataskbar-filename")!=undefined)&&(sMediaTitle!=undefined)){$("#mediataskbar-filename").html(sMediaTitle);$("#mediataskbar-filename").prop('title',sMediaTitle);}else $("#mediataskbar-filename").prop('title',"");}function SetMediaFileActions(sRawFileName,sRawFilePath,nFileSize){$("#mediataskbar-Download-Action").unbind("click");$("#mediataskbar-Rename-Action").unbind("click");$("#mediataskbar-Delete-Action").unbind("click");if(g_nPlayMediaPreview){document.getElementById("MediaActionTable").style.display="none";$("#Media-Next-Button,#Media-Back-Button").hide();}else{document.getElementById("MediaActionTable").style.display="block";$("#Media-Next-Button,#Media-Back-Button").show();if(g_nShowList==0){g_sFilePath=sRawFilePath;sFilePath=sRawFilePath;sFileName=sRawFileName;$("#mediataskbar-Rename-Action").click(function(){OnFileRenamePrevDlg(sFilePath,sFileName,g_nCurrentPreviewMedia,false);});$("#mediataskbar-Download-Action").click(function(){OnFileOpenPrevMediaDlg(false,sFilePath);});$("#mediataskbar-Delete-Action").click(function(){OnFileDeletePrevMediaDlg(false,sFilePath,'thumb'+g_nCurrentPreviewMedia,g_nCurrentPreviewMedia);});}else{$("#mediataskbar-Rename-Action").click(function(){OnFileRenamePrevMediaDlg();});$("#mediataskbar-Download-Action").click(function(){OnFileOpenPrevMediaDlg();});$("#mediataskbar-Delete-Action").click(function(){OnFileDeletePrevMediaDlg();});}}if(nFileSize!=undefined&&!g_nPlayMediaPreview){document.getElementById("MediaSizeBlock").style.display="inline-block";document.getElementById("MediaFileSize").innerHTML=nFileSize;}else document.getElementById("MediaSizeBlock").style.display="none";}function OnloadingMedia(){document.getElementById("PrevMediaImg").style.border="none";document.getElementById("PrevMediaImg").src="/Common/Images/blank.gif";document.getElementById("MediaDiv").style.backgroundPosition="50%";document.getElementById("MediaDiv").style.backgroundRepeat="no-repeat";document.getElementById("MediaDiv").style.backgroundImage="url(/Common/Images/Busy.gif)";}function OnMediaPlay(bPlay){var Player=document.getElementById("MediaPlayer1");if(Player!=undefined&&Player!=null){if(bPlay)Player.controls.play();else{if(Player.controls.isAvailable('Pause'))Player.controls.pause();}}}function GetMediaSearchFiles(bClearPlaylist){var anRows=FilesList.getRowIndices();var sMediaFiles="";if(bClearPlaylist==undefined)bClearPlaylist=false;sPlayListCmd="/?Command=BuildPlayList";var PlayListRequest=CreatePostRequest(sPlayListCmd);var nPlayListCount=0;if(!bClearPlaylist){for(var nIndex=0;nIndex<anRows.length;nIndex++){if(FilesList.getCellValue(10,anRows[nIndex])!=0){PlayListRequest.setParameter("Path"+nPlayListCount,encodeURIComponent(FilesList.getCellText(3,anRows[nIndex])));nPlayListCount++;}}}PlayListRequest.setAsync(true);PlayListRequest.request();PlayListRequest.response=function(XMLDoc){if(!bClearPlaylist){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay){AlertDialog(GetResultText(0,"",sResultText));}else GetPreviewMedia("",true,true,true);}};}function GetPreviewMedia(pMediaURL,bShowLoading,bAudio,bSearchList,bClearRequest){var sEncodedFilePath=encodeURIComponent(pMediaURL);var sMediaPath;var nMediaHeight="500";var sPlayListDir=g_sCurrentDir;var nPlayCount="1";var bShuffle=false;var sMediaFilePaths="";if(bSearchList==undefined)bSearchList=false;if(bClearRequest==undefined)bClearRequest=false;if(g_nPlayMediaPreview){if(bSearchList)sMediaPath="/?Command=PlayList&ListFile=ListMedia.m3u&Audio=1&Session=4329501"+SyncRequestParameter();else sMediaPath="/?Command=List&Dir="+sPlayListDir+"&ListFile=ListMedia.m3u&Audio=1&Session=4329501"+SyncRequestParameter();}else sMediaPath='/?Command=Download&File='+sEncodedFilePath+'&Media=1&Session=4329501';if(bAudio||g_nPlayMediaPreview){nPlayCount="1000";}if(-1!=navigator.userAgent.indexOf("Firefox")||AW.safari||AW.chrome||AW.opera){if(navigator.userAgent.indexOf("Mac")==-1)sMediaEmbed='<object id="MediaPlayer1" type="application/x-mplayer2" width="500" height="'+nMediaHeight+'">';else if(pMediaURL=="")sMediaPath="";sMediaEmbed='<embed type="application/x-mplayer2" pluginspage="http://www.microsoft.com/Windows/MediaPlayer/" src="'+sMediaPath+'" showStatusBar="true"';sMediaEmbed+=' showControls="true" ';sMediaEmbed+=' kioskmode="false" ';sMediaEmbed+=' height="'+nMediaHeight+'" ';sMediaEmbed+=' width="500 " ';sMediaEmbed+=' scale="ASPECT" ';sMediaEmbed+='> </embed>';document.getElementById("MediaShuffle").style.display="none";}else{sMediaEmbed='<object id="MediaPlayer1" width="500" height="'+nMediaHeight+'" CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" type="application/x-oleobject" align="middle">';if(g_nPlayMediaPreview){document.getElementById("MediaShuffle").style.display="inline-block";bShuffle=true;}else document.getElementById("MediaShuffle").style.display="none";}if(navigator.userAgent.indexOf("Mac")==-1){sMediaEmbed+=' <param name="URL" value="'+sMediaPath+'" />';sMediaEmbed+=' <param name="AutoStart" value="true" />';sMediaEmbed+=' <param name="ShowStatusBar" value="true" />';sMediaEmbed+=' <param name="PlayCount" value="'+nPlayCount+'"/>';sMediaEmbed+=' <param name="StretchToFit" value="false"/>';sMediaEmbed+=' <param name="ShowControls" value="true"/>';sMediaEmbed+=' <param name="uiMode" value="full"/>';sMediaEmbed+='</object>';}document.getElementById("MediaDiv").innerHTML=sMediaEmbed;if(bShuffle)OnShuffle(MediaShuffleCheckbox);}function OnShuffle(Checkbox){var Player=document.getElementById("MediaPlayer1");if(Player!=undefined&&Player!=null){if(Checkbox.getControlValue())Player.settings.setMode("shuffle",true);else Player.settings.setMode("shuffle",false);Player.settings.autoStart=true;if(Player.controls.isAvailable('Play'))Player.controls.play();}}function OnMediaBack(){var anFileIndices=FilesList.getRowIndices();var bAudio=false;var Player=document.getElementById("MediaPlayer1");if(g_nPlayMediaPreview){if(Player!=null){if(Player.controls.isAvailable('Previous')){Player.controls.previous();}if(Player.controls.isAvailable('Play'))Player.controls.play();}}else{if(Player!=null&&Player.controls.isAvailable('Stop'))Player.controls.stop();OnKillMediaShow();if(g_nCurrentPreviewMedia==0){g_nCurrentPreviewMedia=g_nOriginalListSize;OnMediaBack();}else if(g_nCurrentPreviewMedia>0){g_nCurrentPreviewMedia--;if((FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1||FilesList.getCellValue(11,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1)&&FilesList.getCellValue(9,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==0){nCurrentMediaPosition--;if(nCurrentMediaPosition<=0)nCurrentMediaPosition=g_nTotalMedia;if(g_nPlayMediaPreview)document.getElementById("currentMedia").innerHTML="播放列表大小: ";else document.getElementById("currentMedia").innerHTML=nCurrentMediaPosition+" 共 ";sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);sFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);FilesList.setSelectedRows([parseInt(anFileIndices[g_nCurrentPreviewMedia])]);FilesList.setCurrentRow(parseInt(anFileIndices[g_nCurrentPreviewMedia]));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewMedia).addClass("ui-selected").siblings().removeClass("ui-selected");if(FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1)bAudio=true;SetupMediaPreviewDialog(sFileName,sFilePath,true,sFileSize,bAudio);}else if(g_nCurrentPreviewMedia>=0){if(g_nCurrentPreviewMedia==0)g_nCurrentPreviewMedia=g_nOriginalListSize;OnMediaBack();}}}}function OnMediaNextClick(){var Player=document.getElementById("MediaPlayer1");if(g_nPlayMediaPreview){if(Player!=null){if(Player.controls.isAvailable('Next'))Player.controls.next();if(Player.controls.isAvailable('Play'))Player.controls.play();}}else{OnKillMediaShow();OnMediaNext();}}function OnMediaNext(){var nRowHeightScroll=19;var anFileIndices=FilesList.getRowIndices();var bAudio=false;var Player=document.getElementById("MediaPlayer1");if(g_nPlayMediaPreview){if(Player!=null){if(Player.controls.isAvailable('Next'))Player.settings.autoStart=true;Player.controls.next();if(Player.controls.isAvailable('Play'))Player.controls.play();}}else{if(Player!=null&&Player.controls.isAvailable('Stop'))Player.controls.stop();OnKillMediaShow();if(g_nCurrentPreviewMedia>=(g_nOriginalListSize-1)){g_nCurrentPreviewMedia=-1;OnMediaNext();}else if(g_nCurrentPreviewMedia<=(g_nOriginalListSize-1)){g_nCurrentPreviewMedia++;if((FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1||FilesList.getCellValue(11,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1)&&FilesList.getCellValue(9,g_nCurrentPreviewMedia)==0){nCurrentMediaPosition++;if(nCurrentMediaPosition>g_nTotalMedia){nRowHeightScroll=0;nCurrentMediaPosition=1;}if(g_nPlayMediaPreview)document.getElementById("currentMedia").innerHTML="播放列表大小: ";else document.getElementById("currentMedia").innerHTML=nCurrentMediaPosition+" 共 ";sFileName=FilesList.getCellText(0,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);sFilePath=FilesList.getCellText(3,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);sFileSize=FilesList.getCellText(1,[parseInt(anFileIndices[g_nCurrentPreviewMedia])]);FilesList.setSelectedRows([parseInt(anFileIndices[g_nCurrentPreviewMedia])]);FilesList.setCurrentRow(parseInt(anFileIndices[g_nCurrentPreviewMedia]));if(g_nShowList==0)$("#thumb"+g_nCurrentPreviewMedia).addClass("ui-selected").siblings().removeClass("ui-selected");if(FilesList.getCellValue(10,[parseInt(anFileIndices[g_nCurrentPreviewMedia])])==1)bAudio=true;SetupMediaPreviewDialog(sFileName,sFilePath,true,sFileSize,bAudio);}else if(g_nCurrentPreviewMedia<=(g_nOriginalListSize-1)){if(g_nCurrentPreviewMedia==(g_nOriginalListSize-1))g_nCurrentPreviewMedia=-1;OnMediaNext();}}}}function OnKillMediaShow(){var Player=document.getElementById("MediaPlayer1");
if(Player!=null&&Player.controls.isAvailable('Stop'))Player.controls.stop();if(g_bSearchView&&g_nPlayMediaPreview){GetMediaSearchFiles(true);g_nPlayMediaPreview=false;}else{g_nPlayMediaPreview=false;GetPreviewMedia("",false);}document.getElementById("MediaDiv").innerHTML="";}function OnLoadMediaPreview(){g_bContextKeepAppletHidden=true;OnMediaPreview(false);}function OnHideMediaShow(){document.getElementById("MediaDiv").style.visibility="hidden";}function OnShowMediaShow(){document.getElementById("MediaDiv").style.visibility="visible";}function OnFileRenamePrevMediaDlg(sFilePath,sFileName,nIndex,bDir){OnHideMediaShow();if(g_nShowList==0)OnFileRename(sFilePath,sFileName,nIndex,bDir,true);else OnFileRename();}function OnFileOpenPrevMediaDlg(bDir,sFilePath){if(g_nShowList==0)OnFileOpen(bDir,sFilePath);else OnFileOpen();}function OnFileDeletePrevMediaDlg(bDir,sPath,sThumbId,nIndex){OnHideMediaShow();if(g_nShowList==0)OnFileDelete(bDir,sPath,sThumbId,nIndex,false,true);else OnFileDelete(undefined,undefined,undefined,undefined,false,true);}function MediaPreviewDialog(bShow,sTitle,pMediaURL,nCurrentIndex,bPlaylist,nFileSize,bAudio,bAutoPlayMedia){if(nCurrentMediaPosition!=-1)nCurrentMediaPosition=1;else nCurrentMediaPosition=0;if(bPlaylist){document.getElementById("currentMedia").innerHTML="播放列表大小: ";nMediaTotals=g_nTotalAudio;}else{document.getElementById("currentMedia").innerHTML=nCurrentMediaPosition+" 共 ";nMediaTotals=g_nTotalMedia;}document.getElementById("totalMedia").innerHTML=nMediaTotals;if(bPlaylist||bAutoPlayMedia){g_nPlayMediaPreview=true;}else{g_nPlayMediaPreview=false;}if(nCurrentIndex!=undefined)g_nCurrentPreviewMedia=nCurrentIndex;if(bShow){if(g_nShowList==0){if(g_nThumbnailIter>0&&g_nThumbnailIter!=FilesList.getRowCount())g_bPauseThumbnails=true;}var MediaDialogHeight=document.getElementById("MediaDialog");MediaDialogHeight.style.height="640px";if(document.getElementById("MediaDialog").style.top=="-5000px")ShowDialog("MediaDialog",true,OnCancelMediaPreview);g_bMediaPreviewActive=true;}else{HideDialog("MediaDialog");g_bMediaPreviewActive=false;sTitle="$MEDIA_DIALOG_TITLE$";}SetupMediaPreviewDialog(sTitle,pMediaURL,false,nFileSize,bAudio);}function FindFirstMediaRow(nStartRow){var anRows=FilesList.getRowIndices();var nRet=-1;if(nStartRow<0)nStartRow=0;else{var nIndex=0;while((anRows[nIndex]!=nStartRow)&&(nIndex<anRows.length))nIndex++;nStartRow=nIndex;}for(var nIndex=nStartRow;nIndex<anRows.length;nIndex++){if(FilesList.getCellValue(10,anRows[nIndex])!=0||FilesList.getCellValue(11,anRows[nIndex])!=0){nRet=anRows[nIndex];break;}}if((nRet==-1)&&(nStartRow!=0))nRet=FindFirstMediaRow(0);return(nRet);}var MediaShuffleCheckbox=CreateCheckBox("随机播放列表","MediaShuffle","shuffle",0,OnShuffle);$("#MediaShuffle .aw-item-text").css("color","#fff");var sWebClientMediaPrev=undefined;var sMediaPrevImg=undefined;try{if(g_bIsWebClient){sWebClientMediaPrev="WC-Icon-PrevMedia";}else{sMediaPrevImg="Play_video_icons_16x16.png";}}catch(e){sMediaPrevImg="Play_video_icons_16x16.png";}BuildDialog("$MEDIA_DIALOG_TITLE$","MediaDialog","620","225","text-align:center","关闭/取消",sMediaPrevImg,true,sWebClientMediaPrev);</script><div id="MediaDialogOpaqueLayer" class="OpaqueLayer"></div><div id="MediaDialog" class="DialogLayer" style="width: 620px; left: -5000px; top: -5000px; text-align: center;"><table id="MediaDialogTitleBar" style="z-index: 8000;position:relative;" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="MediaDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="MediaDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-PrevMedia"></div>   <span id="MediaDialogTitleText">$MEDIA_DIALOG_TITLE$</span>   </div>  </td>  <td class="closebox" id="MediaDialogclosebox">   <span><img id="MediaDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('MediaDialog');" onmouseover="javascript:document.getElementById('MediaDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('MediaDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="MediaDialogopaqueinner" class="opaquedialoginner"></div><div id="MediaDialogBody" style="background-color:transparent;color:#ffffff;z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><div style="width:100%;text-align:center;"><div style="margin-bottom:10px"><div style="text-align:center;margin:0 auto; width:95px;"><span id="currentMedia"></span><span id="totalMedia"></span></div></div><table style="width:100%"><tbody><tr><td style="width:50px;"><span id="Media-Back-Button"><a href="javascript:OnMediaBack();"><div class="WC-Icon-25 WC-Icon-Control WC-Icon-ArrowL" title="上一个媒体文件"></div></a></span></td><td><div id="MediaDiv" style="position:relative;zoom:1;height:500px;"><img id="PrevMediaImg" src="/Common/Images/blank.gif" style="margin:0 auto 0 auto;" width="0" height="0" border="0"></div></td><td style="width:50px;"><span id="Media-Next-Button"><a href="javascript:OnMediaNext();"><div class="WC-Icon-25 WC-Icon-Control WC-Icon-ArrowR" title="下一个媒体文件"></div></a></span></td></tr></tbody></table><div style="clear:both;">&nbsp;</div></div><div class="imgdlgTaskbar"><div style="margin-bottom:10px;margin: 0 auto 25px;width: 500px;text-align:left;"><div style="float:left; width:auto;"><span id="mediataskbar-filename" style="float:left;display: inline-block;overflow: hidden;text-overflow: ellipsis; white-space: nowrap;width: 160px;"></span> &nbsp;&nbsp;&nbsp;&nbsp;<span id="MediaSizeBlock" style="display: inline-block;float:left;margin-left:8px;">大小: <span id="MediaFileSize">0</span></span><span id="MediaShuffle"><span id="aw9" class="aw-system-control aw-item-control aw-templates-checkbox aw-ui-checkbox aw-text-expand aw-value-false aw-toggle-checkbox " tabindex="-1" hidefocus="true" title="" attrname="shuffle" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)" onclick=""><span id="aw9-box" class="aw-item-box "><span id="aw9-box-marker" class="aw-item-marker "></span><span id="aw9-box-image" class="aw-item-image aw-image-none "></span><span id="aw9-box-ruler" class="aw-item-ruler "></span><span id="aw9-box-text" class="aw-item-text " style="color: rgb(255, 255, 255);">随机播放列表</span></span></span></span></div><div style="float:right;width:auto;position: relative;top: -3px;" id="MediaActionTable"><a href="#" id="mediataskbar-Download-Action"><div id="mediataskbar-Download-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Download" title="下载"></div>下载 <span class="pipedivide">|</span></a><a href="#" id="mediataskbar-Rename-Action"><div id="mediataskbar-Rename-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Rename" title="重命名"></div>重命名 <span class="pipedivide">|</span></a><a href="#" id="mediataskbar-Delete-Action"><div id="mediataskbar-Delete-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Delete" title="删除"></div>删除</a></div></div></div></div></div><div id="GoToDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var sWebClientGoTo=undefined;var sGoToImg=undefined;try{if(g_bIsWebClient){sWebClientGoTo="WC-Icon-GoTo";}else sGoToImg="GoTo.png";}catch(e){sGoToImg="GoTo.png";}BuildDialog("转到目录","GoToDialog","300","155","","关闭/取消",sGoToImg,undefined,sWebClientGoTo);function GoToDialog(){GoToInput.setControlText(decodeURIComponent(g_sCurrentDir));ShowDialog("GoToDialog");GoToInput.getContent("box/text").element().focus();}function OnGoToPathSubmit(){var sGoToPath=GoToInput.getControlText();OnCancelGoTo();OnFileOpen(true,sGoToPath,true);}function OnCancelGoTo(){HideDialog("GoToDialog");}CreateDialogPushButton("确定","GoToButton",OnGoToPathSubmit);CreateDialogPushButton("取消","CancelGoToButton",OnCancelGoTo);var GoToInput=CreateInputField("","GoToPathInput","GoToPathInput",undefined,200,undefined,undefined,OnGoToPathSubmit);</script><div id="GoToDialogOpaqueLayer" class="OpaqueLayer"></div><div id="GoToDialog" class="DialogLayer" style="width: 300px; left: -5000px; top: -5000px;"><table id="GoToDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="GoToDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="GoToDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-GoTo"></div>   <span id="GoToDialogTitleText">转到目录</span>   </div>  </td>  <td class="closebox" id="GoToDialogclosebox">   <span><img id="GoToDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('GoToDialog');" onmouseover="javascript:document.getElementById('GoToDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('GoToDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="GoToDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="Go_To_Form" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td>路径:<br><div style="overflow:auto"><span id="GoToPathInput" style="width: 192px; height: 16px;"><span id="GoToPathInput" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="GoToPathInput-box" class="aw-item-box "><span id="GoToPathInput-box-image" class="aw-item-image aw-image-none "></span><span id="GoToPathInput-box-ruler" class="aw-item-ruler "></span><input id="GoToPathInput-box-text" class="aw-item-text " value="" tabindex="0" name="GoToPathInput" type="text"></span></span></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="GoToButton"><button id="btn-GoToButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="GoToButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="CancelGoToButton"><button id="btn-CancelGoToButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelGoToButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="FavoriteDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var sWebClientFavs=undefined;var sFavsImg=undefined;try{if(g_bIsWebClient){sWebClientFavs="WC-Icon-FavoriteStar";}else{sFavsImg="Favorites-16.png";}}catch(e){sFavsImg="Favorites-16.png";}BuildDialog("收藏夹","FavoriteDialog","400","145","","关闭/取消",sFavsImg,undefined,sWebClientFavs);var g_sFavoritePath="";function ManageFavorites(bGrid){g_bContextKeepAppletHidden=true;g_sFavoritePath="";if(bGrid&&((g_nShowList==1&&FilesList.getSelectedRows()>=0)||(g_nShowList==0&&$("#ThumbListFiles li.ui-selected").length==1))){if(g_nShowList==1)g_sFavoritePath=encodeURIComponent(FilesList.getCellText(3,FilesList.getSelectedRows()));else if($("#ThumbListFiles li.ui-selected").length==1)g_sFavoritePath=encodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filepath").toString());}else g_sFavoritePath=g_sCurrentDir;FavoriteInput.setControlText(decodeURIComponent(g_sFavoritePath));ShowDialog("FavoriteDialog");OnFocusFavName();}function OnFocusFavName(){FavoriteInput.getContent("box/text").element().focus();}function OnAddFavoritePathSubmit(){var nPercentCheck=FavoriteInput.getControlText().search(eval("/\\%/g"));if(!(nPercentCheck<0)){AlertDialog("一个字段包含无效字符。该字段不能包含以下任何字符: ; |",undefined,OnFocusFavName);return(false);}var sFavoritesName=SanitizeString(decodeURIComponent(FavoriteInput.getControlText()));var sFavCookies=readCookie("ClientFavs");var sDriveIco="Favorites";if(!CheckFavoriteValidation(Trim(sFavoritesName)))AlertDialog("一个字段包含无效字符。该字段不能包含以下任何字符: ; |",undefined,OnFocusFavName);else{if(sFavCookies!=""&&sFavCookies!=undefined&&sFavCookies!=null){if(sFavCookies.indexOf(sFavoritesName+";")<0)createCookie("ClientFavs",sFavCookies+sDriveIco+"|"+decodeURIComponent(g_sFavoritePath)+"|"+sFavoritesName+";",60);}else createCookie("ClientFavs",sDriveIco+"|"+decodeURIComponent(g_sFavoritePath)+"|"+sFavoritesName+";",60);ResetFavsList();OnCancelFavorites();}}function ResetFavsList(){var bHaveFavs=false;var nFavAdd=0;aCrumbHistory=new Array();aFavoritesHistory=new Array();for(var nIndex=0;nIndex<g_aHistory.length;nIndex++){aCrumbHistory.push([g_aHistory[nIndex],g_aHistoryNames[nIndex],g_aHistoryIcon[nIndex],g_aHistoryActive[nIndex]]);}aFavoritesHistory=GetFavoritesList();if(aFavoritesHistory.length>0){bHaveFavs=true;nFavAdd=1;}}function OnCancelFavorites(){HideDialog("FavoriteDialog");}CreateDialogPushButton("确定","AddFavoriteButton",OnAddFavoritePathSubmit);CreateDialogPushButton("取消","CancelFavoriteButton",OnCancelFavorites);var FavoriteInput=CreateInputField("","FavoritePathInput","FavoritePathInput",undefined,300,undefined,undefined,OnAddFavoritePathSubmit);function GetFavoritesList(){var aFavsCookies=readCookie("ClientFavs").split(";");var aFavsList=new Array();if(aFavsCookies!=""&&aFavsCookies!=undefined&&aFavsCookies!=null){for(var nIndex=0;nIndex<aFavsCookies.length;nIndex++){var aFavArray=aFavsCookies[nIndex].split("|");if(aFavArray[0]!=""&&aFavArray[0]!=undefined)aFavsList.push([aFavArray[2],aFavArray[1],aFavArray[0]]);}}return(aFavsList);}function OnDeleteFavCookie(sFav,sObj){var aFavsCookies=readCookie("ClientFavs").split(";");var aFavsList=new Array();var sNewFavList="";if(aFavsCookies!=""&&aFavsCookies!=undefined&&aFavsCookies!=null){for(var nIndex=0;nIndex<aFavsCookies.length-1;nIndex++){var aFavArray=aFavsCookies[nIndex].split("|");if(aFavArray[2]!=sFav&&(aFavArray[0]!="undefined"&&aFavArray[1]!="undefined"&&aFavArray[2]!="undefined")&&(aFavArray[0]!=""&&aFavArray[1]!=""&&aFavArray[2]!=""))sNewFavList=sNewFavList+aFavArray[0]+"|"+aFavArray[1]+"|"+aFavArray[2]+";";}}createCookie("ClientFavs",sNewFavList,60);document.getElementById(sObj).style.display="none";ResetFavsList();}function CheckFavoriteValidation(sFavorite){nSemiColonCheck=sFavorite.search(eval("/\\;/g"));nPoleCheck=sFavorite.search(eval("/\\|/g"));nLTCheck=sFavorite.search(eval("/\\</g"));nGTCheck=sFavorite.search(eval("/\\>/g"));nLTDecCheck=sFavorite.search(eval("/\\&#60/g"));nGTDecCheck=sFavorite.search(eval("/\\&#62/g"));if(nSemiColonCheck<0&&nPoleCheck<0&&nLTCheck<0&&nGTCheck<0&&nLTDecCheck<0&&nGTDecCheck<0)return(true);else return(false);}function OnIsFavDeleteHover(){g_bIsFavDeleteHover=true;}function OnIsFavDeleteBlur(){g_bIsFavDeleteHover=false;}</script><div id="FavoriteDialogOpaqueLayer" class="OpaqueLayer"></div><div id="FavoriteDialog" class="DialogLayer" style="width: 400px; left: -5000px; top: -5000px;"><table id="FavoriteDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="FavoriteDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="FavoriteDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-FavoriteStar"></div>   <span id="FavoriteDialogTitleText">收藏夹</span>   </div>  </td>  <td class="closebox" id="FavoriteDialogclosebox">   <span><img id="FavoriteDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('FavoriteDialog');" onmouseover="javascript:document.getElementById('FavoriteDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('FavoriteDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="FavoriteDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="Favorite_Form" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td colspan="2">将此目录添加为收藏夹。要访问您的收藏夹，点击或鼠标悬停于 Serv-U 标志旁边的历史记录下拉箭头。</td></tr><tr><td>名称:<br><div style="overflow:auto"><span id="FavoritePathInput" style="width: 292px; height: 16px;"><span id="FavoritePathInput" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:292px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="FavoritePathInput-box" class="aw-item-box "><span id="FavoritePathInput-box-image" class="aw-item-image aw-image-none "></span><span id="FavoritePathInput-box-ruler" class="aw-item-ruler "></span><input id="FavoritePathInput-box-text" class="aw-item-text " value="" tabindex="0" name="FavoritePathInput" type="text"></span></span></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="AddFavoriteButton"><button id="btn-AddFavoriteButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="AddFavoriteButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="CancelFavoriteButton"><button id="btn-CancelFavoriteButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelFavoriteButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="UserEmailDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("用户电子邮件地址","UserEmailDialog","300","160","","关闭/取消",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="/Web Client/Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("电子邮件地址和验证电子邮件地址不匹配。请重新输入两个电子邮件地址。");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("设置您的电子邮件地址失败。请联系您的管理员请求帮助。");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="/?Command=Logout";}CreateDialogPushButton("确定","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("取消","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("注销","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script><div id="UserEmailDialogOpaqueLayer" class="OpaqueLayer"></div><div id="UserEmailDialog" class="DialogLayer" style="width: 300px; left: -5000px; top: -5000px;"><table id="UserEmailDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="UserEmailDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="UserEmailDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-ChangeEmail"></div>   <span id="UserEmailDialogTitleText">用户电子邮件地址</span>   </div>  </td>  <td class="closebox" id="UserEmailDialogclosebox">   <span><img id="UserEmailDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('UserEmailDialog');" onmouseover="javascript:document.getElementById('UserEmailDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('UserEmailDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="UserEmailDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td style="vertical-align:middle;padding-left:5px;">请输入或验证您的电子邮件地址。 <br><div style="margin-top:5px;">电子邮件地址:<br><div style="overflow:auto"><span id="CurrentUserEmail" style="width: 192px; height: 16px;"><span id="CurrentUserEmail" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="CurrentUserEmail-box" class="aw-item-box "><span id="CurrentUserEmail-box-image" class="aw-item-image aw-image-none "></span><span id="CurrentUserEmail-box-ruler" class="aw-item-ruler "></span><input id="CurrentUserEmail-box-text" class="aw-item-text " value="" tabindex="0" name="CurrentUserEmail" type="text"></span></span></span></div></div><div>验证电子邮件地址:<br><div style="overflow:auto"><span id="UserEmail" style="width: 192px; height: 16px;"><span id="UserEmail" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="UserEmail-box" class="aw-item-box "><span id="UserEmail-box-image" class="aw-item-image aw-image-none "></span><span id="UserEmail-box-ruler" class="aw-item-ruler "></span><input id="UserEmail-box-text" class="aw-item-text " value="" tabindex="0" name="UserEmail" type="text"></span></span></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"><button id="btn-SaveUserEmailButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="SaveUserEmailButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="LogoutUserEmailButton"><button id="btn-LogoutUserEmailButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="LogoutUserEmailButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">注销</span></button></span><span id="CancelUserEmailButton"><button id="btn-CancelUserEmailButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelUserEmailButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="ChangePasswordDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("更改密码","ChangePasswordDialog","300","155","","关闭/取消",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="/Web Client/Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="密码更改失败。该域可能不允许用户更改密码。请联系您的管理员。";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){if(sWelcomeMsg!=""&&sWelcomeMsg!=undefined){HideDialog('ChangePasswordDialog');WelcomeDialog(sWelcomeMsg.replace(new RegExp("\\n","g"),"<br>"),OnLoginOK);}else{ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false);}}else{HideDialog('ChangePasswordDialog');AlertDialog("您的密码已更改。");}};}else{AlertDialog("新密码与验证密码不匹配。",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="/?Command=Logout";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin)CancelPasswordButton.setControlText("注销");}CreateDialogPushButton("确定","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("取消","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="ChangePasswordDialogOpaqueLayer" class="OpaqueLayer"></div><div id="ChangePasswordDialog" class="DialogLayer" style="width: 300px; left: -5000px; top: -5000px;"><table id="ChangePasswordDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="ChangePasswordDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <div id="ChangePasswordDialogTitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 WC-Icon-ChangePassword"></div>   <span id="ChangePasswordDialogTitleText">更改密码</span>   </div>  </td>  <td class="closebox" id="ChangePasswordDialogclosebox">   <span><img id="ChangePasswordDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('ChangePasswordDialog');" onmouseover="javascript:document.getElementById('ChangePasswordDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('ChangePasswordDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="ChangePasswordDialogBody" style="z-index:8000;position:relative;width:2px;" class="DialogBody"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tbody><tr><td style="vertical-align:middle;padding-left:5px;"><div>原密码:<div style="overflow:auto"><span id="OldPasswordChange" style="width: 192px; height: 16px;"><span id="OldPasswordChange" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="OldPasswordChange-box" class="aw-item-box "><span id="OldPasswordChange-box-image" class="aw-item-image aw-image-none "></span><span id="OldPasswordChange-box-ruler" class="aw-item-ruler "></span><input id="OldPasswordChange-box-text" class="aw-item-text " value="" tabindex="0" name="OldPasswordChange" type="password"></span></span></span></div></div><div>新密码:<br><div style="overflow:auto"><span id="NewPasswordChange" style="width: 192px; height: 16px;"><span id="NewPasswordChange" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="NewPasswordChange-box" class="aw-item-box "><span id="NewPasswordChange-box-image" class="aw-item-image aw-image-none "></span><span id="NewPasswordChange-box-ruler" class="aw-item-ruler "></span><input id="NewPasswordChange-box-text" class="aw-item-text " value="" tabindex="0" name="NewPasswordChange" type="password"></span></span></span></div></div><div>验证密码:<div style="overflow:auto"><span id="VerifyNewPasswordChange" style="width: 192px; height: 16px;"><span id="VerifyNewPasswordChange" class="aw-system-control aw-item-control aw-ui-input aw-input-box " style="width:192px;height:16px;" tabindex="-1" hidefocus="true" title="" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)"><span id="VerifyNewPasswordChange-box" class="aw-item-box "><span id="VerifyNewPasswordChange-box-image" class="aw-item-image aw-image-none "></span><span id="VerifyNewPasswordChange-box-ruler" class="aw-item-ruler "></span><input id="VerifyNewPasswordChange-box-text" class="aw-item-text " value="" tabindex="0" name="VerifyNewPasswordChange" type="password"></span></span></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"><button id="btn-ChangePasswordButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="ChangePasswordButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span><br><span id="CancelChangePasswordButton"><button id="btn-CancelChangePasswordButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CancelChangePasswordButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table></form></div></div><div id="CheckJREDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"></div><script type="text/javascript" language="JavaScript">BuildDialog("Verify Java Runtime","CheckJREDialog","250","115","text-align:center","关闭/取消");var g_sCheckJREDialog="CheckJREDialog";var g_fnChkConfirmYes=undefined,g_fnChkConfirmNo=undefined;function CheckJREDialog(fnYes,fnNo,nWidth,nHeight){g_fnChkConfirmYes=fnYes;g_fnChkConfirmNo=fnNo;if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nWidth=nWidth.toString()+"px";else nWidth=nWidth;if(nWidth!=undefined){document.getElementById("CheckJREDialog").style.width=nWidth;document.getElementById("CheckJREDialogText").style.width=(parseInt(nWidth)-50)+"px";}else document.getElementById("CheckJREDialog").style.width="250px";document.getElementById("CheckJREDialogBody").style.overflow="hidden";document.getElementById("CheckJREDialogBody").style.textOverflow="ellipsis";ShowDialog("CheckJREDialog");CheckConfirmCheckBox.setControlValue(false);CheckJREDialogYesBtn.focus();}function OnCheckJREDialogClose(){HideDialog("CheckJREDialog");}function UpdateDoNotAskCookie(nOpt){var bIsChecked=CheckConfirmCheckBox.getControlValue();createCookie("JreDlgDoNotAsk",(bIsChecked?"1":"0"),60);createCookie("JreDlgYesOrNo",(nOpt==0?"0":"1"),60);}function OnYesBtn(){OnCheckJREDialogClose();UpdateDoNotAskCookie(0);if(g_fnChkConfirmYes!=undefined)g_fnChkConfirmYes();}function OnNoBtn(){OnCheckJREDialogClose();UpdateDoNotAskCookie(1);if(g_fnChkConfirmNo!=undefined)g_fnChkConfirmNo();}var CheckJREDialogYesBtn=CreatePushButton("是","CheckJREDialogYesBtn",OnYesBtn);var CheckJREDialogNoBtn=CreatePushButton("否","CheckJREDialogNoBtn",OnNoBtn);var CheckConfirmCheckBox=CreateCheckBox("不再显示该消息。","CheckJREDialogCheckBox","CheckJREDialogCheckBox");</script><div id="CheckJREDialogOpaqueLayer" class="OpaqueLayer"></div><div id="CheckJREDialog" class="DialogLayer" style="width: 250px; left: -5000px; top: -5000px; text-align: center;"><table id="CheckJREDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="CheckJREDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="CheckJREDialogTitleIcon" src="/Common/Images/SULogo-Dlg-Ico.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">   <span id="CheckJREDialogTitleText">Verify Java Runtime</span>   </div>  </td>  <td class="closebox" id="CheckJREDialogclosebox">   <span><img id="CheckJREDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('CheckJREDialog');" onmouseover="javascript:document.getElementById('CheckJREDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('CheckJREDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="CheckJREDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table id="CheckJREDialogtable" border="0"><tbody><tr><td valign="top"><img src="/Common/Images/Warn.png" style="margin-right:8px" width="32" height="32" border="0"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div style="margin: 10px auto;"><div id="CheckJREDialogText" style="overflow:hidden;text-overflow:ellipsis;text-align:left;margin-bottom: 5px;">We detected that your browser has an older version of the Java Runtime Environment (JRE).  To help you ensure Web Client Pro can run properly within your environment, please follow one of the options below:</div><div style="overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left: 20px;">1. <strong>(Recommended)</strong> Install the latest version of the Java Runtime Environment from Oracle which can be found at <a href="http://www.java.com/">www.java.com</a>.</div><div style="overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left: 20px;margin-top:8px;">2. Lower your "Security Settings" within the Java Control Panel.  More detailed instructions can be found at <a href="http://www.Gymbaby.com/kb/2140">http://www.Gymbaby.com/kb/2140</a>.</div><div style="overflow:hidden;text-overflow:ellipsis;text-align:left;margin-top:20px;">Do you want to continue loading Web Client Pro within your environment?</div></div></td></tr><tr><td colspan="2" style="text-align:center" id="CheckJREDialogbuttons"><div style="margin: 4px auto 0px auto;"><div style="float:left;margin-left:10px;"><span id="CheckJREDialogCheckBox"><span id="aw17" class="aw-system-control aw-item-control aw-templates-checkbox aw-ui-checkbox aw-text-expand aw-value-false aw-toggle-checkbox " tabindex="-1" hidefocus="true" title="" attrname="CheckJREDialogCheckBox" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)" onclick=""><span id="aw17-box" class="aw-item-box "><span id="aw17-box-marker" class="aw-item-marker "></span><span id="aw17-box-image" class="aw-item-image aw-image-none "></span><span id="aw17-box-ruler" class="aw-item-ruler "></span><span id="aw17-box-text" class="aw-item-text ">不再显示该消息。</span></span></span></span></div><div style="float:right;margin-right:10px;"><span id="CheckJREDialogYesBtn"><button id="btn-CheckJREDialogYesBtn" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CheckJREDialogYesBtn" type="button" role="button"><span class="ui-button-text" style="display:inline-block">是</span></button></span><span id="CheckJREDialogNoBtn"><button id="btn-CheckJREDialogNoBtn" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="CheckJREDialogNoBtn" type="button" role="button"><span class="ui-button-text" style="display:inline-block">否</span></button></span></div><div style="clear:both;"></div></div></td></tr></tbody></table></div></div><div id="XferDialoginner" style="display:none;"></div><div id="OpenJDKDialoginner" style="display:none;"></div><script type="text/javascript" language="JavaScript">var g_fnXferOKCallback=undefined;var g_fnXferCancelCallback=undefined;var g_fnOpenJDKOKCallback=undefined;var g_fnOpenJDKCancelCallback=undefined;BuildDialog("Gymbaby Web Client Pro","XferDialog","400","300","text-align:center","关闭/取消","WebClientPro.png");BuildDialog("Gymbaby Web Client Pro","OpenJDKDialog","400","300","text-align:center","关闭/取消","WebClientPro.png");function ShowWCPConfirmDialog(nUnsupportedBrowser,nSupportsJWS,fnOKCallback,fnCancelCallback){var ua=navigator.userAgent;XFerCheckConfirmCheckBox.setControlValue("");var XferDialogImgWarn=document.getElementById("XferDialogImgWarn");var XferDialogImgInfo=document.getElementById("XferDialogImgInfo");var XferDialogTextNoJava=document.getElementById("XferDialogTextNoJava");var XferDialogTextConfirm=document.getElementById("XferDialogTextConfirm");var MacBrowserNotSupportedTxt=document.getElementById("MacBrowserNotSupportedTxt");var WinSafariNotSupportedTxt=document.getElementById("WinSafariNotSupportedTxt");var CheckXFerDialogCheckBox=document.getElementById("CheckXFerDialogCheckBox");var XferDialogCancelButtonDiv=document.getElementById("XferDialogCancelButton");BusyDialog(false);document.getElementById("XferDialogTitleText").innerHTML="Gymbaby Web Client Pro";XferDialogImgWarn.style.display="block";XferDialogImgInfo.style.display="none";if(nUnsupportedBrowser>0){XferDialogTextNoJava.style.display="none";XferDialogTextConfirm.style.display="none";if(nUnsupportedBrowser==JAVA_CHECK_UNSUPPORTED_BROWSER_WIN_SAFARI){MacBrowserNotSupportedTxt.style.display="none";WinSafariNotSupportedTxt.style.display="block";}else if((nUnsupportedBrowser==JAVA_CHECK_UNSUPPORTED_BROWSER_MAC_FIREFOX)||(nUnsupportedBrowser==JAVA_CHECK_UNSUPPORTED_BROWSER_MAC_CHROME)){WinSafariNotSupportedTxt.style.display="none";MacBrowserNotSupportedTxt.style.display="block";}CheckXFerDialogCheckBox.style.display="none";XferDialogCancelButtonDiv.style.display="none";}else if(nSupportsJWS!=1){XferDialogTextNoJava.style.display="block";XferDialogTextConfirm.style.display="none";MacBrowserNotSupportedTxt.style.display="none";WinSafariNotSupportedTxt.style.display="none";CheckXFerDialogCheckBox.style.display="none";XferDialogCancelButtonDiv.style.display="none";}else{document.getElementById("XferDialogTitleText").innerHTML="启用 Web Client Pro";XferDialogTextNoJava.style.display="none";XferDialogTextConfirm.style.display="block";MacBrowserNotSupportedTxt.style.display="none";WinSafariNotSupportedTxt.style.display="none";CheckXFerDialogCheckBox.style.display="block";XferDialogCancelButtonDiv.style.display="inline";XferDialogImgWarn.style.display="none";XferDialogImgInfo.style.display="block";}if((fnOKCallback!=undefined)&&(nSupportsJWS==1)&&(nUnsupportedBrowser!=1))g_fnXferOKCallback=fnOKCallback;if(fnCancelCallback!=undefined)g_fnXferCancelCallback=fnCancelCallback;ShowDialog("XferDialog");XferDialogOKButton.focus();}function OnXferDialogOkay(){if(XFerCheckConfirmCheckBox.getControlValue())createCookie(COOKIE_SHOW_AGAIN_WCP_INFO,"1",60);if(g_fnXferOKCallback!=undefined){HideDialog("XferDialog");g_fnXferOKCallback();}else HideDialog("XferDialog");g_fnXferOKCallback=undefined;}function OnXferCancelDialog(){if(g_fnXferCancelCallback!=undefined){HideDialog("XferDialog");g_fnXferCancelCallback();}else HideDialog("XferDialog");g_fnXferCancelCallback=undefined;}var XferDialogOKButton=CreateDialogPushButton("确定","XferDialogOkButton",OnXferDialogOkay);CreateDialogPushButton("取消","XferDialogCancelButton",OnXferCancelDialog);var XFerCheckConfirmCheckBox=CreateCheckBox("不再显示该消息。","CheckXFerDialogCheckBox","ConfirmXFerDialogCheckBox");function ShowWCP_OpenJDKConfirmDialog(fnOkayCallback,fnCancelCallback){if(fnOkayCallback!=undefined)g_fnOpenJDKOKCallback=fnOkayCallback;if(fnCancelCallback!=undefined)g_fnOpenJDKCancelCallback=fnCancelCallback;ShowDialog("OpenJDKDialog");OpenJDKDialogOKButton.focus();}function OnOpenJDKDialogOkay(){if(OpenJDKCheckConfirmCheckBox.getControlValue())createCookie(COOKIE_OPEN_JDK_CHECK,"1",60);if(g_fnOpenJDKOKCallback!=undefined){HideDialog("OpenJDKDialog");g_fnOpenJDKOKCallback();}else HideDialog("OpenJDKDialog");g_fnOpenJDKOKCallback=undefined;}function OnOpenJDKCancelDialog(){if(g_fnOpenJDKCancelCallback!=undefined){HideDialog("OpenJDKDialog");g_fnOpenJDKCancelCallback();}else HideDialog("OpenJDKDialog");g_fnOpenJDKCancelCallback=undefined;}var OpenJDKDialogOKButton=CreatePushButton("继续 - 我已安装了 Oracle 的 JRE","OpenJDKDialogOkButton",OnOpenJDKDialogOkay,250,30);CreatePushButton("取消 - 不启动 Web Client Pro","OpenJDKDialogCancelButton",OnOpenJDKCancelDialog,250,30);var OpenJDKCheckConfirmCheckBox=CreateCheckBox("不再显示该消息。","CheckOpenJDKDialogCheckBox","ConfirmOpenJDKDialogCheckBox");</script><div id="XferDialogOpaqueLayer" class="OpaqueLayer"></div><div id="XferDialog" class="DialogLayer" style="width: 400px; left: -5000px; top: -5000px; text-align: center;"><table id="XferDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="XferDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="XferDialogTitleIcon" src="/Common/Images/WebClientPro.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="16" height="16" border="0">   <span id="XferDialogTitleText">Gymbaby Web Client Pro</span>   </div>  </td>  <td class="closebox" id="XferDialogclosebox">   <span><img id="XferDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('XferDialog');" onmouseover="javascript:document.getElementById('XferDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('XferDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="XferDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table style="width:100%" border="0"><tbody><tr><td style="width:50px;vertical-align:top;"><span id="XferDialogImgWarn" style="display:block;"><img src="/Common/Images/Warn.png" alt="Serv-U" style="margin:0 8px 0 0;border:none;" width="32" height="32" border="0" align="middle"></span><span id="XferDialogImgInfo" style="display:none;"><img src="/Common/Images/Information.png" alt="Serv-U" style="margin:0 8px 0 0;border:none;" width="32" height="32" border="0" align="middle"></span></td><td class="multiXferDialogTxt"><span id="XferDialogTextNoJava" style="display:none;padding-bottom:10px;">无法在此计算机上检测到 Java 运行时环境（JRE）。请遵照 Web Client Pro 帮助部分中的说明步骤，安装 Java 运行时环境。</span><span id="XferDialogTextConfirm" style="display:none;padding-bottom:10px;">Gymbaby 的 Web Client Pro 插件允许您拖拽文件（仅Windows），传输多个文件，传输非常大的文件（&gt;2GB），并控制长时间运行的传输。<br><br>Web Client Pro 要求 Java。如果缺少 Java，请从<a href="http://www.java.com/" target="_blank">Oracle的Java 网站</a> 安装它。<br><br>请在接下来的几个对话框里点击“运行”，“确定”等来设置 Web Client Pro 插件。</span><span id="MacBrowserNotSupportedTxt" style="display:none;padding-bottom:10px;">Macintosh 操作系统上的 web 浏览器不符合 Web Client Pro 的要求。<br><br>如果您要使用 Web Client Pro，请使用其他浏览器。Web Client Pro 在 Mac OS X 上支持 Safari 和 Opera。</span><span id="WinSafariNotSupportedTxt" style="display:none;padding-bottom:10px;">Windows 上的 Safari 浏览器不符合 Web Client Pro 的要求。<br><br>要使用 Web Client Pro，请使用其他浏览器，例如 Internet Explorer、Firefox、Google Chrome 或 Opera。</span><div><span id="CheckXFerDialogCheckBox" style="display:none;margin-left:-4px;"><span id="aw18" class="aw-system-control aw-item-control aw-templates-checkbox aw-ui-checkbox aw-text-expand aw-value-false aw-toggle-checkbox " tabindex="-1" hidefocus="true" title="" attrname="ConfirmXFerDialogCheckBox" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)" onclick=""><span id="aw18-box" class="aw-item-box "><span id="aw18-box-marker" class="aw-item-marker "></span><span id="aw18-box-image" class="aw-item-image aw-image-none "></span><span id="aw18-box-ruler" class="aw-item-ruler "></span><span id="aw18-box-text" class="aw-item-text ">不再显示该消息。</span></span></span></span></div></td></tr><tr><td colspan="2" style="text-align:center"><span id="XferDialogOkButton"><button id="btn-XferDialogOkButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="XferDialogOkButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">确定</span></button></span>&nbsp;&nbsp;<span id="XferDialogCancelButton" style="display:none"><button id="btn-XferDialogCancelButton" style="white-space: nowrap; width: 85px; height: 25px; margin-bottom: 4px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="XferDialogCancelButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消</span></button></span></td></tr></tbody></table><form name="IEForm"><input id="IEJava" type="hidden"></form></div></div><div id="OpenJDKDialogOpaqueLayer" class="OpaqueLayer"></div><div id="OpenJDKDialog" class="DialogLayer" style="width: 400px; left: -5000px; top: -5000px; text-align: center;"><table id="OpenJDKDialogTitleBar" style="" class="DialogTitle" cellspacing="0" cellpadding="0"> <tbody><tr>  <td class="headcontainer">   <div id="OpenJDKDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">   <img id="OpenJDKDialogTitleIcon" src="/Common/Images/WebClientPro.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="16" height="16" border="0">   <span id="OpenJDKDialogTitleText">Gymbaby Web Client Pro</span>   </div>  </td>  <td class="closebox" id="OpenJDKDialogclosebox">   <span><img id="OpenJDKDialogCloseIcon" src="/Common/Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="关闭/取消" onmousedown="javascript:HideDialog('OpenJDKDialog');" onmouseover="javascript:document.getElementById('OpenJDKDialogclosebox').className ='closebox-hover'" onmouseout="javascript:document.getElementById('OpenJDKDialogclosebox').className ='closebox'" width="40" height="40" border="0"></span>  </td> </tr></tbody></table><div id="OpenJDKDialogBody" style="z-index:8000;position:relative;width:2px;text-align:center" class="DialogBody"><table style="width:100%" border="0"><tbody><tr><td style="width:50px;vertical-align:top;"><img src="/Common/Images/Warn.png" alt="Serv-U" style="margin:0 8px 0 0;border:none;" width="32" height="32" border="0" align="middle"></td><td style="text-align:left;vertical-align:middle;padding-right:10px;"><span id="OpenJDKText" style="padding-bottom:10px;"><b>重要注意事项：</b>安装在 Linux 上的 IcedTea 浏览器插件与 Web Client Pro 不兼容。<br><br>我们推荐安装 Oracle 的 Java Runtime Environment（JRE）来替代 OpenJDK Runtime。<a href="http://www.solarwinds.com/documentation/Gymbaby-webclient/help.aspx?topic=Help-WCP-Java.htm" target="_blank">点击此处</a>获取如何在 Linux/Unix 操作系统上安装 Oracle JRE 的指示说明。</span><div style="padding-top:10px;"><span id="CheckOpenJDKDialogCheckBox" style="margin-left:-4px;"><span id="aw19" class="aw-system-control aw-item-control aw-templates-checkbox aw-ui-checkbox aw-text-expand aw-value-false aw-toggle-checkbox " tabindex="-1" hidefocus="true" title="" attrname="ConfirmOpenJDKDialogCheckBox" oncontextmenu="return false" onselectstart="return false" onactivate="AW(this,event)" onclick=""><span id="aw19-box" class="aw-item-box "><span id="aw19-box-marker" class="aw-item-marker "></span><span id="aw19-box-image" class="aw-item-image aw-image-none "></span><span id="aw19-box-ruler" class="aw-item-ruler "></span><span id="aw19-box-text" class="aw-item-text ">不再显示该消息。</span></span></span></span></div></td></tr><tr><td colspan="2" style="text-align:center"><span id="OpenJDKDialogOkButton"><button id="btn-OpenJDKDialogOkButton" style="white-space: nowrap; width: 250px; height: 30px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="OpenJDKDialogOkButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">继续 - 我已安装了 Oracle 的 JRE</span></button></span></td></tr><tr><td colspan="2" style="text-align:center"><span id="OpenJDKDialogCancelButton"><button id="btn-OpenJDKDialogCancelButton" style="white-space: nowrap; width: 250px; height: 30px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="OpenJDKDialogCancelButton" type="button" role="button"><span class="ui-button-text" style="display:inline-block">取消 - 不启动 Web Client Pro</span></button></span></td></tr></tbody></table><form name="IEForm"><input id="IEJava" type="hidden"></form></div></div><script type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="/Common/Images/blank.gif";</script><!--[if lt IE 7]><script type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("/Common/Scripts/pngbehavior.htc");}</style><![endif]--><script type="text/javascript" language="JavaScript" src="/Common/Java/WebClientProConsts.js"></script><!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// Start of HTML Body ///////////////////////////////////////////////////////////////////////////////////////////// --><div id="container" style="overflow:hidden;"><div class="SUWCHeader" id="SUWCHeader"><div class="SUWCsulogo"><a href="/Web Client/ListDir.htm"><script type="text/javascript" language="JavaScript">if(g_bDisableBranding&&!g_bHasCustomLogo){document.write('<img src="/Common/Images/blank.gif" id="SULOGO" class="SUWCHeadLogo" width="1" height="1"/>');}else document.write('<img class="SUWCHeadLogo" src="/%25LOGO_FILE%25/Web Client/Share/Images/Gymbaby-Logo-Text-small.png?Width=160&Height=40&Thumbnail=1" alt="Web 客户端" id="SULOGO" border="0" width="160" height="40" />');</script><img class="SUWCHeadLogo" src="http://vi.gymbaby.cn/%25LOGO_FILE%25/Web%20Client/Share/Images/Gymbaby-Logo-Text-small.png?Width=160&amp;Height=40&amp;Thumbnail=1&amp;Sync=1516759119752" alt="Web 客户端" id="SULOGO" style="margin-right: 10px;" width="160" height="40" border="0"></a></div><div class="SUWCheadbar"></div><div class="SUWCheadtext">Web 客户端</div><div class="SUWCheadlinks">&nbsp;<span class="SUWCHeadFavsField"><span class="SUWCHeadLinkHand" id="SUWCHeadFavs"><a href="#" id="favHistory-ico" class="helpico WC-Icon-18 WC-Icon-FavoriteStar" title="收藏夹"></a>收藏夹<img src="/Web Client/Share/Images/icon_user_name_dropdown.png" alt="" style="margin-left: 4px;" id="favHistorydrop-ico" border="0"></span></span><span class="SUWCHeadToolsField" style="margin-left: 20px;"><span class="SUWCHeadLinkHand" id="SUWCHeadTools"><a href="#" class="helpico WC-Icon-18 WC-Icon-Tools" title="工具"></a>工具<img src="/Web Client/Share/Images/icon_user_name_dropdown.png" alt="" style="margin-left: 4px;" border="0"></span></span><a href="javascript:LaunchClientHelp('Help-Overview.htm');" style="margin-left: 20px;"><span class="SUWCHeadLinkHand"><div class="helpico WC-Icon-18 WC-Icon-Help" title="帮助"></div>帮助</span></a><span class="SUWCHeadUserField"><span class="SUWCHeadLinkHand" id="SUWCHeadUsernameMenuOwner"><span id="SUWCHeadUsername"><span id="UserLogInFullName">测试中心</span></span><img src="/Web Client/Share/Images/icon_user_name_dropdown.png" alt="" style="margin-left: 4px;" border="0"></span></span></div></div><script type="text/javascript">$(document).ready(function(){if(""==""){if("测试中心"=="")$("#UserLogInFullName").html("本地管理");else $("#UserLogInFullName").html("测试中心");}else $("#UserLogInFullName").html("");$("#SUWCHeadFavs").contextMenu({"menu":"SUWCFavsListMenu","allowLeftClick":"1",
"showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#SUWCFavsListMenu").html(BuildFavorites());$("#SUWCFavsListMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCFavsListMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"SUWCHeadFavs"})}});$("#SUWCHeadTools").contextMenu({"menu":"SUWCToolsListMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#SUWCToolsListMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCToolsListMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"SUWCHeadTools"})}});$("#SUWCHeadUsernameMenuOwner").contextMenu({"menu":"SUWCUserOptionListMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#SUWCUserOptionListMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCUserOptionListMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"SUWCHeadUsernameMenuOwner"})}});});function BuildFavorites(){var aFavList=GetFavoritesList();var sFavString="";aFavList.sort(function(value1,value2){return(NaturalSort(true,value1[0],value2[0],(!g_bCaseSensitiveOS)));});if(aFavList.length>=1){for(var nIndex=0;nIndex<aFavList.length;nIndex++){sOnGoToFavPath=String('OnOpenCrumb(\''+CleanPathByEscape(aFavList[nIndex][1])+'\','+nIndex+',true);');sOnDeleteFavCookie=String('OnDeleteFavCookie(\''+CleanPathByEscape(aFavList[nIndex][0])+'\',\'favitem'+nIndex+'\');');sFavString+='<li id="favitem'+nIndex+'"><a href="#" data-handler="javascript:'+sOnDeleteFavCookie+'" class="suwc-favs-delete"><span class="suwc-favs-delete-ico"><img src="/Web Client/Images/control_icons/fav_delete12x12.png" alt="删除" border="0" onmouseover="javascript:this.src=\'/Web Client/Images/control_icons/fav_delete12x12_hover.png\';" onmouseout="javascript:this.src=\'/Web Client/Images/control_icons/fav_delete12x12.png\';" /></span></a><a href="#" data-handler="javascript:'+sOnGoToFavPath+'" class="suwc-favs-txt"><span class="suwc-favs-dir"></span><div class="favpathtxt"><span>'+SanitizeString(aFavList[nIndex][0])+'</span><br><span style="font-size: 7pt;color:#666666;">'+SanitizeString(aFavList[nIndex][1])+'</span></div></a></li>';}}else sFavString+='<li style="text-align:center;line-height:24px;">No Favorites</li>';return(sFavString);}</script><div class="SUWCNavigationBar"><div class="SUWCNavBttns">&nbsp;<div class="SUWCNavico WC-Icon-18 WC-Icon-BackArrow" id="History-Back" title="后退"></div><div class="SUWCNavico WC-Icon-18 WC-Icon-ForwardArrow-disabled" id="History-Forward" title="前进"></div><a href="#" id="History-List" class="SUWCNavico WC-Icon-18 WC-Icon-History" title="历史记录列表"></a><a href="javascript:GoToDialog();" class="SUWCNavico WC-Icon-18 WC-Icon-GoTo" title="转到目录"></a>&nbsp;</div><div style="float:left;" class="ie6CrumbFix"><span id="CrumbBar"><div style="width:100%;"><table style="white-space:nowrap;" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td style="white-space:nowrap;" onmouseup="javascript:OnCrumbDropFile('%2F');"><a href="javascript:OnOpenCrumb('%2F');">主页</a><span id="crumb0" class=""><span class="crumbarrowico" onmouseup="javascript:BuildCrumbListing('%2F', 0);"></span></span></td></tr></tbody></table></div></span></div><div class="AdhocNavBarJumpTo"><div class="AdhocNavBarJumpToTxt" style="float:left;width:auto;">Jump to:&nbsp;&nbsp;</div><div id="AdhocNavBarJumpToList">Web 客户端<div id="AdhocNavBarJumpToIco"> </div></div></div></div><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(0=="1")?true:false;var g_bShowWC=(1=="1")?true:false;var g_bShowFVJV=(1=="1")?true:false;var g_bShowFileSharing=(1=="1")?true:false;$("#AdhocNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==4)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="/Web Client/ListDir.htm";break;case(2):location.href="/Common/FVJVLoggedIn.htm";break;case(3):location.href="/Web Client/Share/Console.htm";break;}}</script><script type="text/javascript">$(document).ready(function(){$("#History-List").contextMenu({"menu":"SUWCHistoryListMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#SUWCHistoryListMenu").html(BuildHistory());$("#SUWCHistoryListMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCHistoryListMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"History-List"})}});});function BuildHistory(){var aHistList=aCrumbHistory;var sHistString="";if(aHistList.length>=1){for(var nIndex=(aHistList.length-1);nIndex>=0;--nIndex){sOnGoToHistPath=String('OnOpenCrumb(\''+CleanPathByEscape(aHistList[nIndex][1])+'\','+nIndex+',true);');sMenuFileMove=String('OnCrumbDropFile(\''+CleanPathByEscape(aHistList[nIndex][1])+'\');');sFileName=aHistList[nIndex][0];sFileIco="suwc-favs-dir";if(sFileName=="/"){sFileName="主页";sFileIco="suwc-favs-home";}sHistString+='<li><a href="#" data-handler="javascript:'+sOnGoToHistPath+'" onmouseup="javascript:'+sMenuFileMove+'" class="suwc-favs-txt"><span class="'+sFileIco+'"></span><div class="favpathtxt"><span>'+sFileName+'</span><br><span style="font-size: 7pt;color:#666666;">'+aHistList[nIndex][1]+'</span></div></a></li>';}}else sHistString+='<li style="text-align:center;color:#666666;">$NO_HISTORY$</li>';return(sHistString);}function OnWebClientLogout(){if(g_bMultiTransferLoaded&&g_bWebClientProActive){if(IsAppletWorking()==1)OnWCPQuitPrompt(function(){location.href="/?Command=Logout";});else location.href="/?Command=Logout";}else location.href="/?Command=Logout";}</script><div class="SUWCDirhead"><img src="/Web Client/Images/folder_icon_24x24.png" class="SUWCNavico" border="0"><span id="SUWCCurrDir">主页</span><a href="javascript:DirSizeDialog();">&nbsp;<div class="SUWCDirInfoico  WC-Icon-16 WC-Icon-Info" title="目录属性"></div></a><div class="SUWCSearch" style="float:right;width:auto;"><div style="float:left;"><input class="SUWCSearchInput" id="searchinput" value="搜索" title="<div>Search in files and directories.</div><div>搜索示例</div>" style="color: rgb(149, 149, 149);" type="text"></div><div id="SearchOptionDrop" class="SUWCSearchDrop"><div class="SUWCSearchico  WC-Icon-12 WC-Icon-DropArrow" title="Search Options"></div></div><div id="searchOptionButton" class="SUWCSearchGo"><div id="Search-Action-Ico" class="SUWCSearchico  WC-Icon-18 WC-Icon-MagGlass" title="搜索"></div></div></div></div><div class="SUWCActionBar"><div class="SUWCActionBttns"><a href="#" id="UpDir-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="UpDir-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-ParentDir WC-Icon-Disabled" title="Go To Parent Directory"></div>父目录 <span class="pipedivide">|</span></a><a href="#" id="NewDir-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="NewDir-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-NewDir WC-Icon-Disabled" title="新建目录"></div>新建目录 <span class="pipedivide">|</span></a><a href="#" id="OpenDir-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="OpenDir-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-OpenDir WC-Icon-Disabled" title="打开"></div>打开 <span class="pipedivide">|</span></a><a href="#" id="Upload-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="Upload-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Upload WC-Icon-Disabled" title="上传"></div>上传 <span class="pipedivide">|</span></a><a href="#" id="Download-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="Download-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Download WC-Icon-Disabled" title="下载"></div>下载 <span class="pipedivide">|</span></a><a href="#" id="Delete-Action" style="color: rgb(144, 144, 144); cursor: default;"><div id="Delete-Action-Ico" class="SUWCActionico  WC-Icon-18 WC-Icon-Delete WC-Icon-Disabled" title="删除"></div>删除 <span class="pipedivide">|</span></a><a href="#" id="More-Action">More Actions<div class="SUWCActionico  WC-Icon-12 WC-Icon-DownArrow" title="More Actions"></div></a></div><div style="float:right;width:auto;"><a href="javascript:RefreshList(true);"><div class="SUWCActionico  WC-Icon-18 WC-Icon-Refresh" title="刷新"></div></a><a href="#" id="View-Action" title="缩略图"><div id="Thumb-Size-Img" class="SUWCActionico  WC-Icon-18 WC-Icon-Thumb"></div></a><a href="#" id="Thumb-Size-Action" style="visibility:hidden;" class="disabled"><div class="crumbico WC-Icon-10 WC-Icon-DownArrow" style="position:relative;top:3px;padding: 0 3px;"></div></a></div></div><ul id="FilesListContextMenu" style="overflow: hidden; width: auto; min-width: 150px; -moz-user-select: none; top: 378px; left: 388px; display: none; visibility: visible;" class="ui-contextmenu"><li id="rcm-NewDir" style="display: block;" class="option-divider"><a href="#" data-handler="javascript:CreateDirDialog();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-NewDir" title="新建目录"></div></span>新建目录</a></li><li id="rcm-Open" style="display: none;"><a href="#" data-handler="javascript:OnFileOpen(true);" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-OpenDir" title="打开"></div></span>打开</a></li><li id="rcm-Download" style="display: none;" class=""><a href="#" data-handler="javascript:OnFileOpenEx();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-Download" title="下载"></div></span>下载</a></li><li id="rcm-Upload" style="display: block;" class="option-divider"><a href="#" data-handler="javascript:OnAppletUpload();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-Upload" title="上传"></div></span>上传</a></li><li id="rcm-Rename" style="display: none;"><a href="#" data-handler="javascript:OnFileRename();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-Rename" title="重命名"></div></span>重命名</a></li><li id="rcm-Delete" style="display: none;" class=""><a href="#" data-handler="javascript:OnFileDelete(undefined);" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-Delete" title="删除"></div></span>删除</a></li><li id="rcm-AddToFav" style="display: block;" class="option-divider"><a href="#" data-handler="javascript:ManageFavorites(true);" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-AddFav" title="添加到收藏夹"></div></span>添加到收藏夹</a></li><li id="rcm-Properties" style="display: block;" class="option-divider"><a href="#" data-handler="javascript:GetDirProperties();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-DirProp" title="目录属性"></div></span>目录属性</a></li><li id="rcm-Slides" style="display: none;" class="option-divider"><a href="#" data-handler="javascript:OnImagePreview(true);" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-SlideShow" title="幻灯片播放"></div></span>幻灯片播放</a></li><li id="rcm-Preview" style="display: none;"><a href="#" data-handler="javascript:OnImagePreview();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-PrevImg" title="预览图像"></div></span>预览图像</a></li><li id="rcm-PlayMedia" style="display: none;"><a href="#" data-handler="javascript:OnMediaPreview();" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-PrevMedia" title="媒体播放"></div></span>媒体播放</a></li><li id="rcm-DetailsView" style="display: block;" class=""><a href="#" data-handler="javascript:OnShowHide(1);" class="ActionOption"><span class="Action-ico"><div id="rcm-DetailsViewImg" class="SUWCActionico WC-Icon-18 WC-Icon-CheckIco" style="visibility: visible;" title="详细信息"></div></span>详细信息</a></li><li id="rcm-SmallThumb" style="display: block;" class=""><a href="#" data-handler="javascript:OnShowHide(0);OnThumbSizeChange(75);" class="ActionOption"><span class="Action-ico"><div id="rcm-SmallThumbImg" class="SUWCActionico WC-Icon-18 WC-Icon-CheckIco" style="visibility: hidden;" title="Small"></div></span>Small Thumbs</a></li><li id="rcm-MediumThumb" style="display: block;"><a href="#" data-handler="javascript:OnShowHide(0);OnThumbSizeChange(150);" class="ActionOption"><span class="Action-ico"><div id="rcm-MediumThumbImg" class="SUWCActionico WC-Icon-18 WC-Icon-CheckIco" style="visibility: hidden;" title="Medium"></div></span>Medium Thumbs</a></li><li id="rcm-LargeThumb" style="display: block;"><a href="#" data-handler="javascript:OnShowHide(0);OnThumbSizeChange(250);" class="ActionOption"><span class="Action-ico"><div id="rcm-LargeThumbImg" class="SUWCActionico WC-Icon-18 WC-Icon-CheckIco" style="visibility: hidden;" title="Large"></div></span>Large Thumbs</a></li></ul><script type="text/javascript">function OnChangedSearchOpt(nOpt){$('input:radio[name=searchoptionradio]:nth('+nOpt+')').prop('checked',true);var sTitle="<div>";if(nOpt==1)sTitle+="Search in files.";else if(nOpt==2)sTitle+="Search in directories.";else sTitle+="Search in files and directories.";sTitle+="</div><div>搜索示例</div>";$("#searchinput").attr("title",sTitle);}$(document).ready(function(){OnChangedSearchOpt(0);$("#searchinput").tooltip({"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS },"items":"[title]","content":function(){var element=$(this);if(element.is("[title]"))return element.attr("title");}});$("#searchinput").focus(function(){if($("#searchinput").val()=="搜索"){$("#searchinput").val("");}$("#searchinput").css("color","#000000");});$("#searchinput").blur(function(){if($("#searchinput").val()==""){$("#searchinput").val("搜索");$("#searchinput").css("color","#959595");}});$("#searchinput").css("color","#959595");$("#View-Action").tooltip({"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS },"items":"[title]","content":function(){if(g_sViewTitle!=undefined&&g_sViewTitle!=null)return(g_sViewTitle);}});$("#searchOptionButton").click(function(){if($("#searchinput").val()!="搜索"&&$("#searchinput").val()!="")OnShowSearchDialog();else $("#searchinput").focus();});$('#searchinput').keypress(function(event){if(event.keyCode==13)OnShowSearchDialog();});$("#Thumb-Size-Action").contextMenu({"menu":"SUWCThumbOptionMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#Thumbsmall-Action-Ico").css("visibility","hidden");$("#Thumbmedium-Action-Ico").css("visibility","hidden");$("#Thumblarge-Action-Ico").css("visibility","hidden");if(g_nThumbSize==75)$("#Thumbsmall-Action-Ico").css("visibility","visible");else if(g_nThumbSize==150)$("#Thumbmedium-Action-Ico").css("visibility","visible");else if(g_nThumbSize==250)$("#Thumblarge-Action-Ico").css("visibility","visible");$("#SUWCThumbOptionMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCThumbOptionMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"Thumb-Size-Action"})}});$("#SearchOptionDrop").contextMenu({"menu":"SUWCSearchOptionMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#SUWCSearchOptionMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCSearchOptionMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"SearchOptionDrop"})}});$("#More-Action").contextMenu({"menu":"SUWCActionOptionMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#SUWCActionOptionMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#SUWCActionOptionMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"More-Action"})}});var sUserAgent=navigator.userAgent.toLowerCase();var sShowBelow="1";if((sUserAgent.indexOf('safari')!=-1)&&(sUserAgent.indexOf('chrome')==-1))sShowBelow="0";$("#ListFilesContainer").contextMenu({"menu":"FilesListContextMenu","showBelow":sShowBelow,"beforeshow":function(){$("#FilesListContextMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#FilesListContextMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"ListFilesContainer"})},"afterhide":function(){OnHideMenu({"sourceID":"ListFilesContainer"})}});$("#ThumbnailContainer").contextMenu({"menu":"FilesListContextMenu","showBelow":"0","beforeshow":function(){$("#FilesListContextMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#FilesListContextMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){OnHideMenu({"sourceID":"ThumbnailContainer"})}});});</script><div id="ListFilesContainer" data-load="true" style="overflow: hidden; margin: 0px 60px; border-left: 1px solid rgb(227, 227, 227); border-right: 1px solid rgb(227, 227, 227); display: block;"><span id="ListFiles" class="aw-system-control aw-grid-control aw-selectors-hidden " style="width: 100%; height: 7px; position: static;" tabindex="-1" hidefocus="true" oncontextmenu="AW(this,event)" onselectstart="return false" onkeydown="AW(this,event)" onmousedown="AW(this,event)"><span id="ListFiles-box" class="aw-grid-box " onactivate="AW(this,event)"><textarea id="ListFiles-box-focus" class="aw-control-focus " tabindex="0" onbeforedeactivate="AW(this,event)" onselectstart="AW(this,event)" onbeforecopy="AW(this,event)" oncut="AW(this,event)" oncopy="AW(this,event)" onpaste="AW(this,event)"></textarea><span id="ListFiles-scroll" class="aw-scroll-bars    aw-scrollbars-vertical " style="visibility: inherit;" onresize="AW(this,event)" onmousewheel="AW(this,event)"><span id="ListFiles-scroll-box" class="aw-bars-box " onscroll="AW(this,event)"><span id="ListFiles-scroll-box-spacer" class="aw-bars-spacer " style="height:74px;width:585px;"></span></span><span id="ListFiles-scroll-content" class="aw-bars-content " style="right:17px;bottom:17px;"><span id="ListFiles-view" class="aw-hpanel-template "><span id="ListFiles-view-box" class="aw-hpanel-box "><span id="ListFiles-view-box-top" class="aw-hpanel-top " style="height:20px;visibility:inherit;"><span id="ListFiles-headers" class="aw-templates-list aw-text-normal aw-grid-headers aw-header-0 " style="height:16px;"><span id="ListFiles-headers-start" class="aw-row-start " style="width:0;"></span><span id="ListFiles-header-0" class="aw-item-template aw-templates-imagetext aw-sort-ascending aw-grid-header aw-column-0 " title=""><span id="ListFiles-header-0-box" class="aw-item-box "><span id="ListFiles-header-0-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-header-0-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-header-0-box-text" class="aw-item-text ">名称<span id="ListFiles-header-0-box-text-sort" class="aw-grid-sort "></span></span></span></span><span id="ListFiles-separator-0" class="aw-grid-separator aw-resizable-true " onmousedown="AW(this,event)"></span><span id="ListFiles-header-1" class="aw-item-template aw-templates-imagetext aw-sort-none aw-grid-header aw-column-1 " title=""><span id="ListFiles-header-1-box" class="aw-item-box "><span id="ListFiles-header-1-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-header-1-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-header-1-box-text" class="aw-item-text ">大小<span id="ListFiles-header-1-box-text-sort" class="aw-grid-sort "></span></span></span></span><span id="ListFiles-separator-1" class="aw-grid-separator aw-resizable-true " onmousedown="AW(this,event)"></span><span id="ListFiles-header-2" class="aw-item-template aw-templates-imagetext aw-sort-none aw-grid-header aw-column-2 " title=""><span id="ListFiles-header-2-box" class="aw-item-box "><span id="ListFiles-header-2-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-header-2-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-header-2-box-text" class="aw-item-text ">时间<span id="ListFiles-header-2-box-text-sort" class="aw-grid-sort "></span></span></span></span><span id="ListFiles-separator-2" class="aw-grid-separator aw-resizable-true " onmousedown="AW(this,event)"></span><span id="ListFiles-headers-end" class="aw-item-template aw-grid-header aw-column-space "><span id="ListFiles-headers-end-box" class="aw-item-box "></span></span></span></span><span id="ListFiles-view-box-middle" class="aw-hpanel-middle " style="top:20px;bottom:0px;"><span id="ListFiles-rows" class="aw-templates-list aw-grid-view "><span id="ListFiles-rows-start" class="aw-view-top " style="height:0;"></span><span id="ListFiles-row-1" class="aw-templates-list aw-text-normal aw-grid-row aw-row-1 aw-rows-normal aw-alternate-even       aw-highlightit-OFF " style="color:#000000;"><span id="ListFiles-row-1-start" class="aw-row-start " style="width:0;"></span><span id="ListFiles-cell-0-1" class="aw-item-template aw-templates-imagetext aw-grid-cell aw-column-0 aw-cells-normal " title=""><span id="ListFiles-cell-0-1-box" class="aw-item-box "><span id="ListFiles-cell-0-1-box-image" class="aw-item-image aw-image-DirExt "></span><span id="ListFiles-cell-0-1-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-cell-0-1-box-text" class="aw-item-text ">开业申请与审核</span></span></span><span id="ListFiles-cell-1-1" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-1 aw-cells-normal " title=""></span><span id="ListFiles-cell-2-1" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-2 aw-cells-normal " title="">2016/7/29 下午3:15:50</span><span id="ListFiles-row-1-end" class="aw-item-template aw-grid-cell aw-column-space "><span id="ListFiles-row-1-end-box" class="aw-item-box "></span></span></span><span id="ListFiles-row-0" class="aw-templates-list aw-text-normal aw-grid-row aw-row-0 aw-rows-current aw-alternate-odd aw-highlightit-OFF " style="color:#000000;"><span id="ListFiles-row-0-start" class="aw-row-start " style="width:0;"></span><span id="ListFiles-cell-0-0" class="aw-item-template aw-templates-imagetext aw-grid-cell aw-column-0 aw-cells-normal " title=""><span id="ListFiles-cell-0-0-box" class="aw-item-box "><span id="ListFiles-cell-0-0-box-image" class="aw-item-image aw-image-xlsExt "></span><span id="ListFiles-cell-0-0-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-cell-0-0-box-text" class="aw-item-text ">003中心开业倒计时表模板.xls</span></span></span><span id="ListFiles-cell-1-0" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-1 aw-cells-normal " title="">89.5 KB</span><span id="ListFiles-cell-2-0" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-2 aw-cells-normal " title="">2016/7/29 上午11:17:07</span><span id="ListFiles-row-0-end" class="aw-item-template aw-grid-cell aw-column-space "><span id="ListFiles-row-0-end-box" class="aw-item-box "></span></span></span><span id="ListFiles-row-2" class="aw-templates-list aw-text-normal aw-grid-row aw-row-2 aw-rows-normal aw-alternate-even      aw-highlightit-OFF " style="color:#000000;"><span id="ListFiles-row-2-start" class="aw-row-start " style="width:0;"></span><span id="ListFiles-cell-0-2" class="aw-item-template aw-templates-imagetext aw-grid-cell aw-column-0 aw-cells-normal " title=""><span id="ListFiles-cell-0-2-box" class="aw-item-box "><span id="ListFiles-cell-0-2-box-image" class="aw-item-image aw-image-docxExt "></span><span id="ListFiles-cell-0-2-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-cell-0-2-box-text" class="aw-item-text ">绿地缤纷城中心开业市场推广方案-供参考.docx</span></span></span><span id="ListFiles-cell-1-2" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-1 aw-cells-normal " title="">33.2 KB</span><span id="ListFiles-cell-2-2" class="aw-item-template aw-templates-cell aw-grid-cell aw-column-2 aw-cells-normal " title="">2016/7/29 上午11:17:07</span><span id="ListFiles-row-2-end" class="aw-item-template aw-grid-cell aw-column-space "><span id="ListFiles-row-2-end-box" class="aw-item-box "></span></span></span><span id="ListFiles-rows-end" class="aw-item-template aw-row-selector aw-selector-space "><span id="ListFiles-rows-end-box" class="aw-item-box "></span></span></span></span><span id="ListFiles-view-box-bottom" class="aw-hpanel-bottom " style="height:0px;display:none;"><span id="ListFiles-footers" class="aw-templates-list aw-text-normal aw-grid-footers aw-footer-0 " style="height:16px;"><span id="ListFiles-footers-start" class="aw-row-start " style="width:0;"></span><span id="ListFiles-footer-0" class="aw-item-template aw-templates-imagetext aw-grid-footer aw-column-0 " title=""><span id="ListFiles-footer-0-box" class="aw-item-box "><span id="ListFiles-footer-0-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-footer-0-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-footer-0-box-text" class="aw-item-text "></span></span></span><span id="ListFiles-footer-1" class="aw-item-template aw-templates-imagetext aw-grid-footer aw-column-1 " title=""><span id="ListFiles-footer-1-box" class="aw-item-box "><span id="ListFiles-footer-1-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-footer-1-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-footer-1-box-text" class="aw-item-text "></span></span></span><span id="ListFiles-footer-2" class="aw-item-template aw-templates-imagetext aw-grid-footer aw-column-2 " title=""><span id="ListFiles-footer-2-box" class="aw-item-box "><span id="ListFiles-footer-2-box-image" class="aw-item-image aw-image-none "></span><span id="ListFiles-footer-2-box-ruler" class="aw-item-ruler "></span><span id="ListFiles-footer-2-box-text" class="aw-item-text "></span></span></span><span id="ListFiles-footers-end" class="aw-item-template aw-grid-cell aw-column-space "><span id="ListFiles-footers-end-box" class="aw-item-box "></span></span></span></span></span></span></span></span><span id="ListFiles-box-sample" class="aw-row-sample aw-grid-row "></span></span></span></div><div id="ThumbnailContainer" style="display:none;margin: 0 60px;border:1px solid #e3e3e3;"><div class="thumbpane" id="thumbpanebox" style="height: 7px; padding: 0px 0px 2px;"><ol id="ThumbListFiles" class="thumb-selectable scheduled-task"></ol></div></div><div id="repaintFix"></div><div class="SUWCFooterTaskBar"><div id="WCP-Load" style="float:left;width:auto;display:none;"> <img src="/Web Client/Images/WCP-loading.gif" class="wcploadico" alt="Loading" border="0"> <a href="javascript:DestroyMultiTransPane();">Cancel loading Web Client Pro...</a></div><div id="WC-Search-Info" style="float:left;width:auto;padding-left:5px;"></div><div style="float:right;width:auto;"><span id="SearchResult-txt" style="display:none;">搜索结果: &nbsp;&nbsp;&nbsp;&nbsp;</span>目录: <span id="TotalDirs">1</span> &nbsp;&nbsp; 文件: <span id="TotalFiles">2</span> &nbsp;&nbsp; 大小: <span id="TotalSize">122.7 KB</span></div></div><script type="text/javascript" language="javascript">function OnSetFileLabelNoneImage(){if(g_FileActionLabelOption==2)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetFileLabelAllImage(){if(g_FileActionLabelOption==0)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetFileLabelSelectedImage(){if(g_FileActionLabelOption==1)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetPageLabelNoneImage(){if(g_PageActionLabelOption==2)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetPageLabelAllImage(){if(g_PageActionLabelOption==0)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetPageLabelSelectedImage(){if(g_PageActionLabelOption==1)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function FileActionLabelSet(nOption){g_FileActionLabelOption=nOption;BuildFileActionButton((g_nShowList==0)?-1:FilesList.getSelectedRows());SetCurrentDirOnPage(g_bCurrentIsDrive,true);}function PageActionLabelSet(nOption){g_PageActionLabelOption=nOption;BuildFileActionButton((g_nShowList==0)?-1:FilesList.getSelectedRows());SetCurrentDirOnPage(g_bCurrentIsDrive,true);}var sOnAllLabels=String("OnTextLabelOptions(0");var sOnSelectiveLabels=String("OnTextLabelOptions(1");var sOnNoLabels=String("OnTextLabelOptions(2");var asFunctions=[sOnNoLabels,sOnAllLabels,sOnSelectiveLabels];var asNames=["无文本标签","显示文本标签","右侧选择性文本"];var asFileActionImages=[OnSetFileLabelNoneImage,OnSetFileLabelAllImage,OnSetFileLabelSelectedImage];var asPageActionImages=[OnSetPageLabelNoneImage,OnSetPageLabelAllImage,OnSetPageLabelSelectedImage];function OnTextLabelOptions(nOption,sCookie,fLabelFunction){createCookie(sCookie,nOption,60);fLabelFunction(nOption);}</script><div id="panesplitter" class="spliter-slide" style="display:none;overflow:hidden;">&nbsp;</div><div id="BottomPaneDivID" style="height: 0px; overflow: hidden; background-image: url(&quot;/Common/Images/blank.gif&quot;);"></div><!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// End of HTML ///////////////////////////////////////////////////////////////////////////////////////////// --><script type="text/javascript" language="javascript">if(readCookie("multitransbubbletip")!="false"&&readCookie("multitrans")!="1")bShowMultiTransferCookie=true;function LaunchMultiTranferApplet(){g_bAppletIsLoading=true;var sInsertAppletTag=null;AnimateMultiTranIcon(true);ShowBottomPane();document.getElementById(g_sBottomPaneDivID).innerHTML='<iframe id="'+g_sAppletFrameID+'" src="http://vi.gymbaby.cn/Common/Java/WebClientPro.htm" width="620px" height="420px" frameborder="0" scrolling="no" align="middle" style="width:100%;height:100%;"></iframe>';}function DestroyMultiTransPane(){AnimateMultiTranIcon(false);if(document.getElementById(g_sBottomPaneDivID)!=undefined)m_nInitialHeightOfTransferPane=document.getElementById(g_sBottomPaneDivID).style.height;else m_nInitialHeightOfTransferPane=0;if(!g_bMultiTransferLoaded)document.getElementById(g_sBottomPaneDivID).innerHTML="";else{ToggleApplet(true,false,false,true);}$("#repaintFix").append("<div></div>");window.setTimeout(function(){$("#repaintFix").empty();},100);g_bWebClientProActive=false;g_bAppletIsLoading=false;$("#ThumbListFiles").selectable("destroy");$("#ThumbListFiles li.ui-selected:first").siblings().removeClass("ui-selected");FilesList.setRowSelected(false);FilesList.setRowState("");FilesList.setCurrentRow(0);FilesList.setSelectedRows([-1]);FilesList.setSelectionMode("single-row");OnEnableDisableTransModButton(false);if((navigator.userAgent.toLowerCase().indexOf('ubuntu')!=-1&&navigator.userAgent.toLowerCase().indexOf('firefox')!=-1)){g_bMultiTransferLoaded=false;document.getElementById(g_sBottomPaneDivID).innerHTML="";}}function OnPageLoadMultiTransConfig(){if(readCookie("multitrans")=="1"||g_bLaunchWCPOnStart||0){OnEnableDisableTransModButton(false);OnEnableDisableTransMod();}else OnEnableDisableTransModButton(false);}function OnShowMultiTransferBubbleTip(){var xPointOffSet,yPointOffSet;if(AW.gecko){xPointOffSet=-72;yPointOffSet=-15;}if(AW.ie){xPointOffSet=-68;yPointOffSet=-13;}if(AW.chrome){xPointOffSet=-70;yPointOffSet=-15;}if(AW.safari){xPointOffSet=-72;yPointOffSet=-15;}if(AW.opera){xPointOffSet=-72;yPointOffSet=-15;}if(bShowMultiTransferCookie&&readCookie("multitrans")!="1"&&g_bAllowWebClientPro){BusyDialog(false,undefined,true);bShowMultiTransferCookie=false;createCookie("multitransbubbletip","false",60);}}</script><div class="taskbar" id="MultiTransTaskbar" style="display:none;"><table id="WebClientProLabelContainer" style="width:100%;white-space:nowrap;" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="leftdivider" style="padding-left:15px;text-align:left;white-space:nowrap;vertical-align:middle;height:26px;"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td style="width:20px;white-space:nowrap;" id="showinfolderimg"><a href="javascript:OnTransferShowInFolder();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferShowInFolder_disabled " title="在文件夹中显示"></div></a></td><td style="white-space: nowrap; display: none;" id="showinfolderbtn"><a href="javascript:OnTransferShowInFolder();" class="highlightbuttonbox">在文件夹中显示</a></td><td style="width:20px;white-space:nowrap;" id="openfileimg"><a href="javascript:OnTransferOpenFile();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferOpenFile_disabled " title="打开文件"></div></a></td><td style="white-space: nowrap; display: none;" id="openfilebtn"><a href="javascript:OnTransferOpenFile();" class="highlightbuttonbox">打开文件</a></td><td style="white-space:nowrap;width:12px;" id="Open-DivCell"><span id="OpenDiv"><span class="dividerline">&nbsp;</span></span></td><td style="width:20px;white-space:nowrap;" id="stopimg"><a href="javascript:OnTransferStopAfter();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferStopped_disabled " title="文件完成传输后停止"></div></a></td><td style="white-space: nowrap;" id="stopbtn"><a href="javascript:OnTransferStopAfter();" class="highlightbuttonbox">文件完成传输后停止</a></td><td style="white-space:nowrap;width:12px;" id="Stop-DivCell">
<span id="StopDiv"><span class="dividerline">&nbsp;</span></span></td><td style="width:20px;white-space:nowrap;" id="skipimg"><a href="javascript:OnTransferSkip();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferSkipped_disabled " title="跳过文件"></div></a></td><td style="white-space: nowrap; display: none;" id="skipbtn"><a href="javascript:OnTransferSkip();" class="highlightbuttonbox">跳过文件</a></td><td style="width:20px;white-space:nowrap;" id="pausetransimg"><a href="javascript:OnTransferPause();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferPaused_disabled " title="暂停"></div></a></td><td style="white-space: nowrap; display: none;" id="pausetransbtn"><a href="javascript:OnTransferPause();" class="highlightbuttonbox">暂停</a></td><td style="width:20px;white-space:nowrap;" id="resumeimg"><a href="javascript:OnTransferResume();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferResume_disabled " title="续传"></div></a></td><td style="white-space: nowrap; display: none;" id="resumebtn"><a href="javascript:OnTransferResume();" class="highlightbuttonbox">续传</a></td><td style="width:20px;white-space:nowrap;" id="startimg"><a href="javascript:OnTransferStart();" class="highlightimagebox"><div id="startimgico" class="WC-Icon-18 WC-Icon-WCP WCP-TransferStart_disabled " title="开始"></div></a></td><td style="white-space: nowrap; display: none;" id="startbtn"><a id="startbtnhref" href="javascript:OnTransferStart();" class="highlightbuttonbox">开始</a></td><td style="width:20px;white-space:nowrap;" id="restartimg"><a href="javascript:OnTransferRestart();" class="highlightimagebox"><div id="restartimgico" class="WC-Icon-18 WC-Icon-WCP WCP-TransferRestart_disabled " title="重启"></div></a></td><td style="white-space: nowrap; display: none;" id="restartbtn"><a id="restartbtnhref" href="javascript:OnTransferRestart();" class="highlightbuttonbox">重启</a></td><td style="width:20px;white-space:nowrap;" id="cancelimg"><a href="javascript:OnTransferCancel();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferCancelled_disabled " title="取消"></div></a></td><td style="white-space: nowrap;" id="cancelbtn"><a href="javascript:OnTransferCancel();" class="highlightbuttonbox">取消</a></td><td style="white-space:nowrap;width:12px;" id="CancelImg-DivCell"><span id="ImgCancelDiv"><span class="dividerline">&nbsp;</span></span></td><td style="width:20px;white-space:nowrap;" id="removeimg"><a href="javascript:OnTransferRemove();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferDelete_disabled " title="删除"></div></a></td><td style="white-space: nowrap;" id="removebtn"><a href="javascript:OnTransferRemove();" class="highlightbuttonbox">删除</a></td><td style="white-space:nowrap;width:12px;" id="RemoveCompleteImg-DivCell"><span id="ImgRemoveCompleteDiv"><span class="dividerline">&nbsp;</span></span></td><td style="width:20px;white-space:nowrap;" id="removecompletedimg"><a href="javascript:OnTransferRemoveCompleted();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferDoneRemoveAll_disabled " title="删除已完成任务"></div></a></td><td style="white-space: nowrap; display: none;" id="removecompletedbtn"><a href="javascript:OnTransferRemoveCompleted();" class="highlightbuttonbox">删除已完成任务</a></td><td style="width:20px;white-space:nowrap;" id="removestoppedimg"><a href="javascript:OnTransferRemoveStopped();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAllStopped_disabled " title="删除已停止的操作"></div></a></td><td style="white-space: nowrap; display: none;" id="removestoppedbtn"><a href="javascript:OnTransferRemoveStopped();" class="highlightbuttonbox">删除已停止的操作</a></td><td style="width:20px;white-space:nowrap;" id="removeskippedimg"><a href="javascript:OnTransferRemoveSkipped();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAllSkipped_disabled " title="删除已跳过的操作"></div></a></td><td style="white-space: nowrap; display: none;" id="removeskippedbtn"><a href="javascript:OnTransferRemoveSkipped();" class="highlightbuttonbox">删除已跳过的操作</a></td><td style="width:20px;white-space:nowrap;" id="removepausedimg"><a href="javascript:OnTransferRemovePaused();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAllPaused_disabled " title="删除已暂停的操作"></div></a></td><td style="white-space: nowrap; display: none;" id="removepausedbtn"><a href="javascript:OnTransferRemovePaused();" class="highlightbuttonbox">删除已暂停的操作</a></td><td style="width:20px;white-space:nowrap;" id="removewaitingimg"><a href="javascript:OnTransferRemoveWaiting();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAllWaiting_disabled " title="删除正在等候的操作"></div></a></td><td style="white-space: nowrap; display: none;" id="removewaitingbtn"><a href="javascript:OnTransferRemoveWaiting();" class="highlightbuttonbox">删除正在等候的操作</a></td><td style="width:20px;white-space:nowrap;" id="removecancelledimg"><a href="javascript:OnTransferRemoveCancelled();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAllCancelled_disabled " title="已取消删除"></div></a></td><td style="white-space: nowrap; display: none;" id="removecancelledbtn"><a href="javascript:OnTransferRemoveCancelled();" class="highlightbuttonbox">已取消删除</a></td><td style="width:20px;white-space:nowrap;" id="removeallimg"><a href="javascript:OnTransferRemoveAll();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferRemoveAll_disabled " title="全部删除"></div></a></td><td style="white-space: nowrap;" id="removeallbtn"><a href="javascript:OnTransferRemoveAll();" class="highlightbuttonbox">全部删除</a></td><td style="white-space:nowrap;width:12px;" id="RemoveCancelledImg-DivCell"><span id="ImgRemoveCancelledDiv"><span class="dividerline">&nbsp;</span></span></td><td style="width:20px;white-space:nowrap;" id="optionsimg"><a href="javascript:OnShowOptionsDlg();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferOptions" title="选项"></div></a></td><td style="white-space: nowrap; display: none;" id="optionsbtn"><a href="javascript:OnShowOptionsDlg();" class="highlightbuttonbox">选项</a></td><td style="width:20px;white-space:nowrap;" id="imgabout"><a href="javascript:OnShowAboutDlg();" class="highlightimagebox"><div class="WC-Icon-18 WC-Icon-WCP WCP-TransferAbout" title="关于"></div></a></td><td style="white-space: nowrap; display: none;" id="aboutbtn"><a href="javascript:OnShowAboutDlg();" class="highlightbuttonbox">关于</a></td></tr></tbody></table></td></tr></tbody></table></div><script type="text/javascript" language="javascript">if(AW.ms11||AW.ie||AW.chrome){$(".taskbar").tooltip({position:{my:"right-5px center-3px",},track:false,"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS }});}function WebClientProLabels(){var sShowHideDefault="";var DefaultDivCell="12px";var sDefaultDivider='<span class="dividerline">&nbsp;</span>';var sShowHideSelective="";var SelectiveDivCell="12px";var sSelectiveDivider='<span class="dividerline">&nbsp;</span>';if(g_WebClientProLabelOption==1||g_WebClientProLabelOption==2){sShowHideDefault="none";DefaultDivCell="0";sDefaultDivider='';}if(g_WebClientProLabelOption==2){sShowHideSelective="none";SelectiveDivCell="0";sSelectiveDivider='';}document.getElementById("stopbtn").style.display=sShowHideSelective;document.getElementById("skipbtn").style.display=sShowHideDefault;document.getElementById("pausetransbtn").style.display=sShowHideDefault;document.getElementById("resumebtn").style.display=sShowHideDefault;document.getElementById("startbtn").style.display=sShowHideDefault;document.getElementById("restartbtn").style.display=sShowHideDefault;document.getElementById("cancelbtn").style.display=sShowHideSelective;document.getElementById("removebtn").style.display=sShowHideSelective;document.getElementById("removecompletedbtn").style.display=sShowHideDefault;document.getElementById("optionsbtn").style.display=sShowHideDefault;document.getElementById("aboutbtn").style.display=sShowHideDefault;document.getElementById("removecancelledbtn").style.display=sShowHideDefault;document.getElementById("showinfolderbtn").style.display=sShowHideDefault;document.getElementById("openfilebtn").style.display=sShowHideDefault;document.getElementById("removestoppedbtn").style.display=sShowHideDefault;document.getElementById("removeskippedbtn").style.display=sShowHideDefault;document.getElementById("removepausedbtn").style.display=sShowHideDefault;document.getElementById("removewaitingbtn").style.display=sShowHideDefault;document.getElementById("removeallbtn").style.display=sShowHideSelective;}function OnSetWCPLabelNoneImage(){if(g_WebClientProLabelOption==2)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetWCPLabelAllImage(){if(g_WebClientProLabelOption==0)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function OnSetWCPLabelSelectedImage(){if(g_WebClientProLabelOption==1)sImageClass="MenuOptionSelected";else sImageClass="";return(sImageClass);}function WebClientProLabelSet(nOption){g_WebClientProLabelOption=nOption;WebClientProLabels();}var sWebClientProOnAllLabels=String("OnTextLabelOptions(0");var sWebClientProOnSelectiveLabels=String("OnTextLabelOptions(1");var sWebClientProOnNoLabels=String("OnTextLabelOptions(2");var asWebClientProFunctions=[sOnNoLabels,sOnAllLabels,sOnSelectiveLabels];var asWebClientProNames=["无文本标签","显示文本标签","右侧选择性文本"];var asWebClientProImages=[OnSetWCPLabelNoneImage,OnSetWCPLabelAllImage,OnSetWCPLabelSelectedImage];CreateRightClickMenu(asWebClientProFunctions,asWebClientProNames,asWebClientProImages,["WebClientProLabelContainer"],"clientlabels-webclientpro",WebClientProLabelSet,"webclientLabels");WebClientProLabels();if(g_bDisableBranding){document.getElementById("imgabout").style.display="none";document.getElementById("aboutbtn").style.display="none";}</script><script type="text/javascript" language="javascript">var g_sCurrentDir,g_sHomeDir,g_sPreviousDir,g_sCurrentDirRelative;var g_nShowList=1;var g_bBuildThumbnails=true;var g_bFileFromListRemoved=false;var fmtBWCFileString=new AW.Formats.BWCFileString;var fmtFilesize=new AW.Formats.Filesize;var fmtDate=new AW.Formats.LocaleDate;var fmtXMLString=new AW.Formats.XMLString;var g_nThumbSize=100;var g_nThumbnailIter=0;var g_nThumbRestart=false;var g_bPauseThumbnails=false;var g_nRestartPosition=0;var g_RetryAttempts=0;var g_MaxRetryAttempts=2;var g_nCopyTotalDirs=0;var g_nCopyTotalFiles=0;var g_nPreviewThumbSizeWidth="600";var g_nPreviewThumbSizeHeight="450";var g_nCurrentPreviewImage=0;var g_nOriginalListSize=0;var g_sCurrentDirDriveType=-1;var g_sCurrentDirDriveLabel=-1;var g_bFoundDrive=false;var g_bCurrentDirCanUpload=0;var g_bCurrentDirCanCreate=0;var g_sListDirURL="/Web Client/ListError.xml?Command=List&Dir=";var g_bDoSlideshowOnload=false;var g_bDoPlaylistOnload=false;var g_bDoPlayMediaOnload=false;var g_bHaveMediaFile=false;var g_sCurrentDirMDate="";var g_sCurrentDirCDate="";var g_sCurrentDirADate="";var g_bCurrentIsDrive=false;var g_nInitSortCol=0;var g_bLaunchWCPOnStart=false;if(GetURLParameter("thumbnail")=="1")g_nShowList=0;if(GetURLParameter("slideshow")=="1")g_bDoSlideshowOnload=true;else if(GetURLParameter("playlist")=="1"&&g_bAllowHTTPMediaPlayback==1)g_bDoPlaylistOnload=true;else if(GetURLParameter("playmedia")=="1"&&g_bAllowHTTPMediaPlayback==1){g_bDoPlayMediaOnload=true;if(GetURLParameter("file"))g_bHaveMediaFile=true;}if(GetURLParameter("wcp")=="1")g_bLaunchWCPOnStart=true;var nSortColCheck=GetURLParameter("sortcol");if(parseInt(nSortColCheck)>=1&&parseInt(nSortColCheck)<=3)g_nInitSortCol=(nSortColCheck-1);sURLDirParam=GetURLParameter("Dir");if((sURLDirParam.substring(0,1).toLowerCase()!="/")&&(sURLDirParam.substring(0,3).toLowerCase()!="%2f")&&sURLDirParam!="~")sURLDirParam="~/"+sURLDirParam;g_sHomeDir=sURLDirParam;if(readCookie("thumbsize")!=""&&readCookie("thumbsize")!=null){g_nThumbSize=parseInt(readCookie("thumbsize"));sThumbControlText=g_nThumbSize+" x "+g_nThumbSize;sThumbControlValue=g_nThumbSize;}else{sThumbControlText="100 x 100";sThumbControlValue=100;}if(g_sHomeDir==""||g_sHomeDir==undefined)g_sHomeDir=encodeURI("~");if(g_sCurrentDir==""||g_sCurrentDir==undefined)g_sCurrentDir=g_sHomeDir;g_sPreviousDir=g_sCurrentDir;var FilesList=CreateBasicGrid("ListFiles",["名称","大小","时间"],[275,100,210],"","files",OnFileOpen);CreateDragandDrop(FilesList);var anDim=GetScreenDim(4,15);w_NewHeight=anDim[1];nFileListHeight=(w_NewHeight-220);SetFilesListHeight(nFileListHeight);FilesList.setSelectionMode("single-row");FilesList.setCellFormat([fmtBWCFileString,fmtFilesize,fmtDate,fmtXMLString]);FilesList.getCellImage=function(nColumn,nRow){return(GetFileImage.call(this,this.getCellText(nColumn,nRow),nColumn,nRow));};FilesList.defineRowProperty("color",function(nRow){if(g_bSearchView){if(parseInt(this.getCellData(13,nRow)))return("blue");else if(parseInt(this.getCellData(14,nRow)))return("#13920d");else return("#000000");}else{if(parseInt(this.getCellData(12,nRow)))return("blue");else if(parseInt(this.getCellData(13,nRow)))return("#13920d");else return("#000000");}});FilesList.getRowTemplate().setStyle("color",function(){return this.getRowProperty("color");});FilesList.m_fnPostUpdate=function(){OnListDone.call(this,false);};function OnFileOpenEnterKey(){var anSelectedRows=FilesList.getSelectedRows();if(anSelectedRows!=-1)OnFileOpen();}FilesList.onKeyEnter=OnFileOpenEnterKey;FilesList.onKeyDelete=OnFileDelete;FilesList.onSelectedRowsChanged=function(nRow){BuildFileActionButton(nRow);};FilesList.setSortColumn(g_nInitSortCol);FilesList.setSortDirection("ascending",g_nInitSortCol);FilesList.onHeaderClickedRes=FilesList.onHeaderClicked;FilesList.onHeaderClicked=function(Event,nIndex){BusyDialog(true,"排序",true);g_bBuildThumbnails=true;this.setTimeout(function(Event,nIndex){this.onHeaderClickedRes(Event,nIndex);BusyDialog(false,undefined,true);},0);};function CheckFileListFocus(){if(g_nShowList!=0)FilesList.element().focus();}function IsRowDirOrDrive(nRowIndex){var bIsDir=(parseInt(FilesList.getCellValue(4,nRowIndex))==1||parseInt(FilesList.getCellText(4,nRowIndex))==1)?true:false;var bIsDrive=(parseInt(FilesList.getCellValue(7,nRowIndex))==1||parseInt(FilesList.getCellText(7,nRowIndex))==1)?true:false;return((bIsDir)||(bIsDrive));}function IsRowImageFile(nRowIndex){return((g_nShowList==1&&FilesList.getCellValue(5,nRowIndex)==1)||(g_nShowList==0&&$('#ThumbListFiles li.ui-selected[data-fileisimage="1"]').length>=1));}function IsRowMediaFile(nRowIndex){return((g_nShowList==1&&(FilesList.getCellValue(10,nRowIndex)==1||FilesList.getCellValue(11,nRowIndex)==1))||(g_nShowList==0&&($('#ThumbListFiles li.ui-selected[data-fileisaudio="1"]').length>=1||$('#ThumbListFiles li.ui-selected[data-fileisvideo="1"]').length>=1)));}function OnGridContextMenu(event,FilesListObj){var nContextMenuState=CONTEXT_MENU_GRID_NOTHING_SELECTED;var bIsRowImageFile=false;var bIsRowMediaFile=false;if(FilesListObj.getSelectedRows().length>0&&FilesListObj.getSelectedRows()[0]!=-1){if(FilesListObj.getSelectedRows().length==1){if(IsRowDirOrDrive(FilesListObj.getSelectedRows()[0]))nContextMenuState=CONTEXT_MENU_GRID_FOLDER_SELECTED;else nContextMenuState=CONTEXT_MENU_GRID_FILE_SELECTED;bIsRowImageFile=IsRowImageFile(FilesListObj.getSelectedRows()[0]);bIsRowMediaFile=IsRowMediaFile(FilesListObj.getSelectedRows()[0]);}else{nContextMenuState=CONTEXT_MENU_GRID_MIXED_SELECTION;}}FormatGridContextMenu(nContextMenuState,bIsRowImageFile,bIsRowMediaFile);showContextMenu(event,"FilesListContextMenu",FilesListObj,undefined,event.clientX,event.clientY);}FilesList.setEvent("oncontextmenu",function(e){if(navigator.userAgent.match("Linux")){setTimeout(function(){OnGridContextMenu(e,FilesList);},300);}else OnGridContextMenu(e,FilesList);});function OnThumbsContextMenu(e){var bRightClick;var ActionEvent=(window.event)?event:e;if(ActionEvent.which)bRightClick=(ActionEvent.which==3);else if(ActionEvent.button)bRightClick=(ActionEvent.button==2);if(bRightClick){var nContextMenuState=CONTEXT_MENU_GRID_NOTHING_SELECTED;var nNumSelectedItems=$("#ThumbnailContainer li.ui-selected").length;if(nNumSelectedItems>0){if(nNumSelectedItems==1){if((parseInt($($("#ThumbListFiles li.ui-selected")[0]).attr("data-fileisdir"))==1)||(parseInt($($("#ThumbListFiles li.ui-selected")[0]).attr("data-fileisdrive"))==1))nContextMenuState=CONTEXT_MENU_GRID_FOLDER_SELECTED;else nContextMenuState=CONTEXT_MENU_GRID_FILE_SELECTED;}else{nContextMenuState=CONTEXT_MENU_GRID_MIXED_SELECTION;}}FormatGridContextMenu(nContextMenuState);showContextMenu(ActionEvent,"FilesListContextMenu",document.getElementById("ThumbnailContainer"),true,undefined,ActionEvent.clientY);}}function CheckThumbPaneBoxWhitespaceClick(event){var thumbpanebox=document.getElementById("thumbpanebox");var originalTarget=event.target||event.srcElement||event.originalTarget;if(thumbpanebox==originalTarget&&(event.clientX<thumbpanebox.offsetLeft+thumbpanebox.clientWidth)){$("#ThumbListFiles li.ui-selected").each(function(){$(this).removeClass("ui-selected");});}}FilesList.setController("copypaste",{});if(!g_bFireFox3Browser){FilesList.setEvent("onkeydown",function(e){var EventKeyCode=(window.event)?event.keyCode:e.keyCode;var MenuKey=(window.event)?93:e.DOM_VK_CONTEXT_MENU;if(EventKeyCode==MenuKey)OnGridContextMenu(e,FilesList);});}$(document).ready(function(){FilesList.m_fnOnViewClicked=function(nMouseX,nMouseY){FilesList.setSelectedRows([-1]);};if(document.attachEvent){document.getElementById("ThumbnailContainer").attachEvent("onmousedown",CheckThumbPaneBoxWhitespaceClick);document.getElementById("ThumbnailContainer").attachEvent("onmousedown",OnThumbsContextMenu);}else{document.getElementById("ThumbnailContainer").addEventListener("mousedown",CheckThumbPaneBoxWhitespaceClick,false);document.getElementById("ThumbnailContainer").addEventListener("mousedown",OnThumbsContextMenu,false);}if(!g_bAllowWebClientPro){$("#SUWCToolsListMenu li a").addClass('ui-state-disabled');$("#SUWCToolsListMenu li a").removeAttr("data-handler");}else{$("#SUWCToolsListMenu li a").removeClass('ui-state-disabled');$("#SUWCToolsListMenu li a").attr("data-handler","javascript:OnEnableDisableTransMod();");}});function OnListDone(bBypassForWCP){var xmlDoc=this.m_XMLTable.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"ErrorResponse");var sResultText=GetXMLValue(xmlDoc,"ResultText");if(!bBypassForWCP){if(g_bSearchView){g_aHistory.pop();g_aHistoryIcon.pop();g_aHistoryNames.pop();g_aHistoryActive.pop();}}else{nResult=g_nSessionOkay;}g_bSearchView=false;g_bGetNewScrollImages=true;if(nResult!=g_nSessionOkay){g_nShowList=1;g_bDoSlideshowOnload=false;g_bDoPlaylistOnload=false;g_bDoPlayMediaOnload=false;if(nResult!=31){if(g_sPreviousDir==g_sCurrentDir)g_sCurrentDir=encodeURI("~");else g_sCurrentDir=g_sPreviousDir;g_RetryAttempts++;if(g_RetryAttempts<g_MaxRetryAttempts)setTimeout("OnPreviousDir()",500);else if(g_RetryAttempts==g_MaxRetryAttempts){g_sCurrentDir=encodeURI("~");setTimeout("OnPreviousDir()",500);}}LoadingDialog(false,true);if(nResult==31)AlertDialog(GetResultText(0,"",sResultText),undefined,OnWebClientLogout,true);else AlertDialog(GetResultText(0,"",sResultText),undefined,undefined,true);OnKillSlideShow();}else{if(!bBypassForWCP){g_nTotalDirs=this.m_XMLTable.selectNodes("//file[FileIsDir=1]").length;g_nTotalImages=this.m_XMLTable.selectNodes("//file[FileIsImage=1]").length;nTotalVideo=this.m_XMLTable.selectNodes("//file[FileIsVideo=1]").length;g_nTotalAudio=this.m_XMLTable.selectNodes("//file[FileIsAudio=1]").length;g_nTotalMedia=(parseInt(nTotalVideo)+parseInt(g_nTotalAudio));g_nTotalFiles=(this.m_XMLTable.getCount()-g_nTotalDirs);g_bFoundDrive=(this.m_XMLTable.selectNodes("//file[FileIsDrive=1]").length>0);for(var nIndex=0;nIndex<this.getRowCount();nIndex++)g_nTotalSize+=this.getCellValue(1,nIndex);document.getElementById("TotalFiles").innerHTML=FormatNumberCommas(g_nTotalFiles,true);document.getElementById("TotalDirs").innerHTML=FormatNumberCommas(g_nTotalDirs,true);document.getElementById("TotalSize").innerHTML=FormatFileSize(g_nTotalSize,true);g_nCopyTotalDirs=g_nTotalDirs;g_nCopyTotalFiles=g_nTotalFiles;g_nTotalDirs=0;g_nTotalFiles=0;g_nCurrentPreviewImage=0;}g_RetryAttempts=0;if(!bBypassForWCP){FilesList.setCurrentRow(0);FilesList.setSelectedRows([-1]);}g_sCurrentDir=GetXMLValue(xmlDoc,"CurrentDir",true);if((g_bMultiTransferLoaded)&&(g_bWebClientProActive)&&(!bBypassForWCP))document.getElementById(g_sAppletFrameID).contentWindow.OnAppletSetWorkingDir(g_sCurrentDir);g_bCurrentDirIsHome=(GetXMLValueInt(xmlDoc,"CurrentDirIsHome")!=0)?true:false;g_bCurrentDirCanUpload=GetXMLValue(xmlDoc,"CurrentDirCanUpload");g_bCurrentDirCanCreate=GetXMLValue(xmlDoc,"CurrentDirCanCreate");g_bAllowHTTPMediaPlayback=GetXMLValueInt(xmlDoc,"AllowMediaPlayback");var bIsDrive=GetXMLValue(xmlDoc,"CurrentDirIsDrive");g_bCurrentIsDrive=bIsDrive;if(bIsDrive!=0){g_sCurrentDirDriveType=GetXMLValue(xmlDoc,"CurrentDirDriveType");g_sCurrentDirDriveLabel=GetXMLValue(xmlDoc,"CurrentDirDriveLabel");}else{g_sCurrentDirDriveType=-1;g_sCurrentDirDriveLabel=-1;}var sCurrentDirMDate=GetXMLValueInt(xmlDoc,"CurrentDirMDate");var sCurrentDirCDate=GetXMLValueInt(xmlDoc,"CurrentDirCDate");var sCurrentDirADate=GetXMLValueInt(xmlDoc,"CurrentDirADate");var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();if((AW.ie)&&(parseInt(navigator.appVersion)>=4)){g_sCurrentDirMDate=VBDateFormat(sCurrentDirMDate,nTimeZoneOffset);g_sCurrentDirCDate=VBDateFormat(sCurrentDirCDate,nTimeZoneOffset);g_sCurrentDirADate=VBDateFormat(sCurrentDirADate,nTimeZoneOffset);}else{g_sCurrentDirMDate=FormatFileDate(sCurrentDirMDate);g_sCurrentDirCDate=FormatFileDate(sCurrentDirCDate);g_sCurrentDirADate=FormatFileDate(sCurrentDirADate);}SetCurrentDirOnPage(bIsDrive);g_bBuildThumbnails=true;g_bPauseThumbnails=false;g_nThumbnailIter=0;g_nThumbRestart=false;g_bFileFromListRemoved=false;g_sPreviousDir=g_sCurrentDir;g_nOriginalListSize=FilesList.getRowCount();if(!bBypassForWCP){OnShowHide(g_nShowList);if(g_nShowList==1){LoadingDialog(false,true);setTimeout(function(){ScrollEvent();},0);}}else BuildFileActionButton();if(g_bDoSlideshowOnload&&g_nTotalImages>1){g_bDoSlideshowOnload=false;BusyDialog(false,undefined,true);OnImagePreview(true);}else if(g_bDoPlaylistOnload&&g_nTotalAudio>1){g_bPauseThumbnails=true;g_bDoPlaylistOnload=false;BusyDialog(false,undefined,true);OnMediaPreview(true);}else if(g_bDoPlayMediaOnload&&g_nTotalMedia>0){g_bPauseThumbnails=true;g_bDoPlayMediaOnload=false;BusyDialog(false,undefined,true);if(g_bHaveMediaFile){sMediaFilePath=decodeURIComponent(g_sCurrentDir+"/"+GetURLParameter("file"));MediaPreviewDialog(true,decodeURIComponent(GetURLParameter("file")),sMediaFilePath,undefined,false,0,false);}else OnMediaPreview(false,true);}else{g_bDoPlaylistOnload=false;g_bDoSlideshowOnload=false;g_bDoPlayMediaOnload=false;}}if(!bBypassForWCP){var sDirChangeMessage=GetXMLValue(xmlDoc,"DirChangeMessage");if(sDirChangeMessage!=undefined&&sDirChangeMessage!="")AlertDialog(decodeURIComponent(sDirChangeMessage),false,undefined,true);var nFileListRowIndices=FilesList.getRowIndices();FilesList.setScrollTop(nFileListRowIndices[0]);FilesList.setCurrentRow(nFileListRowIndices[0]);setTimeout(function(){if(g_nShowList!=0){if(Dialogs[nTopDialog]==undefined||Dialogs[nTopDialog].m_Dialog.style.display!="block")FilesList.element().focus();}},0);setTimeout(function(){if(bShowMultiTransferCookie)OnShowMultiTransferBubbleTip();},2000);}if(g_bReloadImagePreview)OnImagePreview(false,false,true);if(g_bReloadMediaPreview)OnMediaPreview(false,false,true);g_bReloadImagePreview=false;g_bReloadMediaPreview=false;if(bBypassForWCP){FilesList.m_fnPostUpdate=function(){OnListDone.call(this,false);};g_bUploadActive=false;}ResetSearchOptions(false);};function OnThumbSizeChange(sItemValue){if(sItemValue!=""){if(g_nShowList==0&&g_bFileFromListRemoved)document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();if(g_bFileFromListRemoved){g_nThumbSize=parseInt(sItemValue);createCookie("thumbsize",g_nThumbSize,60);RefreshList(false);}else{if((g_nThumbnailIter>=FilesList.getRowCount())||(g_nThumbnailIter==0)){g_nThumbnailIter=0;g_nThumbSize=parseInt(sItemValue);createCookie("thumbsize",g_nThumbSize,60);g_nThumbRestart=false;$("#Thumb-Size-Action").disableContextMenu();$("#Thumb-Size-Action").css("visibility","hidden");BuildThumbnailImages(true);}else{g_nThumbRestart=true;g_nThumbSize=parseInt(sItemValue);createCookie("thumbsize",g_nThumbSize,60);}}}}function BuildFileActionButton(nRow){var nSwitch,FileActionImg,FileActionLink,FileActionDiv,FileActionImgCell,FileActionDivCell;var DirOpenImg,DirOpenLink,DirOpenDiv,DirOpenImgCell,DirOpenDivCell;var sShowHide="none";var bPreviewImg=false;var bSlideShowImg=false;var bShowFileAction=false;var bShowFileChangeAction=true;var CreateDirImgCell="0px";var CreateDirDivCell="0px";var bShowDirOpen=false;var bMediaLink=false;var bMediaPlaylist=false;var PreviewMediaCell="0px";var PreviewMediaDivCell="0px";var sShowHideRootActions="block";var sShowHideUploadActions="block";var sShowHideCreateDirActions="block";var UploadImgCell="25px";var UploadDivCell="10px";var DefaultImgCell="0px";var DefaultDivCell="0px";var nUserPlacement=0;if((g_nShowList==1&&nRow!="")||(g_nShowList==0&&$("#ThumbListFiles li.ui-selected").length)){var nSelectedRow=parseInt(nRow);if((g_nShowList==1&&nSelectedRow>=0)||(g_nShowList==0&&$("#ThumbListFiles li.ui-selected").length)){if((g_nShowList==1&&FilesList.getCellValue(4,nSelectedRow)==1&&FilesList.getSelectedRows().length==1)||(g_nShowList==0&&parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdir"))==1&&$("#ThumbListFiles li.ui-selected").length==1))nSwitch=1;else nSwitch=2;if((g_nShowList==1&&FilesList.getCellValue(7,nSelectedRow)==1)||(g_nShowList==0&&parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdrive"))==1)){sShowHide="none";sShowHideRootActions="none";UploadImgCell="0px";UploadDivCell="0px";DefaultImgCell="0px";DefaultDivCell="0px";sShowHideUploadActions="none";}else{sShowHide="block";sShowHideRootActions="block";DefaultImgCell="25px";DefaultDivCell="10px";if(g_bCurrentDirCanUpload!=0){sShowHideUploadActions="block";UploadImgCell="25px";UploadDivCell="10px";}else{sShowHideUploadActions="none";UploadImgCell="0px";UploadDivCell="0px";}}if((g_nShowList==1&&FilesList.getCellValue(5,nSelectedRow)==1)||(g_nShowList==0&&$('#ThumbListFiles li.ui-selected[data-fileisimage="1"]').length>=1)||g_bUpLoadedImage)bPreviewImg=true;if((g_nShowList==1&&(FilesList.getCellValue(10,nSelectedRow)==1||FilesList.getCellValue(11,nSelectedRow)==1))||(g_nShowList==0&&($('#ThumbListFiles li.ui-selected[data-fileisaudio="1"]').length>=1||$('#ThumbListFiles li.ui-selected[data-fileisvideo="1"]').length>=1))&&g_bAllowHTTPMediaPlayback==1)bMediaLink=true;}else nSwitch=0;}else nSwitch=0;switch(parseInt(nSwitch)){case(1):$("#OpenDir-Action").unbind('click');$("#OpenDir-Action-Ico").removeClass('WC-Icon-Disabled');$("#OpenDir-Action").css("color","#000000").css('cursor','');$("#OpenDir-Action").click(function(){OnFileOpen(true);});bShowDirOpen=true;if((g_bMultiTransferLoaded&&g_bWebClientProActive)){$("#Download-Action").unbind('click');$("#Download-Action-Ico").removeClass('WC-Icon-Disabled');$("#Download-Action").css("color","#000000").css('cursor','');$("#Download-Action").click(function(){OnFileOpen(true,undefined,undefined,undefined,(g_bMultiTransferLoaded&&g_bWebClientProActive));});bShowFileAction=true;}else{$("#Download-Action").unbind('click');$("#Download-Action-Ico").addClass('WC-Icon-Disabled');$("#Download-Action").css("color","#909090").css('cursor','default');}break;case(2):$("#Download-Action").unbind('click');$("#Download-Action-Ico").removeClass('WC-Icon-Disabled');$("#Download-Action").css("color","#000000").css('cursor','');$("#Download-Action").click(function(){OnFileOpen(false);});bShowFileAction=true;$("#OpenDir-Action").unbind('click');$("#OpenDir-Action-Ico").addClass('WC-Icon-Disabled');$("#OpenDir-Action").css("color","#909090").css('cursor','default');bShowDirOpen=false;break;default:$("#Download-Action").unbind('click');$("#Download-Action-Ico").addClass('WC-Icon-Disabled');$("#Download-Action").css("color","#909090").css('cursor','default');bShowFileAction=false;$("#OpenDir-Action").unbind('click');$("#OpenDir-Action-Ico").addClass('WC-Icon-Disabled');$("#OpenDir-Action").css("color","#909090").css('cursor','default');bShowDirOpen=false;break;}if(parseInt(g_nTotalImages)>1)bSlideShowImg=true;else bSlideShowImg=false;if(g_nTotalAudio>1&&g_bAllowHTTPMediaPlayback==1)bMediaPlaylist=true;else bMediaPlaylist=false;if(g_bFoundDrive){sShowHide="none";sShowHideRootActions="none";sShowHideUploadActions="none";UploadImgCell="0px";UploadDivCell="0px";DefaultImgCell="0px";DefaultDivCell="0px";}else if(g_bCurrentDirCanUpload==0){sShowHideUploadActions="none";UploadImgCell="0px";UploadDivCell="0px";}if(g_bCurrentDirCanCreate!=0&&sShowHideRootActions!="none"){sShowHideCreateDirActions="block";CreateDirImgCell="25px";CreateDirDivCell="10px";bShowFileChangeAction=true;}else{sShowHideCreateDirActions="none";CreateDirImgCell="0px";CreateDirDivCell="0px";bShowFileChangeAction=false;}if((g_nShowList==1&&FilesList.getSelectedRows().length!=1)||(g_nShowList==0&&$("#ThumbListFiles li.ui-selected").length!=1)){sRenameImgCell="0px";sShowHideRename="none";}else{sRenameImgCell=DefaultImgCell;sShowHideRename=sShowHide;}$("#Rename-Action").attr("data-handler","");if(sShowHideRename=="none"){$("#Rename-Action-Ico").addClass('WC-Icon-Disabled');$("#Rename-Action").css("color","#909090").css('cursor','default');}else{$("#Rename-Action-Ico").removeClass('WC-Icon-Disabled');$("#Rename-Action").css("color","#000000").css('cursor','');$("#Rename-Action").attr("data-handler","javascript:OnFileRename();");}if(!g_bSearchView){$("#Upload-Action").unbind('click');if(sShowHideUploadActions=="none"){
$("#Upload-Action-Ico").addClass('WC-Icon-Disabled');$("#Upload-Action").css("color","#909090").css('cursor','default');}else{$("#Upload-Action-Ico").removeClass('WC-Icon-Disabled');$("#Upload-Action").css("color","#000000").css('cursor','');$("#Upload-Action").click(function(){OnAppletUpload();});}$("#NewDir-Action").unbind('click');if(sShowHideCreateDirActions=="none"){$("#NewDir-Action-Ico").addClass('WC-Icon-Disabled');$("#NewDir-Action").css("color","#909090").css('cursor','default');}else{$("#NewDir-Action-Ico").removeClass('WC-Icon-Disabled');$("#NewDir-Action").css("color","#000000").css('cursor','');$("#NewDir-Action").click(function(){CreateDirDialog();});}}$("#Delete-Action").unbind('click');if(sShowHide=="none"){$("#Delete-Action-Ico").addClass('WC-Icon-Disabled');$("#Delete-Action").css("color","#909090").css('cursor','default');}else{$("#Delete-Action-Ico").removeClass('WC-Icon-Disabled');$("#Delete-Action").css("color","#000000").css('cursor','');$("#Delete-Action").click(function(){OnFileDelete();});}$("#DirProps-Action").attr("data-handler","");if(sShowHideRootActions=="none"){$("#DirProps-Action-Ico").addClass('WC-Icon-Disabled');$("#DirProps-Action").css("color","#909090").css('cursor','default');}else{$("#DirProps-Action-Ico").removeClass('WC-Icon-Disabled');$("#DirProps-Action").css("color","#000000").css('cursor','');$("#DirProps-Action").attr("data-handler","javascript:DirSizeDialog();");}$("#PrevImg-Action").attr("data-handler","");if(bPreviewImg){$("#PrevImg-Action-Ico").removeClass('WC-Icon-Disabled');$("#PrevImg-Action").css("color","#000000").css('cursor','');$("#PrevImg-Action").attr("data-handler","javascript:OnImagePreview();");}else{$("#PrevImg-Action-Ico").addClass('WC-Icon-Disabled');$("#PrevImg-Action").css("color","#909090").css('cursor','default');}$("#SlideShow-Action").attr("data-handler","");if(bSlideShowImg){$("#SlideShow-Action-Ico").removeClass('WC-Icon-Disabled');$("#SlideShow-Action").css("color","#000000").css('cursor','');$("#SlideShow-Action").attr("data-handler","javascript:OnImagePreview(true);");}else{$("#SlideShow-Action-Ico").addClass('WC-Icon-Disabled');$("#SlideShow-Action").css("color","#909090").css('cursor','default');}$("#PrevMedia-Action").attr("data-handler","");if(bMediaLink){$("#PrevMedia-Action-Ico").removeClass('WC-Icon-Disabled');$("#PrevMedia-Action").css("color","#000000").css('cursor','');$("#PrevMedia-Action").attr("data-handler","javascript:OnMediaPreview();");}else{$("#PrevMedia-Action-Ico").addClass('WC-Icon-Disabled');$("#PrevMedia-Action").css("color","#909090").css('cursor','default');}$("#PlaylistMedia-Action").attr("data-handler","");if(bMediaPlaylist){$("#PlaylistMedia-Action-Ico").removeClass('WC-Icon-Disabled');$("#PlaylistMedia-Action").css("color","#000000").css('cursor','');$("#PlaylistMedia-Action").attr("data-handler","javascript:OnMediaPreview(true);");}else{$("#PlaylistMedia-Action-Ico").addClass('WC-Icon-Disabled');$("#PlaylistMedia-Action").css("color","#909090").css('cursor','default');}if(g_bAllowChangePassword)$("#SUWCUserOption-password").show();if(g_bAllowChangeEmail)$("#SUWCUserOption-changeemail").show();if(g_bAdmin)$("#MCNavOption").show();if(g_bAllowAdhocFileSharing)$("#FSNavOption").show();if(g_bFVJVLicense)$("#FJNavOption").show();g_bButtonsLoaded=true;}function BuildThumbnails(bDoSync){var sHTML="";var sThumbID;var nThumbCellWidth=(g_nThumbSize+14);var nThumbCellHeight=(g_nThumbSize+47);var nIENudge=0;var sThumbContainer="";var sFilePath="";var sFileName="";var sFileDate="";var sFileSize="";var sRawFilePath="";var nTotalRows=FilesList.getRowCount();var sEncodedFilePath="";var anFileIndices=FilesList.getRowIndices();var sSyncParam="";var $ThumbnailList=$("#ThumbListFiles");if(sBrowserType=="Microsoft Internet Explorer")nIENudge=2;for(var nIndex=0;(nIndex<nTotalRows);nIndex++){sThumbID="";sThumbContainer="";sFilePath=CleanPathByEscape(FilesList.getCellText(3,parseInt(anFileIndices[nIndex])));sFilePath=sFilePath.replace(new RegExp("&","g"),"&amp;");sEncodedFilePath=sFilePath;if(g_bSearchView){sFileName=FilesList.getCellText(12,parseInt(anFileIndices[nIndex]));sSearchFileName=FilesList.getCellText(0,parseInt(anFileIndices[nIndex]));}else sFileName=FilesList.getCellText(0,parseInt(anFileIndices[nIndex]));sFileDate=FilesList.getCellText(2,parseInt(anFileIndices[nIndex]));sFileSize=FilesList.getCellText(1,parseInt(anFileIndices[nIndex]));sLeftMargin="margin-left:15px;";sRuleStr=sFileName;nPos=sRuleStr.lastIndexOf(".");if(nPos>=0)sRuleStr=sRuleStr.substr(nPos+1);if(FilesList.getCellText(5,anFileIndices[nIndex])==1){sFileIcon="ThumbnailQued48.png";sThumbID='id="thumbimg'+nIndex+'"';bIsDir=false;sLeftMargin="";}else if(FilesList.getCellText(10,parseInt(anFileIndices[nIndex]))==1||FilesList.getCellText(11,parseInt(anFileIndices[nIndex]))==1){sFileIcon=GetLargeFileIcon(sRuleStr)+"48.png";if(sFileIcon=="DefaultExt48.png")sFileIcon="WMVExt48.png";bIsDir=false;sLeftMargin="";if(FilesList.getCellText(10,parseInt(anFileIndices[nIndex]))==1)bAudio=true;else bAudio=false;}else{if(FilesList.getCellText(4,parseInt(anFileIndices[nIndex]))==1){sFileIcon="Folder48.png";bIsDir=true;}else{sFileIcon=GetLargeFileIcon(sRuleStr)+"48.png";bIsDir=false;}}sThumbContainer='<li class="thumbcell" '+'data-filename="'+sFileName+'" data-filesize="'+FilesList.getCellText(1,parseInt(anFileIndices[nIndex]))+'" '+'data-filepath="'+FilesList.getCellText(3,parseInt(anFileIndices[nIndex]))+'" data-fileisdir="'+FilesList.getCellText(4,parseInt(anFileIndices[nIndex]))+'" '+'data-fileisimage="'+FilesList.getCellText(5,parseInt(anFileIndices[nIndex]))+'" data-filedrivelabel="'+FilesList.getCellText(6,parseInt(anFileIndices[nIndex]))+'" '+'data-fileisdrive="'+FilesList.getCellText(7,parseInt(anFileIndices[nIndex]))+'" data-filedrivetype="'+FilesList.getCellText(8,parseInt(anFileIndices[nIndex]))+'" '+'data-fileisdeleted="'+FilesList.getCellText(9,parseInt(anFileIndices[nIndex]))+'" data-fileisaudio="'+FilesList.getCellText(10,parseInt(anFileIndices[nIndex]))+'" '+'data-fileisvideo="'+FilesList.getCellText(11,parseInt(anFileIndices[nIndex]))+'" data-thumbIndex="'+nIndex+'" data-indicesIndex="'+anFileIndices[nIndex]+'" '+'style="width:'+nThumbCellWidth+'px;height:'+nThumbCellHeight+'px;"  id="thumb'+nIndex+'">';sThumbContainer+='<div class="thumbnail-off" style="margin:0 auto;width:'+(g_nThumbSize+nIENudge)+'px;height:'+(g_nThumbSize+nIENudge)+'px;" onmouseout="javascript:this.className=\'thumbnail-off\'" onmouseover="javascript:this.className=\'thumbnail-on\'" id="thumbactions'+nIndex+'">';sThumbContainer+='<table cellpadding="0" cellspacing="0" border="0" style="width:100%;height:100%;"><tr><td class="thumnailalign">';sThumbContainer+='<img '+sThumbID+' src="/Web Client/ThumbnailIcons/'+sFileIcon+'" width="48" height="48" class="thumbimg" >';sThumbContainer+='</td></tr></table></div>';var sStyleFileNameColor="#000000";if(g_bSearchView){if(parseInt(FilesList.getCellData(13,parseInt(anFileIndices[nIndex]))))sStyleFileNameColor="blue";else if(parseInt(FilesList.getCellData(14,parseInt(anFileIndices[nIndex]))))sStyleFileNameColor="#13920d";}else{if(parseInt(FilesList.getCellData(12,parseInt(anFileIndices[nIndex]))))sStyleFileNameColor="blue";else if(parseInt(FilesList.getCellData(13,parseInt(anFileIndices[nIndex]))))sStyleFileNameColor="#13920d";}if(g_bSearchView)sThumbContainer+=' <div class="ellipsis" style="color:'+sStyleFileNameColor+';" onmouseover="javascript:this.style.cursor = \'pointer\'" id="thumbfilename'+nIndex+'">'+sSearchFileName.replace(new RegExp(" ","g"),"&nbsp;")+'</div>';else sThumbContainer+=' <div class="ellipsis" style="color:'+sStyleFileNameColor+';" onmouseover="javascript:this.style.cursor = \'pointer\'"  id="thumbfilename'+nIndex+'">'+sFileName.replace(new RegExp(" ","g"),"&nbsp;")+'</div>';sThumbContainer+='<div class="ellipsis">'+sFileDate+'</div>';sThumbContainer+='<div class="ellipsis">'+sFileSize+'</div>';sThumbContainer+='</li>\n\n';sHTML+=sThumbContainer;}$ThumbnailList.html(sHTML);$ThumbnailList.trigger("selectablestop");ExtendjQuerySelectable($ThumbnailList.children("li"),OnDBLClickThumbnail);g_bBuildThumbnails=false;g_nThumbnailIter=0;LoadingDialog(false,true);setTimeout(function(){BuildThumbnailImages(false,bDoSync);},500);}function BuildThumbnailImages(bResizeContainer,bDoSync){var sEncodedFilePath;var nThumbCellWidth=(g_nThumbSize+14);var nThumbCellHeight=(g_nThumbSize+47);var bDoContainer=bResizeContainer;var nIENudge=0;var nTotalRows=FilesList.getRowCount();var anThumbImageIndices=FilesList.getRowIndices();var sSyncParam="";if(sBrowserType=="Microsoft Internet Explorer")nIENudge=2;if(bDoSync)sSyncParam=SyncRequestParameter();for(;(g_nThumbnailIter<nTotalRows);g_nThumbnailIter++){if(g_bPauseThumbnails){g_nRestartPosition=g_nThumbnailIter;g_nThumbnailIter=nTotalRows;break;}if(g_nThumbRestart){g_nThumbRestart=false;g_nThumbnailIter=-1;nThumbCellWidth=(g_nThumbSize+14);nThumbCellHeight=(g_nThumbSize+47);bDoContainer=true;}else{sEncodedFilePath=encodeURIComponent(FilesList.getCellText(3,parseInt(anThumbImageIndices[g_nThumbnailIter])));if(bDoContainer){if(document.getElementById("thumb"+g_nThumbnailIter)){document.getElementById("thumb"+g_nThumbnailIter).style.width=nThumbCellWidth+"px";document.getElementById("thumb"+g_nThumbnailIter).style.height=nThumbCellHeight+"px";}var rThumbActionElement=document.getElementById("thumbactions"+g_nThumbnailIter);if(rThumbActionElement!=undefined&&rThumbActionElement!=null){rThumbActionElement.style.width=(g_nThumbSize+nIENudge)+"px";rThumbActionElement.style.height=(g_nThumbSize+nIENudge)+"px";}}if(FilesList.getCellText(5,parseInt(anThumbImageIndices[g_nThumbnailIter]))==1&&FilesList.getCellText(9,parseInt(anThumbImageIndices[g_nThumbnailIter]))!=1){GetImage('thumbimg'+g_nThumbnailIter,'/?Command=Download&File='+sEncodedFilePath+'&Width='+g_nThumbSize+'&Height='+g_nThumbSize+'&Thumbnail=1'+sSyncParam,bDoContainer,bDoSync);return;}}}$("#Thumb-Size-Action").enableContextMenu();$("#Thumb-Size-Action").css("visibility","visible");}function GetImage(pExistingImageID,pImageURL,bDoContainer,bDoSync){var img=document.createElement('img');if(document.getElementById(pExistingImageID)!=null){document.getElementById(pExistingImageID).src="/Web Client/ThumbnailIcons/thumb-loader.gif";document.getElementById(pExistingImageID).width="25";document.getElementById(pExistingImageID).height="25";img.onload=function(evt){if(document.getElementById(pExistingImageID)){document.getElementById(pExistingImageID).src=this.src;document.getElementById(pExistingImageID).width=this.width;document.getElementById(pExistingImageID).height=this.height;g_nThumbnailIter++;if(bDoContainer){setTimeout(function(){BuildThumbnailImages(true,bDoSync);},0);}else{setTimeout(function(){BuildThumbnailImages(false,bDoSync);},0);}}};img.onerror=function(evt){document.getElementById(pExistingImageID).src="/Web Client/ThumbnailIcons/default48.png";document.getElementById(pExistingImageID).width="48";document.getElementById(pExistingImageID).height="48";g_nThumbnailIter++;if(bDoContainer){setTimeout(function(){BuildThumbnailImages(true,bDoSync);},0);}else{setTimeout(function(){BuildThumbnailImages(false,bDoSync);},0);}};img.src=pImageURL;}}var g_nThumbScrollPos=0;var g_nListScrollPos=0;var g_sViewTitle="详细信息";function UpdateViewTooltip(nShow){g_sViewTitle="缩略图";if(nShow==0)g_sViewTitle="详细信息";$("#View-Action").attr("title",g_sViewTitle);}function OnShowHide(nShow){var nFileActionRow;UpdateViewTooltip(nShow);if(nShow==0&&!g_bFileFromListRemoved){$("#Thumb-Size-Img").removeClass('WC-Icon-Thumb').addClass('WC-Icon-Details');$("#Thumb-Size-Action").enableContextMenu();$("#Thumb-Size-Action").css("visibility","visible");var sOnShowHide=String('OnShowHide(1);');g_nListScrollPos=FilesList.getScrollTop();document.getElementById("ListFilesContainer").style.display="none";$("#View-Action").unbind('click');$("#View-Action").click(function(){OnShowHide(1);});document.getElementById("ThumbnailContainer").style.display="block";document.getElementById("thumbpanebox").scrollTop=g_nThumbScrollPos;$("#Rename-Action").attr("data-handler","");$("#Rename-Action-Ico").addClass('WC-Icon-Disabled');$("#Rename-Action").css("color","#909090").css('cursor','default');$("#Delete-Action").unbind('click');$("#Delete-Action-Ico").addClass('WC-Icon-Disabled');$("#Delete-Action").css("color","#909090").css('cursor','default');nFileActionRow=-1;if(g_bPauseThumbnails){g_bPauseThumbnails=false;g_nThumbnailIter=g_nRestartPosition;setTimeout("BuildThumbnailImages(true)");}if(g_bBuildThumbnails){document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();window.setTimeout(BuildThumbnails,500);}}else if(nShow==0&&g_bFileFromListRemoved){RefreshList(false);$("#Thumb-Size-Img").removeClass('WC-Icon-Thumb').addClass('WC-Icon-Details');$("#Thumb-Size-Action").enableContextMenu();$("#Thumb-Size-Action").css("visibility","visible");}else{$("#Thumb-Size-Img").removeClass('WC-Icon-Details').addClass('WC-Icon-Thumb');g_nThumbScrollPos=document.getElementById("thumbpanebox").scrollTop;if(g_nThumbnailIter>0&&g_nThumbnailIter!=FilesList.getRowCount())g_bPauseThumbnails=true;document.getElementById("ListFilesContainer").style.display="block";$("#View-Action").unbind('click');$("#View-Action").click(function(){OnShowHide(0);});CheckFileListFocus();$("#Thumb-Size-Action").disableContextMenu();$("#Thumb-Size-Action").css("visibility","hidden");document.getElementById("ThumbnailContainer").style.display="none";if(g_bFoundDrive){sActionDisplay="none";sActionDivider="";sActionDividerCell="0px";}else{sActionDisplay="block";sActionDivider='<span class="dividerline" >&nbsp;</span>';sActionDividerCell="10px";}$("#Rename-Action").attr("data-handler","");if(sActionDisplay=="none"){$("#Rename-Action-Ico").addClass('WC-Icon-Disabled');$("#Rename-Action").css("color","#909090").css('cursor','default');}else{$("#Rename-Action-Ico").removeClass('WC-Icon-Disabled');$("#Rename-Action").css("color","#000000").css('cursor','');$("#Rename-Action").attr("data-handler","javascript:OnFileRename();");}$("#Delete-Action").unbind('click');if(sActionDisplay=="none"){$("#Delete-Action-Ico").addClass('WC-Icon-Disabled');$("#Delete-Action").css("color","#909090").css('cursor','default');}else{$("#Delete-Action-Ico").removeClass('WC-Icon-Disabled');$("#Delete-Action").css("color","#000000").css('cursor','');$("#Delete-Action").click(function(){OnFileDelete();});}nFileActionRow=FilesList.getSelectedRows();ScrollEvent();FilesList.setScrollTop(g_nListScrollPos);}g_nShowList=nShow;BuildFileActionButton(nFileActionRow);}function ParentDir(){var nPos=0;if(g_nShowList==0)document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();else LoadingDialog(true,true);nPos=g_sCurrentDir.lastIndexOf("/");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("%2F");if(nPos<0)g_sCurrentDir=g_sHomeDir;else{if(nPos==0)g_sCurrentDir="/";else g_sCurrentDir=g_sCurrentDir.substring(0,nPos);}OnResetTotals();FilesList.Update(g_sListDirURL+g_sCurrentDir);}function HomeDir(){var nPos=0;if(g_nShowList==0)document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();else LoadingDialog(true,true);g_sCurrentDir=encodeURI("~");OnResetTotals();FilesList.Update(g_sListDirURL+g_sCurrentDir);}function OnPreviousDir(){FilesList.Update(g_sListDirURL+g_sCurrentDir);}function RefreshList(bShowLoadingDialog,bReloadImagePreview,bReloadMediaPreview){if(bReloadImagePreview)g_bReloadImagePreview=true;if(bReloadMediaPreview)g_bReloadMediaPreview=true;if(g_nShowList==0)document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();if(bShowLoadingDialog)LoadingDialog(true,true);ResetSearchOptions(true);OnResetTotals();FilesList.Update(g_sListDirURL+g_sCurrentDir);}function OnConfirmDelete(aDeleteValues){var bDoDir=aDeleteValues[0];var sDeleteFilePath=aDeleteValues[1];var sThumbId=aDeleteValues[2];var nThumbIndex=aDeleteValues[3];var bPreviewDlg=aDeleteValues[4];var bPreviewMediaDlg=aDeleteValues[5];var sDeleteCmd="";HideDialog("ConfirmDialog");if(g_bPreviewDialog)SetupEventHandlers();DeletingDialog(true,true);if(bDoDir)sDeleteCmd="/?Command=DeleteDir";else sDeleteCmd="/?Command=Delete";var DeleteRequest=CreatePostRequest(sDeleteCmd);DeleteRequest.setParameter("File",sDeleteFilePath);DeleteRequest.setAsync(true);DeleteRequest.request();DeleteRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var bSkipDeletingDialog=false;if(nResult!=g_nSessionOkay){DeletingDialog(false,true);AlertDialog(GetResultText(0,"",sResultText),undefined,undefined,true);}else{if(FilesList.getCellValue(4,FilesList.getSelectedRows())==1){g_nCopyTotalDirs--;document.getElementById("TotalDirs").innerHTML=FormatNumberCommas(g_nCopyTotalDirs);nFileSize=0;}else{g_nCopyTotalFiles--;nFileSize=FilesList.getCellValue(1,FilesList.getSelectedRows());document.getElementById("TotalFiles").innerHTML=g_nCopyTotalFiles;}g_nTotalSize=(g_nTotalSize-nFileSize);document.getElementById("TotalSize").innerHTML=FormatFileSize(g_nTotalSize,true);if(g_nShowList==0){if(bPreviewDlg||bPreviewMediaDlg){g_bBuildThumbnails=true;if(bPreviewDlg)RefreshList(false,true,false);else{bSkipDeletingDialog=true;OnKillMediaShow();setTimeout(function(){RefreshList(false,false,true);DeletingDialog(false,true);},6000);}}else{document.getElementById(sThumbId).style.display="none";FilesList.UpdateText("1",9,nThumbIndex);FilesList.UpdateText("",0,nThumbIndex);if(FilesList.getCellValue(5,nThumbIndex)==1&&g_nTotalImages>=1){g_nTotalImages--;g_nCurrentPreviewImage--;}if(FilesList.getCellValue(10,nThumbIndex)==1||FilesList.getCellValue(11,nThumbIndex)==1&&g_nTotalMedia>=1){g_nTotalMedia--;g_nCurrentPreviewMedia--;}FilesList.deleteRow(nThumbIndex);g_bBuildThumbnails=true;RefreshList(false,false);}}else{nSelectedDeleteIndex=FilesList.getSelectedRows();nSelectedCurrentIndex=FilesList.getRowPosition(parseInt(nSelectedDeleteIndex))+1;anRowsIndex=FilesList.getRowIndices();nNextSelectedIndex=anRowsIndex[(parseInt(nSelectedCurrentIndex))];FilesList.UpdateText("1",9,nSelectedDeleteIndex);FilesList.UpdateText("",0,nSelectedDeleteIndex);if(FilesList.getCellValue(5,nSelectedDeleteIndex)==1&&g_nTotalImages>=1){g_nTotalImages--;g_nCurrentPreviewImage--;}if(FilesList.getCellValue(10,nSelectedDeleteIndex)==1||FilesList.getCellValue(11,nSelectedDeleteIndex)==1&&g_nTotalMedia>=1){g_nTotalMedia--;g_nCurrentPreviewMedia--;}FilesList.deleteRow(nSelectedDeleteIndex);if(g_bBuildThumbnails)g_bFileFromListRemoved=true;else document.getElementById("thumb"+nSelectedDeleteIndex).style.display="none";if(FilesList.getCurrentRow()<(FilesList.getRowCount()-1)){if(nNextSelectedIndex==undefined)nNextSelectedIndex=(parseInt(nSelectedCurrentIndex));FilesList.setSelectedRows([parseInt(nNextSelectedIndex)]);}if(bPreviewDlg){RefreshList(false,true,false);}if(bPreviewMediaDlg){bSkipDeletingDialog=true;OnKillMediaShow();setTimeout(function(){RefreshList(false,false,true);DeletingDialog(false,true);},6000);}}if(!bSkipDeletingDialog)DeletingDialog(false,true);CheckFileListFocus();}};}function OnFileDelete(bDir,sPath,sThumbId,nIndex,bPreviewDlg,bPreviewMediaDlg){var bDoDir=false;var sDeleteFilePath="";g_nRowCount=0;if(g_bPreviewDialog)RemoveEventHandlers();if((g_bMultiTransferLoaded&&g_bWebClientProActive)){var aSelectedRows=FilesList.getSelectedRows().toString().split(",");g_nRowCount=parseInt(aSelectedRows.length);OnAppletDelete(((g_nShowList==0&&sPath!=undefined)?sPath:undefined),((g_nShowList==0&&bDir!=undefined)?((bDir)?1:0):undefined));}else{if(g_nShowList==1){if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)bDoDir=true;sDeleteFilePath=FilesList.getCellText(3,FilesList.getSelectedRows());sThumbId="";}else{if(sPath!=undefined&&sPath!=""){bDoDir=bDir;sDeleteFilePath=sPath;}else{bDoDir=(parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdir").toString())==1);sDeleteFilePath=$("#ThumbListFiles li.ui-selected").attr("data-filepath").toString();sThumbId="thumb"+$("#ThumbListFiles li.ui-selected").attr("data-thumbIndex");nIndex=$("#ThumbListFiles li.ui-selected").attr("data-indicesIndex");}}if(sDeleteFilePath!=""){if(bDoDir)sDeleteMsg="您确定要删除选中的目录吗？";else sDeleteMsg="您确定要删除选中的文件吗？";ConfirmDialog(sDeleteMsg,OnConfirmDelete,OnCancelDelete,[bDoDir,sDeleteFilePath,sThumbId,nIndex,bPreviewDlg,bPreviewMediaDlg],undefined,undefined,true,true,undefined,OnDeleteHide);}else AlertDialog("请先选择要删除的文件或目录。",undefined,undefined,true);}}function OnDeleteHide(){if(g_bMediaPreviewActive)OnShowMediaShow();}function OnCancelDelete(){CheckFileListFocus();if(g_bPreviewDialog)SetupEventHandlers();}function OnFileOpenEx(){OnFileOpen(undefined,undefined,undefined,undefined,(g_bMultiTransferLoaded&&g_bWebClientProActive));}function FormatWcpCancelLoadingDiv(){var sDiv="<div style='height:100%;text-align:center;'><img src='"+g_sWebFilePath+"Images/WCP-loading.gif' class='wcploadico' alt='Loading' border='0'/> Loading contents...</div>";return(sDiv);}function OnFileOpen(bDir,sPath,bGoTo,bOnLoadDownloadFlag,bForceDirDL){var bDoDir=false;var sDownloadFilePath="";var anSelectedRows=FilesList.getSelectedRows();if(bOnLoadDownloadFlag==undefined)bOnLoadDownloadFlag=false;if(g_nShowList==1&&!bOnLoadDownloadFlag&&anSelectedRows.length<=1){if(bGoTo){bDoDir=true;g_sCurrentDir=encodeURIComponent(sPath);}else{if((FilesList.getCellText(4,FilesList.getSelectedRows())==1)&&bForceDirDL!=true&&anSelectedRows.length==1){bDoDir=true;g_sCurrentDir=encodeURIComponent(FilesList.getCellText(3,FilesList.getSelectedRows()));}else sDownloadFilePath=encodeURIComponent(FilesList.getCellText(3,FilesList.getSelectedRows()));}}else if(g_nShowList==0&&!bOnLoadDownloadFlag&&$("#ThumbListFiles li.ui-selected").length==1&&!g_bImagePreviewActive&&!g_bMediaPreviewActive){if(bGoTo){bDoDir=true;g_sCurrentDir=encodeURIComponent(sPath);}else{if(parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdir"))==1)bDoDir=true;else bDoDir=false;if(bDoDir&&bForceDirDL!=true)g_sCurrentDir=encodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filepath").toString());else sDownloadFilePath=encodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filepath").toString());}}else{bDoDir=bDir;if(bDoDir&&bForceDirDL!=true)g_sCurrentDir=encodeURIComponent(sPath);else sDownloadFilePath=encodeURIComponent(sPath);}if(bDoDir&&bForceDirDL!=true){if(g_nShowList==0)document.getElementById("ThumbListFiles").innerHTML=FormatWcpCancelLoadingDiv();else LoadingDialog(true,true);OnResetTotals();FilesList.Update(g_sListDirURL+g_sCurrentDir);}else{if(g_nThumbnailIter>0&&g_nThumbnailIter!=FilesList.getRowCount())g_bPauseThumbnails=true;if((g_bMultiTransferLoaded&&g_bWebClientProActive))OnAppletDownload(((g_nShowList==0&&sPath!=undefined)?sDownloadFilePath:undefined),((g_nShowList==0&&bDir!=undefined)?((bDoDir)?1:0):undefined));else location.href="/?Command=Download&File="+sDownloadFilePath;if(g_bPauseThumbnails)setTimeout("ResumeThumbnails()",1000);}}function ResumeThumbnails(){g_bPauseThumbnails=false;g_nThumbnailIter=g_nRestartPosition;setTimeout("BuildThumbnailImages(true)",1000);}function OnFileRename(sFilePath,sFileName,nThumbIndex,bIsDir,bPreviewDlg){var sRenameFilePath="",sRenameFileName="";g_bContextKeepAppletHidden=true;if(g_nShowList==1){if(g_bSearchView)sRenameFileName=FilesList.getCellText(12,FilesList.getSelectedRows());else sRenameFileName=FilesList.getCellText(0,FilesList.getSelectedRows());sRenameFileName=sRenameFileName.replace(new RegExp("&amp;","g"),"&");sRenameFilePath=encodeURIComponent(FilesList.getCellText(3,FilesList.getSelectedRows()));if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)bIsDir=true;else bIsDir=false;}else{if(sFilePath==undefined){sRenameFileName=$("#ThumbListFiles li.ui-selected").attr("data-filename").toString();sRenameFilePath=encodeURIComponent($("#ThumbListFiles li.ui-selected").attr("data-filepath").toString());document.rename.thumb_index.value=$("#ThumbListFiles li.ui-selected").attr("data-thumbIndex").toString();if(parseInt($("#ThumbListFiles li.ui-selected").attr("data-fileisdir"))==1)bIsDir=true;else bIsDir=false;}else{sRenameFileName=sFileName;sRenameFilePath=encodeURIComponent(sFilePath);document.rename.thumb_index.value=nThumbIndex;}}PathInput.setControlText(sRenameFileName);document.rename.original_path.value=sRenameFilePath;document.rename.isdir.value=bIsDir;if(sRenameFilePath!="")OnShowRenameDialog(bPreviewDlg,sRenameFileName);else AlertDialog("请先选择要重命名的文件或目录。",undefined,undefined,true);}function SetUpDirBtnEnabled(bEnabled){$("#UpDir-Action").unbind('click');if(!bEnabled){$("#UpDir-Action-Ico").addClass('WC-Icon-Disabled');$("#UpDir-Action").css("color","#909090").css('cursor','default');}else{$("#UpDir-Action-Ico").removeClass('WC-Icon-Disabled');$("#UpDir-Action").css("color","#000000").css('cursor','');$("#UpDir-Action").click(function(){ParentDir();});}}function SetCurrentDirOnPage(bIsDrive,bSkipHistory){var sCurrentPageDir=GetDecodedDirPath(g_sCurrentDir);document.getElementById("CrumbBar").innerHTML=BuildCrumbBar(g_sCurrentDir);if(!bSkipHistory||bSkipHistory==undefined)OnAddHistory(g_sCurrentDir,bIsDrive);document.title="vi.gymbaby.cn - "+sCurrentPageDir;if((g_sCurrentDir=="/")||(g_sCurrentDir=="%2F"))SetUpDirBtnEnabled(false);else SetUpDirBtnEnabled(true);nCurrDirPos=sCurrentPageDir.lastIndexOf("/");if(nCurrDirPos<0||sCurrentPageDir=="/")g_sCurrentDirRelative="主页";else g_sCurrentDirRelative=sCurrentPageDir.substring(nCurrDirPos+1);$("#SUWCCurrDir").html(g_sCurrentDirRelative);}function SetFilesListHeight(nHeight,nAdjustment,nBuffer){if(nAdjustment==undefined||nAdjustment==null||isNaN(nAdjustment))nAdjustment=0;if(nBuffer==undefined||nBuffer==null||isNaN(nBuffer))nBuffer=0;FilesList.setStyle("height",parseInt(nHeight-nAdjustment)+"px");if(document.getElementById("thumbpanebox")!=undefined)document.getElementById("thumbpanebox").style.height=parseInt(nHeight-nAdjustment)+"px";FilesList.setContentHeight(parseInt(nHeight-(nAdjustment+nBuffer)),"total");}function ResizeWebClient(){var w_maxWidth=1600,w_maxHeight=1600,w_MinHeight=300;var anDim=GetScreenDim(4,15);w_newWidth=parseInt(anDim[0]);w_newHeight=parseInt(anDim[1]);if(w_newWidth>w_maxWidth)w_newWidth=w_maxWidth;if(w_newHeight>w_maxHeight)w_newHeight=w_maxHeight;else if(w_newHeight<w_MinHeight)w_newHeight=w_MinHeight;var nDefaultListHeight=320;var nCurrListHeight=parseInt(nDefaultListHeight);var nTransferPaneHeight=0;if(Slider1!=undefined&&Slider1!=null)nTransferPaneHeight=Slider1.GetPaneHeight(Slider1.sBottomBar);if(nTransferPaneHeight<1){if(g_bDisableBranding){nCurrListHeight=130;nCurrListHeight+=((nTransferPaneHeight-nCurrListHeight)+15);}else nCurrListHeight=nDefaultListHeight;if(AW.ie)nCurrListHeight+=20;SetFilesListHeight(w_newHeight,nCurrListHeight,4);}else{var ptTopLeft=$("#"+g_sBottomPaneDivID).offset();nTransferPaneHeight=((w_newHeight-50)-ptTopLeft.top);document.getElementById(g_sBottomPaneDivID).style.height=nTransferPaneHeight+"px";}if(document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).contentWindow.OnWindowResized();FilesList.setTimeout(function(){if(FilesList.getVirtualMode()==true)FilesList.refresh();},0);CheckFileListFocus();}function OnShowChangePasswordDialog(){if(g_bAllowChangePassword){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");}}function OnShowChangeEmailDialog(){if(g_bAllowChangeEmail){OnShowSetEmailDialog(g_sUserEmail);}g_sUserEmail="";}function LoadRightClickImages(){RightClickSpacerImageLoad=new Image();RightClickSpacerImageLoad.src="/Common/Images/spacer.gif";}setTimeout(function(){OnSendNOOP(true);},55000);window.onresize=ResizeWebClient;AddOnloadEvent(LoadRightClickImages);function InitListDirOnLoadPageScripts(){RefreshList(true);if(GetURLParameter("file")!=""&&GetURLParameter("playmedia")==""){setTimeout(function(){OnFileOpen(false,decodeURIComponent(g_sCurrentDir+"/"+GetURLParameter("file")),undefined,true);},1000);}}function ReplaceCustomHeaderImage(){var CustomImg=new Image();var sCustomImgSrc="/%25LOGO_FILE%25/Web Client/Share/Images/Gymbaby-Logo-Text-small.png?Width=160&Height=40&Thumbnail=1"+SyncRequestParameter();var nWidth="160";var nHeight="40";if(g_bDisableBranding&&!g_bHasCustomLogo){sCustomImgSrc="/Common/Images/blank.gif"+SyncRequestParameter();nWidth="1";nHeight="1";}CustomImg.src=sCustomImgSrc;document.getElementById("SULOGO").src=CustomImg.src;document.getElementById("SULOGO").width=nWidth;document.getElementById("SULOGO").height=nHeight;if(g_bHasCustomLogo)document.getElementById("SULOGO").style.marginRight="10px";}function OnShowHistory(){var nFavAdd=0;var bHaveFavs=false;clearTimeout(HistoryDelayId);if(!document.getElementById("crumb-containerHistory-Menu")){var DialogElement=document.createElement("div");DialogElement.id=("crumb-containerHistory-Menu");if(AW.ie)DialogElement.className="HistoryBarMenu-ie";else if(g_bSafariBrowser)DialogElement.className="HistoryBarMenu-safari";else DialogElement.className="HistoryBarMenu";DialogElement.style.zIndex="1999";DialogElement.style.cursor="pointer";DialogElement.style.height="60px";sCrumbContainer='<div style="text-align:center;"><img src="'+g_sCommonPath+'Images/BusyGrid.gif" style="margin:0px auto 0px auto;"></div>';DialogElement.innerHTML=sCrumbContainer;document.getElementsByTagName("body")[0].appendChild(DialogElement);}g_bBlockCrumb=true;g_nActiveCrumbMenuId="History-Menu";if(document.getElementById("crumb-containerHistory-Menu").style.visibility=="hidden"||document.getElementById("crumb-containerHistory-Menu").style.visibility==""){document.getElementById("crumb-containerHistory-Menu").style.height="60px";document.getElementById("crumb-containerHistory-Menu").innerHTML='';setTimeout(function(){if(!AW.ie)document.getElementById("crumb-containerHistory-Menu").style.padding="0px 1px 1px 0px";if(aFavoritesHistory.length>0){bHaveFavs=true;nFavAdd=1;if(!AW.ie&&(aCrumbHistory.length-1)>=15)document.getElementById("crumb-containerHistory-Menu").style.padding="0px 17px 1px 0px";}CreateCrumbMenu(aCrumbHistory,"History-Menu",(aCrumbHistory.length-nFavAdd),"搜索结果",true,aFavoritesHistory.length);},0);g_bBlockCrumb=false;setTimeout(function(){if(!bHaveFavs){hideHistoryMenuSetUp();}else hideHistoryMenuSetUpFavs();},500);}else {hideHistoryMenu();}}function CheckForDuplicatePath(sPath){for(var i=0;i<g_aHistory.length;i++){if(g_aHistoryNames[i]==sPath){g_aHistory.splice(i,1);g_aHistoryIcon.splice(i,1);g_aHistoryNames.splice(i,1);g_aHistoryActive.splice(i,1);break;}}}function OnAddHistory(sHistoryPath,bIsDrive){var sPath=decodeURIComponent(sHistoryPath);var sDriveIco="DirShortcut";var nPointer;
var sCleanPath=sPath.replace(eval("/\\(/g"),"\\(");sCleanPath=sCleanPath.replace(eval("/\\)/g"),"\\)");if((g_aHistoryNames[g_aHistory.length-1]!=sPath)&&(!g_bHistoryButtonUsed)){CheckForDuplicatePath(sPath);var nIndex=sPath.lastIndexOf('/');if((nIndex>=0)&&(sPath!="/"))sPath=sPath.slice(nIndex+1);g_aHistory.push(sPath);if((g_sCurrentDir!="/")&&(g_sCurrentDir!="%2F")&&(bIsDrive!=0)){var nDriveType=g_sCurrentDirDriveType;if(nDriveType==2){if((sCleanPath.toUpperCase().indexOf("A:")!=-1)||(sCleanPath.toUpperCase().indexOf("B:")!=-1))sDriveIco=GetDriveIcon(2);else sDriveIco=GetDriveIcon(7);}else sDriveIco=GetDriveIcon(g_sCurrentDirDriveType);}else if(g_bCurrentDirIsHome){sDriveIco="Home";}g_aHistoryIcon.push(sDriveIco);g_aHistoryNames.push(FormatClientString(sHistoryPath));g_aHistoryActive.push(0);g_HistoryPointer=(g_aHistory.length-1);g_sLastIcon=sDriveIco;}for(var i=0;i<g_aHistory.length;i++){g_aHistoryActive[i]=0;}g_aHistoryActive[g_HistoryPointer]=1;g_bHistoryButtonUsed=false;if((g_aHistory.length>1)&&(g_HistoryPointer<(g_aHistory.length-1))){$("#History-Forward").removeClass('WC-Icon-ForwardArrow-disabled').addClass('WC-Icon-ForwardArrow');$("#History-Forward").unbind('click');$("#History-Forward").click(function(){GoHistory(1);});}else{$("#History-Forward").removeClass('WC-Icon-ForwardArrow').addClass('WC-Icon-ForwardArrow-disabled');$("#History-Forward").unbind('click');}if((g_HistoryPointer!=0)&&(g_HistoryPointer<=(g_aHistory.length-1))&&(g_aHistory.length>1)){$("#History-Back").removeClass('WC-Icon-BackArrow-disabled').addClass('WC-Icon-BackArrow');$("#History-Back").unbind('click');$("#History-Back").click(function(){GoHistory(-1);});}else{$("#History-Back").removeClass('WC-Icon-BackArrow').addClass('WC-Icon-BackArrow-disabled');$("#History-Back").unbind('click');}var bHaveFavs=false;var nFavAdd=0;aCrumbHistory=new Array();aFavoritesHistory=new Array();for(var nIndex=0;nIndex<g_aHistory.length;nIndex++){aCrumbHistory.push([g_aHistory[nIndex],g_aHistoryNames[nIndex],g_aHistoryIcon[nIndex],g_aHistoryActive[nIndex]]);}aFavoritesHistory=GetFavoritesList();if(aFavoritesHistory.length>0){bHaveFavs=true;nFavAdd=1;}}function GoHistory(nDirection){g_bHistoryButtonUsed=true;var nPointer=(g_HistoryPointer+nDirection);if((nPointer<=g_aHistory.length)&&(nPointer>=0)){g_HistoryPointer=nPointer;}OnOpenCrumb(g_aHistoryNames[g_HistoryPointer]);g_sLastIcon=g_aHistoryIcon[g_HistoryPointer];}function ShowRhinoFooter(){document.getElementById("Rhino-Footer").style.display="block";}function HideRhinoFooter(){document.getElementById("Rhino-Footer").style.display="none";}AddOnloadEvent(InitListDirOnLoadPageScripts);AddOnloadEvent(ResizeWebClient);AddOnloadEvent(ReplaceCustomHeaderImage);if(g_bDisableBranding)AddOnloadEvent(HideRhinoFooter);else AddOnloadEvent(ShowRhinoFooter);function ResizeHeightReset(){if(Slider1){var rBtmBarElement=document.getElementById(Slider1.sBottomBar);var nOffsetHeight=0;if(rBtmBarElement!=undefined&&rBtmBarElement!=null)nOffsetHeight=parseInt(rBtmBarElement.offsetHeight);g_nTransferPaneHeight=(nOffsetHeight+148);}ResizeWebClient();}function ShowSplitterPanes(){document.getElementById("panesplitter").style.display="block";document.getElementById("MultiTransTaskbar").style.display="block";if(m_nInitialHeightOfTransferPane==undefined||parseInt(m_nInitialHeightOfTransferPane)==0)m_nInitialHeightOfTransferPane="200px";document.getElementById(g_sBottomPaneDivID).style.height=m_nInitialHeightOfTransferPane;if(AW.ie&&document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).style.position="static";Slider1=objSplitter("panesplitter","ListFiles","thumbpanebox",g_sBottomPaneDivID,100,20,ResizeHeightReset);ResizeHeightReset();if(AW.ie&&document.getElementById(g_sBottomPaneDivID)!=undefined)document.getElementById(g_sBottomPaneDivID).style.position="static";}function OnEnableDisableTransMod(){var ua=navigator.userAgent;if(g_bAllowWebClientPro){bShowMultiTransferCookie=false;createCookie("multitransbubbletip","false",60);if(g_bMultiTransferLoaded&&g_bWebClientProActive){if(IsAppletWorking()==1)OnWCPQuitPrompt(function(){DestroyMultiTransPane();});else DestroyMultiTransPane();}else if(!g_bAppletIsLoading){LaunchMultiTranferApplet();}}}function OnEnableDisableTransModButton(bEnabled){var nFileActionRow;if(bEnabled){if(0==0)createCookie("multitrans","1",60);$("#WCP-Checkmark").css("visibility","visible");document.getElementById(g_sBottomPaneDivID).style.backgroundImage="url('/Web Client/Images/WebClientPro-WM.png')";}else{if(0==0)createCookie("multitrans","0",60);$("#WCP-Checkmark").css("visibility","hidden");ToggleApplet(true,false,false,true);document.getElementById("panesplitter").style.display="none";document.getElementById("MultiTransTaskbar").style.display="none";document.getElementById(g_sBottomPaneDivID).style.height="0px";document.getElementById(g_sBottomPaneDivID).style.backgroundImage="url('/Common/Images/blank.gif')";ResizeWebClient();}if(g_nShowList==1)nFileActionRow=FilesList.getSelectedRows();else nFileActionRow=-1;BuildFileActionButton(nFileActionRow);}function AnimateMultiTranIcon(bAnimate){if(bAnimate){$("#WCP-Load").show();$("#WCP-Load-ico").show();}else{$("#WCP-Load").hide();$("#WCP-Load-ico").hide();}}function OnResetSessionDir(){var sResetCmd=g_sListDirURL+g_sCurrentDir;var ResetRequest=undefined;if(ResetRequest=createAWHttpRequest("GET",(sResetCmd),undefined)){ResetRequest.request();}}function OnWCPQuitPrompt(fnYesCallback){if(g_bMultiTransferLoaded&&g_bWebClientProActive)ConfirmDialog("Web Client Pro 正在处理一项操作。该行为将停止此操作。<br><br>您确定您要取消此操作吗？",fnYesCallback,undefined,undefined,310,undefined,false,true);else if(fnYesCallback!=undefined)fnYesCallback();}function ExtendjQuerySelectable($elements,fnDblclickCallback){$elements.mousedown(function(event){var $self=$(this);if(event.which==3){if(!$self.hasClass("ui-selected")){$self.parent().children("li.ui-selected").each(function(){$(this).removeClass("ui-selected");});$self.addClass("ui-selected");$self.parent().trigger("selectablestop");}}else if(event.which==1){hideContextMenu();if($(event.currentTarget).data('dblclick')){fnDblclickCallback();$(event.currentTarget).data('dblclickdone',true);event.preventDefault();event.stopPropagation();}else {$self.data('dblclick',true);setTimeout(function(){$(event.currentTarget).data('dblclick',false);},200);$(event.currentTarget).data('dblclickdone',false);if(!g_bWebClientProActive){$(event.currentTarget).addClass("ui-selected").siblings().removeClass("ui-selected");OnStopSelectTask();}}}}).bind("dblclick",function(event){if($(this).data('dblclickdone'))$(this).data('dblclickdone',false);else fnDblclickCallback();});$("#thumbpanebox").mousedown(function(event){var $self=$(this);if(event.which==1&&!event.ctrlKey){if(!$self.hasClass("thumbcell")&&g_bWebClientProActive)$("#ThumbListFiles li.ui-selected:first").siblings().removeClass("ui-selected");}});}function OnDBLClickThumbnail(){OnFileOpen();}function OnStopSelectTask(){BuildFileActionButton();}if(g_bAllowWebClientPro)AddOnloadEvent(OnPageLoadMultiTransConfig);$(document).tooltip({"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS }});function FormatGridContextMenu(nContextMenuState,bIsRowImageFile,bIsRowMediaFile){var nIdx=0;for(nIdx=0;nIdx<$("#FilesListContextMenu li").length;nIdx++){$($("#FilesListContextMenu li")[nIdx]).removeClass('option-divider');$($("#FilesListContextMenu li")[nIdx]).css('display','block');}var asMenusToHide=[];var asMenusWithSeparators=[];switch(nContextMenuState){case CONTEXT_MENU_GRID_NOTHING_SELECTED:{asMenusWithSeparators=['rcm-NewDir','rcm-Upload','rcm-AddToFav','rcm-Properties','rcm-Slides'];asMenusToHide=['rcm-Open','rcm-Download','rcm-Rename','rcm-Delete','rcm-Slides','rcm-Preview','rcm-PlayMedia'];}break;case CONTEXT_MENU_GRID_FILE_SELECTED:{asMenusWithSeparators=['rcm-NewDir','rcm-Download','rcm-Delete'];asMenusToHide=['rcm-Open','rcm-Upload','rcm-AddToFav','rcm-Properties','rcm-Slides','rcm-Preview','rcm-PlayMedia','rcm-DetailsView','rcm-SmallThumb','rcm-MediumThumb','rcm-LargeThumb'];}break;case CONTEXT_MENU_GRID_FOLDER_SELECTED:{asMenusWithSeparators=['rcm-NewDir','rcm-Open','rcm-Rename','rcm-AddToFav','rcm-Slides'];if(g_bMultiTransferLoaded&&g_bWebClientProActive)asMenusToHide=['rcm-Upload','rcm-Slides','rcm-Preview','rcm-PlayMedia','rcm-DetailsView','rcm-SmallThumb','rcm-MediumThumb','rcm-LargeThumb'];else asMenusToHide=['rcm-Download','rcm-Upload','rcm-Slides','rcm-Preview','rcm-PlayMedia','rcm-DetailsView','rcm-SmallThumb','rcm-MediumThumb','rcm-LargeThumb'];}break;case CONTEXT_MENU_GRID_FOLDERS_SELECTED:case CONTEXT_MENU_GRID_FILES_SELECTED:case CONTEXT_MENU_GRID_MIXED_SELECTION:{asMenusWithSeparators=['rcm-NewDir','rcm-Download','rcm-Delete'];asMenusToHide=['rcm-Open','rcm-Upload','rcm-Rename','rcm-AddToFav','rcm-Properties','rcm-Slides','rcm-Preview','rcm-PlayMedia','rcm-DetailsView','rcm-SmallThumb','rcm-MediumThumb','rcm-LargeThumb'];}break;default:break;}var nIdx=0;for(nIdx=0;nIdx<asMenusWithSeparators.length;nIdx++){$('#'+asMenusWithSeparators[nIdx]).addClass('option-divider');}for(nIdx=0;nIdx<asMenusToHide.length;nIdx++){$('#'+asMenusToHide[nIdx]).css('display','none');}if(g_nTotalImages>=1)$("#rcm-Slides").css("display","block");if(bIsRowImageFile)$("#rcm-Preview").css("display","block");if(g_bAllowHTTPMediaPlayback==1&&bIsRowMediaFile)$("#rcm-PlayMedia").css("display","block");$("#rcm-SmallThumbImg").css("visibility","hidden");$("#rcm-MediumThumbImg").css("visibility","hidden");$("#rcm-LargeThumbImg").css("visibility","hidden");$("#rcm-DetailsViewImg").css("visibility","hidden");if(g_nShowList==0){if(g_nThumbSize==75)$("#rcm-SmallThumbImg").css("visibility","visible");else if(g_nThumbSize==150)$("#rcm-MediumThumbImg").css("visibility","visible");else $("#rcm-LargeThumbImg").css("visibility","visible");}else $("#rcm-DetailsViewImg").css("visibility","visible");}function OnAppletSupportedResp(nAppletSupported){switch(nAppletSupported){case JAVA_CHECK_UNINITIALIZED:case JAVA_CHECK_PLUGIN_NOT_FOUND:{DestroyMultiTransPane();ShowWCPConfirmDialog(0,0);}break;case JAVA_CHECK_UNSUPPORTED_JRE:case JAVA_CHECK_UNSUPPORTED_MAC_APPLE_JRE:{var bJreDlgDoNotAsk=(readCookie("JreDlgDoNotAsk")=="1");var nJreDlgOption=readCookie("JreDlgYesOrNo");if(!bJreDlgDoNotAsk||(nJreDlgOption!=undefined&&nJreDlgOption=="1")){CheckJREDialog(function(){document.getElementById(g_sAppletFrameID).contentWindow.LoadPage(true,true);},function(){DestroyMultiTransPane();},525,325);}else document.getElementById(g_sAppletFrameID).contentWindow.LoadPage(true,true,false);}break;case JAVA_CHECK_UNSUPPORTED_OPENJDK_JRE:{var bIcedTeaDoNotAsk=(readCookie(COOKIE_OPEN_JDK_CHECK)=="1");if(!bIcedTeaDoNotAsk){ShowWCP_OpenJDKConfirmDialog(function(){document.getElementById(g_sAppletFrameID).contentWindow.LoadPage(true,true,true);},function(){DestroyMultiTransPane();});}else document.getElementById(g_sAppletFrameID).contentWindow.LoadPage(true,false,true);}break;case JAVA_CHECK_UNSUPPORTED_BROWSER_WIN_SAFARI:case JAVA_CHECK_UNSUPPORTED_BROWSER_MAC_FIREFOX:case JAVA_CHECK_UNSUPPORTED_BROWSER_MAC_CHROME:{DestroyMultiTransPane();ShowWCPConfirmDialog(nAppletSupported,1);}break;case JAVA_CHECK_ALL_TESTS_PASSED:default:{if(readCookie(COOKIE_SHOW_AGAIN_WCP_INFO)!="1"){ShowWCPConfirmDialog(0,1,function(){document.getElementById(g_sAppletFrameID).contentWindow.CreateAppletInDom();},function(){DestroyMultiTransPane();});}else document.getElementById(g_sAppletFrameID).contentWindow.CreateAppletInDom();}break;}}</script><div class="footerOverlayFix"></div><div id="Rhino-Footer" class="SUWCFooter" style="display: block;"><div class="copyright" id="FooterCopyright"><div class="footerDiv1"><a href="http://www.Serv-U.com/simplifiedchinese?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP" target="_blank">Serv-U</a> <span id="SUVersionNumber">15.1.2.189</span> © 1995 - 2018 <a href="http://www.SolarWinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP" target="_blank">SolarWinds Worldwide, LLC.</a>&nbsp;All rights reserved.</div></div></div></div>
<div id="SUWC-Slider" style="display: none; width: auto; min-width: 150px; background-color: rgb(196, 196, 196); -moz-user-select: none;" class="SlideSpeedCont ui-contextmenu"><div style="float:left;padding-top:6px;width:auto;">慢</div><div class="horizontal dynamic-slider-control slider" id="slider-1" tabindex="1" style="margin:0 auto;text-align:center;float:left;"><input class="slider-input" id="slider-input-1" name="slider-input-1"><div class="line" style="top: 0px; left: 0px; width: 0px;"><div style="width: 0px;"></div></div><div class="handle" style="left: 0px; top: 0px;"><div>&nbsp;</div></div></div><div style="float:left;padding-top:6px;width:auto;">快</div></div><ul id="SUWCFavsListMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"></ul><ul id="SUWCToolsListMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"><li><a href="#" data-handler="javascript:OnEnableDisableTransMod();" class="EnableWCP"><span class="EnableWCP-ico"><img src="/Web Client/Images/WCP-loading.gif" style="display:none;left:0px;top:4px;" class="wcploadico" id="WCP-Load-ico" alt="Loading" border="0"><div id="WCP-Checkmark" class="SUWCActionico WC-Icon-18 WC-Icon-BlueCheckIco" title="启用 Web Client Pro" style="visibility: hidden;"></div></span>启用 Web Client Pro</a></li></ul><ul id="SUWCUserOptionListMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"><li id="SUWCUserOption-password" style="display: none;"><a href="#" data-handler="javascript:OnShowChangePasswordDialog();" class="SUWCUserOption"><span class="SUWCUserOption-ico"><div class="WC-Icon-18 WC-Icon-ChangePassword"></div></span>更改密码</a></li><li id="SUWCUserOption-changeemail" style="display: none;"><a href="#" data-handler="javascript:OnShowChangeEmailDialog();" class="SUWCUserOption"><span class="SUWCUserOption-ico"><div class="WC-Icon-18 WC-Icon-ChangeEmail"></div></span>更改电子邮件地址</a></li><li id="SUWCUserOption-logout"><a href="#" data-handler="javascript:OnWebClientLogout();" class="SUWCUserOption"><span class="SUWCUserOption-ico"><div class="WC-Icon-18 WC-Icon-Logout"></div></span>注销</a></li></ul><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto; min-width: 160px; -moz-user-select: none;" class="ui-contextmenu"><li id="MCNavOption" style="display: none;"><a href="#AdhocHeadJumpto" class="ActionOption" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);"><span class="Action-ico"><img src="/Common/Images/su16x16.png" class="SUWCActionico" alt="管理控制台" border="0"></span>管理控制台</a></li><li id="WCNavOption" style="display: none;"><a href="#AdhocHeadJumpto" class="ActionOption" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);"><span class="Action-ico"><img src="/Common/Images/WebClient16.png" class="SUWCActionico" alt="Web 客户端" border="0"></span>Web 客户端</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" class="ActionOption" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);"><span class="Action-ico"><img src="/Common/Images/fv16.png" class="SUWCActionico" alt="FTP Voyager JV" border="0"></span>FTP Voyager JV</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" class="ActionOption" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);"><span class="Action-ico"><img src="/Common/Images/FileShare16.png" class="SUWCActionico" alt="File Sharing" border="0"></span>File Sharing</a></li></ul><ul id="SUWCHistoryListMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"></ul><ul id="SUWCThumbOptionMenu" style="overflow: hidden; display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"><li class="ui-widget-header" style="color: #fff; text-align: center;">缩略图大小</li><li><a href="#" data-handler="javascript:OnThumbSizeChange(75);" id="Thumbsmall-Action" class="ActionOption"><span class="Action-ico"><div id="Thumbsmall-Action-Ico" class="ThumbActionico WC-Icon-10 WC-Icon-CheckIcoSmall" style="visibility: hidden;" title="Small"></div></span><span class="ThumbActiontxt">Small</span></a></li><li><a href="#" data-handler="javascript:OnThumbSizeChange(150);" id="Thumbmedium-Action" class="ActionOption"><span class="Action-ico"><div id="Thumbmedium-Action-Ico" class="ThumbActionico WC-Icon-10 WC-Icon-CheckIcoSmall" style="visibility: hidden;" title="Medium"></div></span><span class="ThumbActiontxt">Medium</span></a></li><li><a href="#" data-handler="javascript:OnThumbSizeChange(250);" id="Thumblarge-Action" class="ActionOption"><span class="Action-ico"><div id="Thumblarge-Action-Ico" class="ThumbActionico WC-Icon-10 WC-Icon-CheckIcoSmall" style="visibility: hidden;" title="Large"></div></span><span class="ThumbActiontxt">Large</span></a></li></ul><ul id="SUWCSearchOptionMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"><li><a href="#" data-handler="javascript:OnChangedSearchOpt(0);" class="EnableWCP"><span class="EnableWCP-ico"><input style="z-index:-1;" value="0" name="searchoptionradio" checked="true" id="dirsfiles-option" type="radio"></span>目录和文件</a></li><li><a href="#" data-handler="javascript:OnChangedSearchOpt(1);" class="EnableWCP"><span class="EnableWCP-ico"><input style="z-index:-1;" value="1" name="searchoptionradio" id="files-option" type="radio"></span>仅文件</a></li><li><a href="#" data-handler="javascript:OnChangedSearchOpt(2);" class="EnableWCP"><span class="EnableWCP-ico"><input style="z-index:-1;" value="2" name="searchoptionradio" id="dirs-option" type="radio"></span>仅目录</a></li></ul><ul id="SUWCActionOptionMenu" style="display: none; width: auto; min-width: 150px; -moz-user-select: none;" class="ui-contextmenu"><li><a href="#" id="Rename-Action" class="ActionOption" data-handler="" style="color: rgb(144, 144, 144); cursor: default;"><span class="Action-ico"><div id="Rename-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-Rename WC-Icon-Disabled" title="重命名"></div></span>重命名</a></li><li class="option-divider"><a href="#" data-handler="javascript:ManageFavorites();" id="AddFavs-Action" class="ActionOption"><span class="Action-ico"><div id="AddFavs-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-AddFav" title="添加到收藏夹"></div></span>添加到收藏夹</a></li><li><a href="#" id="DirProps-Action" class="ActionOption" data-handler="javascript:DirSizeDialog();" style="color: rgb(0, 0, 0);"><span class="Action-ico"><div id="DirProps-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-DirProp" title="目录属性"></div></span>目录属性</a></li><li class="option-divider"><a href="#" data-handler="javascript:GoToDialog();" id="GotoDir-Action" class="ActionOption"><span class="Action-ico"><div class="SUWCActionico WC-Icon-18 WC-Icon-GoTo" title="转到目录"></div></span>转到目录</a></li><li><a href="#" id="PrevImg-Action" class="ActionOption" data-handler="" style="color: rgb(144, 144, 144); cursor: default;"><span class="Action-ico"><div id="PrevImg-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-PrevImg WC-Icon-Disabled" title="预览图像"></div></span>预览图像</a></li><li><a href="#" id="SlideShow-Action" class="ActionOption" data-handler="" style="color: rgb(144, 144, 144); cursor: default;"><span class="Action-ico"><div id="SlideShow-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-SlideShow WC-Icon-Disabled" title="幻灯片播放"></div></span>幻灯片播放</a></li><li><a href="#" id="PrevMedia-Action" class="ActionOption" data-handler="" style="color: rgb(144, 144, 144); cursor: default;"><span class="Action-ico"><div id="PrevMedia-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-PrevMedia WC-Icon-Disabled" title="媒体播放"></div></span>媒体播放</a></li><li><a href="#" id="PlaylistMedia-Action" class="ActionOption" data-handler="" style="color: rgb(144, 144, 144); cursor: default;"><span class="Action-ico"><div id="PlaylistMedia-Action-Ico" class="SUWCActionico WC-Icon-18 WC-Icon-PlayList WC-Icon-Disabled" title="播放列表"></div></span>播放列表</a></li></ul><div id="RightClickMenu-webclientLabels" class="contextmenu" style="cursor: pointer;"></div><div id="crumb-container0" class="CrumbBarMenu" style="z-index: 9999; cursor: pointer; height: 60px;"><div style="text-align:center;"><img src="/Common/Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div></div><div id="crumb-container1" class="CrumbBarMenu" style="z-index: 9999; cursor: pointer; height: 60px;"><div style="text-align:center;"><img src="/Common/Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div></div></body></html>